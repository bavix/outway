var Wr=Object.defineProperty;var jr=(t,e,s)=>e in t?Wr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var V=(t,e,s)=>jr(t,typeof e!="symbol"?e+"":e,s);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function s(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(o){if(o.ep)return;o.ep=!0;const n=s(o);fetch(o.href,n)}})();var ve,O,Pt,ae,nt,Rt,Ut,$t,ze,Ae,Me,Dt,ye={},Ot=[],Ir=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,_e=Array.isArray;function Y(t,e){for(var s in e)t[s]=e[s];return t}function Ge(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function K(t,e,s){var a,o,n,i={};for(n in e)n=="key"?a=e[n]:n=="ref"?o=e[n]:i[n]=e[n];if(arguments.length>2&&(i.children=arguments.length>3?ve.call(arguments,2):s),typeof t=="function"&&t.defaultProps!=null)for(n in t.defaultProps)i[n]===void 0&&(i[n]=t.defaultProps[n]);return fe(t,i,a,o,null)}function fe(t,e,s,a,o){var n={type:t,props:e,key:s,ref:a,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:o??++Pt,__i:-1,__u:0};return o==null&&O.vnode!=null&&O.vnode(n),n}function At(){return{current:null}}function Q(t){return t.children}function X(t,e){this.props=t,this.context=e}function le(t,e){if(e==null)return t.__?le(t.__,t.__i+1):null;for(var s;e<t.__k.length;e++)if((s=t.__k[e])!=null&&s.__e!=null)return s.__e;return typeof t.type=="function"?le(t):null}function Mt(t){var e,s;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((s=t.__k[e])!=null&&s.__e!=null){t.__e=t.__c.base=s.__e;break}return Mt(t)}}function We(t){(!t.__d&&(t.__d=!0)&&ae.push(t)&&!Ce.__r++||nt!=O.debounceRendering)&&((nt=O.debounceRendering)||Rt)(Ce)}function Ce(){for(var t,e,s,a,o,n,i,u=1;ae.length;)ae.length>u&&ae.sort(Ut),t=ae.shift(),u=ae.length,t.__d&&(s=void 0,a=void 0,o=(a=(e=t).__v).__e,n=[],i=[],e.__P&&((s=Y({},a)).__v=a.__v+1,O.vnode&&O.vnode(s),qe(e.__P,s,a,e.__n,e.__P.namespaceURI,32&a.__u?[o]:null,n,o??le(a),!!(32&a.__u),i),s.__v=a.__v,s.__.__k[s.__i]=s,It(n,s,i),a.__e=a.__=null,s.__e!=o&&Mt(s)));Ce.__r=0}function Wt(t,e,s,a,o,n,i,u,m,d,f){var l,h,c,_,w,C,x,v=a&&a.__k||Ot,E=e.length;for(m=Hr(s,e,v,m,E),l=0;l<E;l++)(c=s.__k[l])!=null&&(h=c.__i==-1?ye:v[c.__i]||ye,c.__i=l,C=qe(t,c,h,o,n,i,u,m,d,f),_=c.__e,c.ref&&h.ref!=c.ref&&(h.ref&&Ve(h.ref,null,c),f.push(c.ref,c.__c||_,c)),w==null&&_!=null&&(w=_),(x=!!(4&c.__u))||h.__k===c.__k?m=jt(c,m,t,x):typeof c.type=="function"&&C!==void 0?m=C:_&&(m=_.nextSibling),c.__u&=-7);return s.__e=w,m}function Hr(t,e,s,a,o){var n,i,u,m,d,f=s.length,l=f,h=0;for(t.__k=new Array(o),n=0;n<o;n++)(i=e[n])!=null&&typeof i!="boolean"&&typeof i!="function"?(m=n+h,(i=t.__k[n]=typeof i=="string"||typeof i=="number"||typeof i=="bigint"||i.constructor==String?fe(null,i,null,null,null):_e(i)?fe(Q,{children:i},null,null,null):i.constructor==null&&i.__b>0?fe(i.type,i.props,i.key,i.ref?i.ref:null,i.__v):i).__=t,i.__b=t.__b+1,u=null,(d=i.__i=Fr(i,s,m,l))!=-1&&(l--,(u=s[d])&&(u.__u|=2)),u==null||u.__v==null?(d==-1&&(o>f?h--:o<f&&h++),typeof i.type!="function"&&(i.__u|=4)):d!=m&&(d==m-1?h--:d==m+1?h++:(d>m?h--:h++,i.__u|=4))):t.__k[n]=null;if(l)for(n=0;n<f;n++)(u=s[n])!=null&&!(2&u.__u)&&(u.__e==a&&(a=le(u)),Ft(u,u));return a}function jt(t,e,s,a){var o,n;if(typeof t.type=="function"){for(o=t.__k,n=0;o&&n<o.length;n++)o[n]&&(o[n].__=t,e=jt(o[n],e,s,a));return e}t.__e!=e&&(a&&(e&&t.type&&!e.parentNode&&(e=le(t)),s.insertBefore(t.__e,e||null)),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function te(t,e){return e=e||[],t==null||typeof t=="boolean"||(_e(t)?t.some(function(s){te(s,e)}):e.push(t)),e}function Fr(t,e,s,a){var o,n,i,u=t.key,m=t.type,d=e[s],f=d!=null&&(2&d.__u)==0;if(d===null&&t.key==null||f&&u==d.key&&m==d.type)return s;if(a>(f?1:0)){for(o=s-1,n=s+1;o>=0||n<e.length;)if((d=e[i=o>=0?o--:n++])!=null&&!(2&d.__u)&&u==d.key&&m==d.type)return i}return-1}function ot(t,e,s){e[0]=="-"?t.setProperty(e,s??""):t[e]=s==null?"":typeof s!="number"||Ir.test(e)?s:s+"px"}function we(t,e,s,a,o){var n,i;e:if(e=="style")if(typeof s=="string")t.style.cssText=s;else{if(typeof a=="string"&&(t.style.cssText=a=""),a)for(e in a)s&&e in s||ot(t.style,e,"");if(s)for(e in s)a&&s[e]==a[e]||ot(t.style,e,s[e])}else if(e[0]=="o"&&e[1]=="n")n=e!=(e=e.replace($t,"$1")),i=e.toLowerCase(),e=i in t||e=="onFocusOut"||e=="onFocusIn"?i.slice(2):e.slice(2),t.l||(t.l={}),t.l[e+n]=s,s?a?s.u=a.u:(s.u=ze,t.addEventListener(e,n?Me:Ae,n)):t.removeEventListener(e,n?Me:Ae,n);else{if(o=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t)try{t[e]=s??"";break e}catch{}typeof s=="function"||(s==null||s===!1&&e[4]!="-"?t.removeAttribute(e):t.setAttribute(e,e=="popover"&&s==1?"":s))}}function it(t){return function(e){if(this.l){var s=this.l[e.type+t];if(e.t==null)e.t=ze++;else if(e.t<s.u)return;return s(O.event?O.event(e):e)}}}function qe(t,e,s,a,o,n,i,u,m,d){var f,l,h,c,_,w,C,x,v,E,N,P,$,W,L,R,j,M=e.type;if(e.constructor!=null)return null;128&s.__u&&(m=!!(32&s.__u),n=[u=e.__e=s.__e]),(f=O.__b)&&f(e);e:if(typeof M=="function")try{if(x=e.props,v="prototype"in M&&M.prototype.render,E=(f=M.contextType)&&a[f.__c],N=f?E?E.props.value:f.__:a,s.__c?C=(l=e.__c=s.__c).__=l.__E:(v?e.__c=l=new M(x,N):(e.__c=l=new X(x,N),l.constructor=M,l.render=Gr),E&&E.sub(l),l.props=x,l.state||(l.state={}),l.context=N,l.__n=a,h=l.__d=!0,l.__h=[],l._sb=[]),v&&l.__s==null&&(l.__s=l.state),v&&M.getDerivedStateFromProps!=null&&(l.__s==l.state&&(l.__s=Y({},l.__s)),Y(l.__s,M.getDerivedStateFromProps(x,l.__s))),c=l.props,_=l.state,l.__v=e,h)v&&M.getDerivedStateFromProps==null&&l.componentWillMount!=null&&l.componentWillMount(),v&&l.componentDidMount!=null&&l.__h.push(l.componentDidMount);else{if(v&&M.getDerivedStateFromProps==null&&x!==c&&l.componentWillReceiveProps!=null&&l.componentWillReceiveProps(x,N),!l.__e&&l.shouldComponentUpdate!=null&&l.shouldComponentUpdate(x,l.__s,N)===!1||e.__v==s.__v){for(e.__v!=s.__v&&(l.props=x,l.state=l.__s,l.__d=!1),e.__e=s.__e,e.__k=s.__k,e.__k.some(function(p){p&&(p.__=e)}),P=0;P<l._sb.length;P++)l.__h.push(l._sb[P]);l._sb=[],l.__h.length&&i.push(l);break e}l.componentWillUpdate!=null&&l.componentWillUpdate(x,l.__s,N),v&&l.componentDidUpdate!=null&&l.__h.push(function(){l.componentDidUpdate(c,_,w)})}if(l.context=N,l.props=x,l.__P=t,l.__e=!1,$=O.__r,W=0,v){for(l.state=l.__s,l.__d=!1,$&&$(e),f=l.render(l.props,l.state,l.context),L=0;L<l._sb.length;L++)l.__h.push(l._sb[L]);l._sb=[]}else do l.__d=!1,$&&$(e),f=l.render(l.props,l.state,l.context),l.state=l.__s;while(l.__d&&++W<25);l.state=l.__s,l.getChildContext!=null&&(a=Y(Y({},a),l.getChildContext())),v&&!h&&l.getSnapshotBeforeUpdate!=null&&(w=l.getSnapshotBeforeUpdate(c,_)),R=f,f!=null&&f.type===Q&&f.key==null&&(R=Ht(f.props.children)),u=Wt(t,_e(R)?R:[R],e,s,a,o,n,i,u,m,d),l.base=e.__e,e.__u&=-161,l.__h.length&&i.push(l),C&&(l.__E=l.__=null)}catch(p){if(e.__v=null,m||n!=null)if(p.then){for(e.__u|=m?160:128;u&&u.nodeType==8&&u.nextSibling;)u=u.nextSibling;n[n.indexOf(u)]=null,e.__e=u}else{for(j=n.length;j--;)Ge(n[j]);je(e)}else e.__e=s.__e,e.__k=s.__k,p.then||je(e);O.__e(p,e,s)}else n==null&&e.__v==s.__v?(e.__k=s.__k,e.__e=s.__e):u=e.__e=zr(s.__e,e,s,a,o,n,i,m,d);return(f=O.diffed)&&f(e),128&e.__u?void 0:u}function je(t){t&&t.__c&&(t.__c.__e=!0),t&&t.__k&&t.__k.forEach(je)}function It(t,e,s){for(var a=0;a<s.length;a++)Ve(s[a],s[++a],s[++a]);O.__c&&O.__c(e,t),t.some(function(o){try{t=o.__h,o.__h=[],t.some(function(n){n.call(o)})}catch(n){O.__e(n,o.__v)}})}function Ht(t){return typeof t!="object"||t==null||t.__b&&t.__b>0?t:_e(t)?t.map(Ht):Y({},t)}function zr(t,e,s,a,o,n,i,u,m){var d,f,l,h,c,_,w,C=s.props,x=e.props,v=e.type;if(v=="svg"?o="http://www.w3.org/2000/svg":v=="math"?o="http://www.w3.org/1998/Math/MathML":o||(o="http://www.w3.org/1999/xhtml"),n!=null){for(d=0;d<n.length;d++)if((c=n[d])&&"setAttribute"in c==!!v&&(v?c.localName==v:c.nodeType==3)){t=c,n[d]=null;break}}if(t==null){if(v==null)return document.createTextNode(x);t=document.createElementNS(o,v,x.is&&x),u&&(O.__m&&O.__m(e,n),u=!1),n=null}if(v==null)C===x||u&&t.data==x||(t.data=x);else{if(n=n&&ve.call(t.childNodes),C=s.props||ye,!u&&n!=null)for(C={},d=0;d<t.attributes.length;d++)C[(c=t.attributes[d]).name]=c.value;for(d in C)if(c=C[d],d!="children"){if(d=="dangerouslySetInnerHTML")l=c;else if(!(d in x)){if(d=="value"&&"defaultValue"in x||d=="checked"&&"defaultChecked"in x)continue;we(t,d,null,c,o)}}for(d in x)c=x[d],d=="children"?h=c:d=="dangerouslySetInnerHTML"?f=c:d=="value"?_=c:d=="checked"?w=c:u&&typeof c!="function"||C[d]===c||we(t,d,c,C[d],o);if(f)u||l&&(f.__html==l.__html||f.__html==t.innerHTML)||(t.innerHTML=f.__html),e.__k=[];else if(l&&(t.innerHTML=""),Wt(e.type=="template"?t.content:t,_e(h)?h:[h],e,s,a,v=="foreignObject"?"http://www.w3.org/1999/xhtml":o,n,i,n?n[0]:s.__k&&le(s,0),u,m),n!=null)for(d=n.length;d--;)Ge(n[d]);u||(d="value",v=="progress"&&_==null?t.removeAttribute("value"):_!=null&&(_!==t[d]||v=="progress"&&!_||v=="option"&&_!=C[d])&&we(t,d,_,C[d],o),d="checked",w!=null&&w!=t[d]&&we(t,d,w,C[d],o))}return t}function Ve(t,e,s){try{if(typeof t=="function"){var a=typeof t.__u=="function";a&&t.__u(),a&&e==null||(t.__u=t(e))}else t.current=e}catch(o){O.__e(o,s)}}function Ft(t,e,s){var a,o;if(O.unmount&&O.unmount(t),(a=t.ref)&&(a.current&&a.current!=t.__e||Ve(a,null,e)),(a=t.__c)!=null){if(a.componentWillUnmount)try{a.componentWillUnmount()}catch(n){O.__e(n,e)}a.base=a.__P=null}if(a=t.__k)for(o=0;o<a.length;o++)a[o]&&Ft(a[o],e,s||typeof t.type!="function");s||Ge(t.__e),t.__c=t.__=t.__e=void 0}function Gr(t,e,s){return this.constructor(t,s)}function ce(t,e,s){var a,o,n,i;e==document&&(e=document.documentElement),O.__&&O.__(t,e),o=(a=typeof s=="function")?null:s&&s.__k||e.__k,n=[],i=[],qe(e,t=(!a&&s||e).__k=K(Q,null,[t]),o||ye,ye,e.namespaceURI,!a&&s?[s]:o?null:e.firstChild?ve.call(e.childNodes):null,n,!a&&s?s:o?o.__e:e.firstChild,a,i),It(n,t,i)}function zt(t,e){ce(t,e,zt)}function qr(t,e,s){var a,o,n,i,u=Y({},t.props);for(n in t.type&&t.type.defaultProps&&(i=t.type.defaultProps),e)n=="key"?a=e[n]:n=="ref"?o=e[n]:u[n]=e[n]===void 0&&i!=null?i[n]:e[n];return arguments.length>2&&(u.children=arguments.length>3?ve.call(arguments,2):s),fe(t.type,u,a||t.key,o||t.ref,null)}function Gt(t){function e(s){var a,o;return this.getChildContext||(a=new Set,(o={})[e.__c]=this,this.getChildContext=function(){return o},this.componentWillUnmount=function(){a=null},this.shouldComponentUpdate=function(n){this.props.value!=n.value&&a.forEach(function(i){i.__e=!0,We(i)})},this.sub=function(n){a.add(n);var i=n.componentWillUnmount;n.componentWillUnmount=function(){a&&a.delete(n),i&&i.call(n)}}),s.children}return e.__c="__cC"+Dt++,e.__=t,e.Provider=e.__l=(e.Consumer=function(s,a){return s.children(a)}).contextType=e,e}ve=Ot.slice,O={__e:function(t,e,s,a){for(var o,n,i;e=e.__;)if((o=e.__c)&&!o.__)try{if((n=o.constructor)&&n.getDerivedStateFromError!=null&&(o.setState(n.getDerivedStateFromError(t)),i=o.__d),o.componentDidCatch!=null&&(o.componentDidCatch(t,a||{}),i=o.__d),i)return o.__E=o}catch(u){t=u}throw t}},Pt=0,X.prototype.setState=function(t,e){var s;s=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=Y({},this.state),typeof t=="function"&&(t=t(Y({},s),this.props)),t&&Y(s,t),t!=null&&this.__v&&(e&&this._sb.push(e),We(this))},X.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),We(this))},X.prototype.render=Q,ae=[],Rt=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Ut=function(t,e){return t.__v.__b-e.__v.__b},Ce.__r=0,$t=/(PointerCapture)$|Capture$/i,ze=0,Ae=it(!1),Me=it(!0),Dt=0;var Vr=0;function r(t,e,s,a,o,n){e||(e={});var i,u,m=e;if("ref"in m)for(u in m={},e)u=="ref"?i=e[u]:m[u]=e[u];var d={type:t,props:m,key:s,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--Vr,__i:-1,__u:0,__source:o,__self:n};if(typeof t=="function"&&(i=t.defaultProps))for(u in i)m[u]===void 0&&(m[u]=i[u]);return O.vnode&&O.vnode(d),d}var re,I,Ue,lt,de=0,qt=[],z=O,ct=z.__b,dt=z.__r,ut=z.diffed,ht=z.__c,mt=z.unmount,ft=z.__;function ne(t,e){z.__h&&z.__h(I,t,de||e),de=0;var s=I.__H||(I.__H={__:[],__h:[]});return t>=s.__.length&&s.__.push({}),s.__[t]}function k(t){return de=1,Ee(Vt,t)}function Ee(t,e,s){var a=ne(re++,2);if(a.t=t,!a.__c&&(a.__=[s?s(e):Vt(void 0,e),function(u){var m=a.__N?a.__N[0]:a.__[0],d=a.t(m,u);m!==d&&(a.__N=[d,a.__[1]],a.__c.setState({}))}],a.__c=I,!I.__f)){var o=function(u,m,d){if(!a.__c.__H)return!0;var f=a.__c.__H.__.filter(function(h){return!!h.__c});if(f.every(function(h){return!h.__N}))return!n||n.call(this,u,m,d);var l=a.__c.props!==u;return f.forEach(function(h){if(h.__N){var c=h.__[0];h.__=h.__N,h.__N=void 0,c!==h.__[0]&&(l=!0)}}),n&&n.call(this,u,m,d)||l};I.__f=!0;var n=I.shouldComponentUpdate,i=I.componentWillUpdate;I.componentWillUpdate=function(u,m,d){if(this.__e){var f=n;n=void 0,o(u,m,d),n=f}i&&i.call(this,u,m,d)},I.shouldComponentUpdate=o}return a.__N||a.__}function H(t,e){var s=ne(re++,3);!z.__s&&Ye(s.__H,e)&&(s.__=t,s.u=e,I.__H.__h.push(s))}function he(t,e){var s=ne(re++,4);!z.__s&&Ye(s.__H,e)&&(s.__=t,s.u=e,I.__h.push(s))}function Te(t){return de=5,se(function(){return{current:t}},[])}function Be(t,e,s){de=6,he(function(){if(typeof t=="function"){var a=t(e());return function(){t(null),a&&typeof a=="function"&&a()}}if(t)return t.current=e(),function(){return t.current=null}},s==null?s:s.concat(t))}function se(t,e){var s=ne(re++,7);return Ye(s.__H,e)&&(s.__=t(),s.__H=e,s.__h=t),s.__}function Je(t,e){return de=8,se(function(){return t},e)}function Ze(t){var e=I.context[t.__c],s=ne(re++,9);return s.c=t,e?(s.__==null&&(s.__=!0,e.sub(I)),e.props.value):t.__}function Qe(t,e){z.useDebugValue&&z.useDebugValue(e?e(t):t)}function Br(t){var e=ne(re++,10),s=k();return e.__=t,I.componentDidCatch||(I.componentDidCatch=function(a,o){e.__&&e.__(a,o),s[1](a)}),[s[0],function(){s[1](void 0)}]}function Xe(){var t=ne(re++,11);if(!t.__){for(var e=I.__v;e!==null&&!e.__m&&e.__!==null;)e=e.__;var s=e.__m||(e.__m=[0,0]);t.__="P"+s[0]+"-"+s[1]++}return t.__}function Jr(){for(var t;t=qt.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(Se),t.__H.__h.forEach(Ie),t.__H.__h=[]}catch(e){t.__H.__h=[],z.__e(e,t.__v)}}z.__b=function(t){I=null,ct&&ct(t)},z.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),ft&&ft(t,e)},z.__r=function(t){dt&&dt(t),re=0;var e=(I=t.__c).__H;e&&(Ue===I?(e.__h=[],I.__h=[],e.__.forEach(function(s){s.__N&&(s.__=s.__N),s.u=s.__N=void 0})):(e.__h.forEach(Se),e.__h.forEach(Ie),e.__h=[],re=0)),Ue=I},z.diffed=function(t){ut&&ut(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(qt.push(e)!==1&&lt===z.requestAnimationFrame||((lt=z.requestAnimationFrame)||Zr)(Jr)),e.__H.__.forEach(function(s){s.u&&(s.__H=s.u),s.u=void 0})),Ue=I=null},z.__c=function(t,e){e.some(function(s){try{s.__h.forEach(Se),s.__h=s.__h.filter(function(a){return!a.__||Ie(a)})}catch(a){e.some(function(o){o.__h&&(o.__h=[])}),e=[],z.__e(a,s.__v)}}),ht&&ht(t,e)},z.unmount=function(t){mt&&mt(t);var e,s=t.__c;s&&s.__H&&(s.__H.__.forEach(function(a){try{Se(a)}catch(o){e=o}}),s.__H=void 0,e&&z.__e(e,s.__v))};var pt=typeof requestAnimationFrame=="function";function Zr(t){var e,s=function(){clearTimeout(a),pt&&cancelAnimationFrame(e),setTimeout(t)},a=setTimeout(s,35);pt&&(e=requestAnimationFrame(s))}function Se(t){var e=I,s=t.__c;typeof s=="function"&&(t.__c=void 0,s()),I=e}function Ie(t){var e=I;t.__c=t.__(),I=e}function Ye(t,e){return!t||t.length!==e.length||e.some(function(s,a){return s!==t[a]})}function Vt(t,e){return typeof e=="function"?e(t):e}class Qr{constructor(e){V(this,"ws",null);V(this,"reconnectTimeout",null);V(this,"reconnectAttempts",0);V(this,"maxReconnectAttempts",10);V(this,"baseDelay",500);V(this,"maxDelay",1e4);V(this,"callbacks",new Map);V(this,"lastSnapshot",{});this.url=e}async connect(){return new Promise((e,s)=>{try{const a=this.url.replace(/^http/,"ws");this.ws=new WebSocket(a),this.ws.onopen=()=>{console.log("WebSocket connected"),this.reconnectAttempts=0,this.clearReconnectTimeout(),e()},this.ws.onmessage=o=>{try{const n=JSON.parse(o.data);this.handleMessage(n)}catch(n){console.warn("Invalid WebSocket message:",n)}},this.ws.onclose=()=>{console.log("WebSocket disconnected"),this.scheduleReconnect()},this.ws.onerror=o=>{console.error("WebSocket error:",o),s(o)},this.ws.addEventListener("ping",()=>{var o;((o=this.ws)==null?void 0:o.readyState)===WebSocket.OPEN&&this.ws.send("pong")})}catch(a){s(a)}})}close(){this.clearReconnectTimeout(),this.ws&&(this.ws.close(),this.ws=null)}handleMessage(e){let s=e.data;if(e.type==="upstreams"&&Array.isArray(s)){const o=this.lastSnapshot.upstreams||[];s=s.map((n,i)=>{var h;const u=(n.name||n.Name||"").toString(),m=n.weight??n.Weight,d=(n.type||n.Type||"").toString().toLowerCase(),f=(n.address||n.Address||"").toString();let l=f;if(/^(https?|udp|tcp|tls|dot|quic|doq):\/\//i.test(f)||(d&&d!=="doh"?l=`${d}://${f}`:l=`udp://${f}`),!l||l==="udp://"){const c=o.find(_=>_.name===u);l=(c==null?void 0:c.address)||((h=o[i])==null?void 0:h.address)||l}return{name:u,address:l,weight:m}})}if(e.type==="history"){const o=Array.isArray(s)?s:s&&Array.isArray(s.events)?s.events:[];s=o;try{console.debug("[WS] history",Array.isArray(o)?o.length:0)}catch{}}if(e.type==="stats"&&s)if(typeof s=="object"&&s!==null){s={dns_queries_total:s.dns_queries_total||0,dns_marks_total:s.dns_marks_total||0,marks_dropped_total:s.marks_dropped_total||0,dns_upstream_rtt_avg_seconds:s.dns_upstream_rtt_avg_seconds||0,dns_request_avg_seconds:s.dns_request_avg_seconds||0,service_ready:s.service_ready||0,effective_rps:s.effective_rps||0,origin_rps:s.origin_rps||0,cache_hit_rate:s.cache_hit_rate||0,...s};try{console.debug("[WS] stats received:",s)}catch{}}else try{console.warn("[WS] Invalid stats payload:",s)}catch{}if(e.type==="overview"&&s)try{window.__ov=s}catch{}if(e.type==="cache_updated"){const o=this.callbacks.get("cache");o&&o.forEach(n=>{var i,u,m,d;try{n({items:((i=this.lastSnapshot.cache)==null?void 0:i.items)||[],total:((u=this.lastSnapshot.cache)==null?void 0:u.total)||0,offset:((m=this.lastSnapshot.cache)==null?void 0:m.offset)||0,limit:((d=this.lastSnapshot.cache)==null?void 0:d.limit)||0})}catch{}})}this.lastSnapshot[e.type]=s;const a=this.callbacks.get(e.type);a&&a.forEach(o=>{try{o(s)}catch(n){console.error("Callback error:",n)}})}scheduleReconnect(){if(this.reconnectAttempts>=this.maxReconnectAttempts){console.error("Max reconnection attempts reached");return}this.clearReconnectTimeout();const e=Math.min(this.baseDelay*Math.pow(1.8,this.reconnectAttempts),this.maxDelay),s=e*.25,a=e+(Math.random()-.5)*s;this.reconnectTimeout=window.setTimeout(()=>{this.reconnectAttempts++,console.log(`Attempting to reconnect (${this.reconnectAttempts}/${this.maxReconnectAttempts})`),this.connect().catch(console.error)},a)}clearReconnectTimeout(){this.reconnectTimeout&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null)}onRuleGroups(e){return this.subscribe("rule_groups",e)}onUpstreams(e){return this.subscribe("upstreams",e)}onStats(e){return this.subscribe("stats",e)}onHistory(e){return this.subscribe("history",e)}onHosts(e){return this.subscribe("hosts",e)}onOverview(e){return this.subscribe("overview",e)}onCache(e){return this.subscribe("cache",e)}onCacheUpdated(e){return this.subscribe("cache_updated",e)}onUpdateAvailable(e){return this.subscribe("update_available",e)}subscribe(e,s){if(this.callbacks.has(e)||this.callbacks.set(e,new Set),this.callbacks.get(e).add(s),this.lastSnapshot[e])try{s(this.lastSnapshot[e])}catch(a){console.error("Snapshot callback error:",a)}return()=>{const a=this.callbacks.get(e);a&&(a.delete(s),a.size===0&&this.callbacks.delete(e))}}async fetchRuleGroups(){throw new Error("Use REST provider for fetch operations")}async createRuleGroup(e){throw new Error("Use REST provider for mutation operations")}async updateRuleGroup(e,s){throw new Error("Use REST provider for mutation operations")}async deleteRuleGroup(e){throw new Error("Use REST provider for mutation operations")}async fetchUpstreams(){throw new Error("Use REST provider for fetch operations")}async saveUpstreams(e){throw new Error("Use REST provider for mutation operations")}async fetchStats(){throw new Error("Use REST provider for fetch operations")}async fetchHistory(){throw new Error("Use REST provider for fetch operations")}async fetchServerInfo(){throw new Error("Use REST provider for fetch operations")}async fetchConfig(){throw new Error("Use REST provider for fetch operations")}async updateConfig(e){throw new Error("Use REST provider for mutation operations")}async fetchHosts(){throw new Error("Use REST provider for fetch operations")}async saveHosts(e){throw new Error("Use REST provider for mutation operations")}async testResolve(e,s){throw new Error("Use REST provider for fetch operations")}on(e,s){this.callbacks.has(e)||this.callbacks.set(e,new Set),this.callbacks.get(e).add(s)}off(e,s){const a=this.callbacks.get(e);a&&a.delete(s)}async request(e,s,a){throw new Error("Use REST provider for HTTP requests")}async fetchLocalZones(){throw new Error("Use REST provider for Local DNS operations")}async fetchLocalLeases(){throw new Error("Use REST provider for Local DNS operations")}async testLocalResolve(e){throw new Error("Use REST provider for Local DNS operations")}}class Xr{constructor(e=""){V(this,"pollingTimers",new Map);V(this,"callbacks",new Map);V(this,"pollingConfig",{stats:3e4,history:6e4,rule_groups:3e5,upstreams:3e5,hosts:3e5,cache:3e4,local_zones:3e4,local_leases:3e4});this.baseUrl=e}async connect(){this.startPolling("stats",()=>this.fetchStats()),this.startPolling("history",()=>this.fetchHistory()),this.startPolling("rule_groups",()=>this.fetchRuleGroups()),this.startPolling("upstreams",()=>this.fetchUpstreams()),this.startPolling("hosts",()=>this.fetchHosts()),this.startPolling("cache",()=>this.fetchCache())}close(){this.pollingTimers.forEach(e=>clearInterval(e)),this.pollingTimers.clear(),this.callbacks.clear()}async fetchJSON(e,s={}){const a=await fetch(`${this.baseUrl}${e}`,{headers:{"Content-Type":"application/json",...s.headers},...s});if(!a.ok)throw new Error(`HTTP ${a.status}: ${await a.text()}`);const o=a.headers.get("content-type");return o!=null&&o.includes("application/json")?a.json():a.text()}startPolling(e,s){const a=this.pollingConfig[e];s().then(n=>{this.notifyCallbacks(e,n)}).catch(console.error);const o=window.setInterval(()=>{s().then(n=>{this.notifyCallbacks(e,n)}).catch(console.error)},a);this.pollingTimers.set(e,o)}notifyCallbacks(e,s){const a=this.callbacks.get(e);a&&a.forEach(o=>{try{o(s)}catch(n){console.error("Polling callback error:",n)}})}onRuleGroups(e){return this.subscribe("rule_groups",e)}onUpstreams(e){return this.subscribe("upstreams",e)}onStats(e){return this.subscribe("stats",e)}onHistory(e){return this.subscribe("history",e)}onHosts(e){return this.subscribe("hosts",e)}onCache(e){return this.subscribe("cache",e)}onUpdateAvailable(e){return()=>{}}subscribe(e,s){return this.callbacks.has(e)||this.callbacks.set(e,new Set),this.callbacks.get(e).add(s),()=>{const a=this.callbacks.get(e);a&&(a.delete(s),a.size===0&&this.callbacks.delete(e))}}async fetchRuleGroups(){return(await this.fetchJSON("/api/v1/rule-groups")).rule_groups}async createRuleGroup(e){await this.fetchJSON("/api/v1/rule-groups",{method:"POST",body:JSON.stringify(e)})}async updateRuleGroup(e,s){await this.fetchJSON(`/api/v1/rule-groups/${encodeURIComponent(e)}`,{method:"PUT",body:JSON.stringify(s)})}async deleteRuleGroup(e){await this.fetchJSON(`/api/v1/rule-groups/${encodeURIComponent(e)}`,{method:"DELETE"})}async fetchUpstreams(){return(await this.fetchJSON("/api/v1/upstreams")).upstreams.map(s=>{var m,d;const a=s.name||s.Name||"",o=s.weight??s.Weight,n=(m=s.type)==null?void 0:m.toString().toLowerCase(),i=((d=s.address)==null?void 0:d.toString())||"";let u=i;return/^(https?|udp|tcp|tls|dot|quic|doq):\/\//i.test(i)?u=i:n&&n!=="doh"&&(u=`${n}://${i.replace(/^(udp|tcp|tls|dot|quic|doq):\/\//i,"")}`),{name:a,address:u,weight:o}})}async saveUpstreams(e){const s=e.map(a=>{const o=String(a.address||"").trim();let n=(a.name||"").trim();const i=typeof a.weight=="number"?a.weight:void 0;try{const d=new URL(o),f=d.protocol.replace(":","").toLowerCase();let l=o;return f!=="https"&&(l=`${f==="tls"?"dot":f==="quic"?"doq":f}://${d.host}`),n||(n=d.hostname),{name:n,address:l,...i!==void 0?{weight:i}:{}}}catch{}const u=o.replace(/^(udp|tcp|tls|dot|quic|doq):\/\//i,"");n||(n=u.split(":")[0]||u);const m=`udp://${u}`;return{name:n,address:m,...i!==void 0?{weight:i}:{}}});await this.fetchJSON("/api/v1/upstreams",{method:"POST",body:JSON.stringify({upstreams:s})})}async fetchStats(){return this.fetchJSON("/api/v1/stats")}async fetchHistory(){return(await this.fetchJSON("/api/v1/history")).events}async fetchHosts(){return(await this.fetchJSON("/api/v1/hosts")).hosts}async saveHosts(e){await this.fetchJSON("/api/v1/hosts",{method:"PUT",body:JSON.stringify({hosts:e})})}async fetchServerInfo(){return this.fetchJSON("/api/v1/info")}async testResolve(e,s){const a=new URLSearchParams({name:e,type:s});return this.fetchJSON(`/api/v1/resolve?${a.toString()}`)}async cacheFlush(){return this.fetchJSON("/api/v1/cache/flush",{method:"POST"})}async cacheDelete(e){return this.fetchJSON("/api/v1/cache/delete",{method:"POST",body:JSON.stringify(e)})}onOverview(e){return this.subscribe("overview",e)}async fetchOverview(){return this.fetchJSON("/api/v1/overview")}async fetchCache(e){const s=new URLSearchParams;e!=null&&e.offset&&s.set("offset",String(e.offset)),e!=null&&e.limit&&s.set("limit",String(e.limit)),e!=null&&e.q&&s.set("q",e.q);const a=s.toString();return this.fetchJSON(`/api/v1/cache${a?`?${a}`:""}`)}async fetchCacheKey(e){const s=new URLSearchParams({key:e});return this.fetchJSON(`/api/v1/cache/key?${s.toString()}`)}on(e,s){this.callbacks.has(e)||this.callbacks.set(e,new Set),this.callbacks.get(e).add(s)}off(e,s){const a=this.callbacks.get(e);a&&a.delete(s)}async request(e,s,a){const o=`${this.baseUrl}${s}`,n={method:e,headers:{"Content-Type":"application/json"}};return a&&(n.body=JSON.stringify(a)),fetch(o,n)}async fetchLocalZones(){return(await this.fetchJSON("/api/v1/local/zones")).zones||[]}async fetchLocalLeases(){return(await this.fetchJSON("/api/v1/local/leases")).leases||[]}async testLocalResolve(e){const s=new URLSearchParams({name:e});return this.fetchJSON(`/api/v1/local/resolve?${s.toString()}`)}async fetchWOLDevices(){return this.fetchJSON("/api/v1/wol/devices")}async fetchWOLInterfaces(){return this.fetchJSON("/api/v1/wol/interfaces")}async fetchWOLConfig(){return this.fetchJSON("/api/v1/wol/config")}async updateWOLConfig(e){await this.fetchJSON("/api/v1/wol/config",{method:"PUT",body:JSON.stringify(e)})}async scanWOLDevices(){return this.fetchJSON("/api/v1/wol/devices/scan")}async addWOLDevice(e){return this.fetchJSON("/api/v1/wol/devices/add",{method:"POST",body:JSON.stringify(e)})}async updateWOLDevice(e,s){await this.fetchJSON(`/api/v1/wol/devices/update?id=${e}`,{method:"POST",body:JSON.stringify(s)})}async deleteWOLDevice(e){await this.fetchJSON(`/api/v1/wol/devices/delete?id=${e}`,{method:"POST"})}async fetchDevices(){return this.fetchJSON("/api/v1/devices")}async fetchDevice(e){return this.fetchJSON(`/api/v1/devices/${e}`)}async addDevice(e){return this.fetchJSON("/api/v1/devices",{method:"POST",body:JSON.stringify(e)})}async updateDevice(e,s){await this.fetchJSON(`/api/v1/devices/${e}`,{method:"PUT",body:JSON.stringify(s)})}async deleteDevice(e){await this.fetchJSON(`/api/v1/devices/${e}`,{method:"DELETE"})}async fetchDevicesByType(e){return this.fetchJSON(`/api/v1/devices/type/${e}`)}async fetchOnlineDevices(){return this.fetchJSON("/api/v1/devices/online")}async fetchWakeableDevices(){return this.fetchJSON("/api/v1/devices/wakeable")}async fetchResolvableDevices(){return this.fetchJSON("/api/v1/devices/resolvable")}async scanDevices(){return this.fetchJSON("/api/v1/devices/scan")}async fetchDeviceStats(){return this.fetchJSON("/api/v1/devices/stats")}async wakeDevice(e){return this.fetchJSON(`/api/v1/devices/${e.id}/wake`,{method:"POST",body:JSON.stringify(e)})}async wakeAllDevices(){return this.fetchJSON("/api/v1/devices/wake-all",{method:"POST"})}async resolveDevice(e){return this.fetchJSON(`/api/v1/devices/${e}/resolve`)}}class Yr{constructor(e="/ws",s=""){V(this,"wsProvider");V(this,"restProvider");V(this,"isWSConnected",!1);V(this,"listeners",new Map);V(this,"wsUnsubs",new Map);V(this,"restUnsubs",new Map);V(this,"statusListeners",new Set);this.wsProvider=new Qr(e),this.restProvider=new Xr(s)}async connect(){try{await this.wsProvider.connect(),this.isWSConnected=!0,console.log("Using WebSocket provider")}catch(e){console.warn("WebSocket connection failed, falling back to REST:",e),this.isWSConnected=!1}try{await this.restProvider.connect(),console.log("REST provider ready")}catch(e){throw console.error("REST provider failed:",e),e}this.resubscribeAll(),this.monitorWSConnection(),this.emitStatus()}close(){this.wsProvider.close(),this.restProvider.close(),this.wsUnsubs.forEach(e=>e()),this.restUnsubs.forEach(e=>e()),this.wsUnsubs.clear(),this.restUnsubs.clear(),this.listeners.clear(),this.statusListeners.clear()}monitorWSConnection(){const e=setInterval(()=>{var o;const s=this.isWSConnected;if(!(((o=this.wsProvider.ws)==null?void 0:o.readyState)===WebSocket.OPEN)){setTimeout(()=>{var u;const n=((u=this.wsProvider.ws)==null?void 0:u.readyState)!==WebSocket.OPEN,i=this.isWSConnected;this.isWSConnected=!n,i!==this.isWSConnected&&(this.resubscribeAll(),console.log(this.isWSConnected?"WebSocket active":"Using REST fallback"),this.emitStatus())},1500);return}this.isWSConnected=!0,s!==!0&&(this.resubscribeAll(),console.log(this.isWSConnected?"WebSocket active":"Using REST fallback"),this.emitStatus())},1e4);this.wsUnsubs.set("_monitor",()=>clearInterval(e))}addListener(e,s){return this.listeners.has(e)||this.listeners.set(e,new Set),this.listeners.get(e).add(s),this.resubscribe(e),()=>{const a=this.listeners.get(e);a&&(a.delete(s),a.size===0&&this.listeners.delete(e));const o=this.wsUnsubs.get(e);o&&o();const n=this.restUnsubs.get(e);n&&n(),this.wsUnsubs.delete(e),this.restUnsubs.delete(e)}}resubscribe(e){const s=this.wsUnsubs.get(e);s&&s();const a=this.restUnsubs.get(e);a&&a(),this.wsUnsubs.delete(e),this.restUnsubs.delete(e);const o=this.listeners.get(e);if(!o||o.size===0)return;const n=i=>o.forEach(u=>{try{u(i)}catch{}});if(this.isWSConnected)switch(e){case"rule_groups":this.wsUnsubs.set(e,this.wsProvider.onRuleGroups(n));break;case"upstreams":this.wsUnsubs.set(e,this.wsProvider.onUpstreams(n));break;case"stats":this.wsUnsubs.set(e,this.wsProvider.onStats(n));break;case"history":this.wsUnsubs.set(e,this.wsProvider.onHistory(n));break;case"hosts":this.wsUnsubs.set(e,this.wsProvider.onHosts(n));break;case"overview":this.wsUnsubs.set(e,this.wsProvider.onOverview(n));break;case"update_available":this.wsUnsubs.set(e,this.wsProvider.onUpdateAvailable(n));break;case"cache":this.wsUnsubs.set(e,this.wsProvider.onCache(n));break}else switch(e){case"rule_groups":this.restUnsubs.set(e,this.restProvider.onRuleGroups(n)),this.restProvider.fetchRuleGroups().then(n).catch(console.error);break;case"upstreams":this.restUnsubs.set(e,this.restProvider.onUpstreams(n)),this.restProvider.fetchUpstreams().then(n).catch(console.error);break;case"stats":this.restUnsubs.set(e,this.restProvider.onStats(n)),this.restProvider.fetchStats().then(i=>{console.debug("[FailoverProvider] Stats loaded via REST:",i),n(i)}).catch(i=>{console.error("[FailoverProvider] Failed to load stats via REST:",i)});break;case"history":this.restUnsubs.set(e,this.restProvider.onHistory(n)),this.restProvider.fetchHistory().then(n).catch(console.error);break;case"hosts":this.restUnsubs.set(e,this.restProvider.onHosts(n)),this.restProvider.fetchHosts().then(n).catch(console.error);break;case"overview":this.restUnsubs.set(e,this.restProvider.onOverview(n)),this.restProvider.fetchOverview().then(n).catch(console.error);break;case"update_available":this.restUnsubs.set(e,this.restProvider.onUpdateAvailable(n));break;case"cache":this.restUnsubs.set(e,this.restProvider.onCache(n));break}}resubscribeAll(){Array.from(this.listeners.keys()).forEach(e=>this.resubscribe(e))}emitStatus(){const e={channel:this.isWSConnected?"ws":"rest",connected:!0};this.statusListeners.forEach(s=>{try{s(e)}catch{}})}onStatus(e){return this.statusListeners.add(e),e({channel:this.isWSConnected?"ws":"rest",connected:!0}),()=>{this.statusListeners.delete(e)}}async reconnect(){try{await this.wsProvider.connect(),this.isWSConnected=!0,this.resubscribeAll(),this.emitStatus()}catch{}}onRuleGroups(e){return this.addListener("rule_groups",e)}onUpstreams(e){return this.addListener("upstreams",e)}onStats(e){return this.addListener("stats",e)}onHistory(e){return this.addListener("history",e)}onHosts(e){return this.addListener("hosts",e)}onOverview(e){return this.addListener("overview",e)}onUpdateAvailable(e){return this.addListener("update_available",e)}onCache(e){return this.addListener("cache",e)}onCacheUpdated(e){return this.addListener("cache_updated",e)}async fetchCache(e){return this.restProvider.fetchCache(e)}async fetchRuleGroups(){try{return await this.restProvider.fetchRuleGroups()}catch(e){throw console.error("Failed to fetch rule groups:",e),e}}async createRuleGroup(e){try{await this.restProvider.createRuleGroup(e)}catch(s){throw console.error("Failed to create rule group:",s),s}}async updateRuleGroup(e,s){try{await this.restProvider.updateRuleGroup(e,s)}catch(a){throw console.error("Failed to update rule group:",a),a}}async deleteRuleGroup(e){try{await this.restProvider.deleteRuleGroup(e)}catch(s){throw console.error("Failed to delete rule group:",s),s}}async fetchUpstreams(){var e;try{return this.isWSConnected&&this.wsProvider&&((e=this.wsProvider.lastSnapshot)!=null&&e.upstreams)?this.wsProvider.lastSnapshot.upstreams:await this.restProvider.fetchUpstreams()}catch(s){throw console.error("Failed to fetch upstreams:",s),s}}async saveUpstreams(e){try{await this.restProvider.saveUpstreams(e)}catch(s){throw console.error("Failed to save upstreams:",s),s}}async fetchStats(){try{return await this.restProvider.fetchStats()}catch(e){throw console.error("Failed to fetch stats:",e),e}}async fetchHistory(){try{return await this.restProvider.fetchHistory()}catch(e){throw console.error("Failed to fetch history:",e),e}}async fetchHosts(){try{return await this.restProvider.fetchHosts()}catch(e){throw console.error("Failed to fetch hosts:",e),e}}async saveHosts(e){try{await this.restProvider.saveHosts(e)}catch(s){throw console.error("Failed to save hosts:",s),s}}async fetchServerInfo(){try{return await this.restProvider.fetchServerInfo()}catch(e){throw console.error("Failed to fetch server info:",e),e}}async fetchOverview(){try{return await this.restProvider.fetchOverview()}catch(e){throw console.error("Failed to fetch overview:",e),e}}async testResolve(e,s){try{return await this.restProvider.testResolve(e,s)}catch(a){throw console.error("Failed to run resolve test:",a),a}}async cacheFlush(){return this.restProvider.cacheFlush()}async cacheDelete(e){return this.restProvider.cacheDelete(e)}on(e,s){this.isWSConnected?this.wsProvider.on(e,s):this.restProvider.on(e,s)}off(e,s){this.isWSConnected?this.wsProvider.off(e,s):this.restProvider.off(e,s)}async request(e,s,a){return this.isWSConnected?this.wsProvider.request(e,s,a):this.restProvider.request(e,s,a)}async fetchLocalZones(){return this.restProvider.fetchLocalZones()}async fetchLocalLeases(){return this.restProvider.fetchLocalLeases()}async testLocalResolve(e){return this.restProvider.testLocalResolve(e)}async fetchWOLDevices(){return this.restProvider.fetchWOLDevices()}async fetchWOLInterfaces(){return this.restProvider.fetchWOLInterfaces()}async fetchWOLConfig(){return this.restProvider.fetchWOLConfig()}async updateWOLConfig(e){return this.restProvider.updateWOLConfig(e)}async scanWOLDevices(){return this.restProvider.scanWOLDevices()}async addWOLDevice(e){return this.restProvider.addWOLDevice(e)}async updateWOLDevice(e,s){return this.restProvider.updateWOLDevice(e,s)}async deleteWOLDevice(e){return this.restProvider.deleteWOLDevice(e)}async fetchDevices(){return this.restProvider.fetchDevices()}async fetchDevice(e){return this.restProvider.fetchDevice(e)}async addDevice(e){return this.restProvider.addDevice(e)}async updateDevice(e,s){return this.restProvider.updateDevice(e,s)}async deleteDevice(e){return this.restProvider.deleteDevice(e)}async fetchDevicesByType(e){return this.restProvider.fetchDevicesByType(e)}async fetchOnlineDevices(){return this.restProvider.fetchOnlineDevices()}async fetchWakeableDevices(){return this.restProvider.fetchWakeableDevices()}async fetchResolvableDevices(){return this.restProvider.fetchResolvableDevices()}async scanDevices(){return this.restProvider.scanDevices()}async fetchDeviceStats(){return this.restProvider.fetchDeviceStats()}async wakeDevice(e){return this.restProvider.wakeDevice(e)}async wakeAllDevices(){return this.restProvider.wakeAllDevices()}async resolveDevice(e){return this.restProvider.resolveDevice(e)}}function q({children:t,className:e="",title:s,subtitle:a,...o}){const n=`card bg-white/80 dark:bg-gray-800/70 backdrop-blur-sm rounded-xl p-6 border border-gray-200/50 dark:border-gray-700/50 shadow-lg hover:shadow-xl transition-all duration-300 ${e}`.trim();return r("div",{className:n,...o,children:[(s||a)&&r("div",{className:"card-header pb-4 mb-6 border-b border-gray-200 dark:border-gray-700",children:[s&&r("h3",{className:"card-title text-xl font-semibold text-gray-900 dark:text-gray-100 leading-tight",children:s}),a&&r("p",{className:"card-subtitle text-sm text-gray-600 dark:text-gray-400 mt-2 leading-relaxed",children:a})]}),r("div",{className:"card-content text-gray-700 dark:text-gray-300 leading-relaxed",children:t})]})}function ke({title:t,value:e,change:s,icon:a,color:o="blue",className:n=""}){const i={blue:"text-blue-600 dark:text-blue-400",green:"text-green-600 dark:text-green-400",red:"text-red-600 dark:text-red-400",yellow:"text-yellow-600 dark:text-yellow-400",purple:"text-purple-600 dark:text-purple-400",indigo:"text-indigo-600 dark:text-indigo-400"},u=`stats-card bg-white rounded-md p-6 shadow-sm dark:bg-black dark:shadow-none ${n}`.trim();return r("div",{className:u,children:r("div",{className:"flex items-center justify-between",children:[r("div",{children:[r("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t}),r("p",{className:"text-2xl font-bold text-black dark:text-white mt-1",children:e}),s&&r("p",{className:`text-xs font-medium mt-2 ${s.type==="increase"?"text-green-600":"text-red-600"}`,children:[s.type==="increase"?"↗":"↘"," ",Math.abs(s.value),"%"]})]}),a&&r("div",{className:`flex-shrink-0 w-6 h-6 flex items-center justify-center rounded-full ${i[o]}`,children:a})]})})}function U({variant:t="primary",size:e="md",children:s,disabled:a=!1,loading:o=!1,fullWidth:n=!1,className:i="",...u}){const m="btn inline-flex items-center justify-center font-medium rounded-md disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 ease-out",d={primary:"btn-primary bg-blue-600 text-white hover:bg-blue-700 shadow-lg hover:shadow-xl shadow-blue-600/25 hover:shadow-blue-600/40 dark:bg-blue-600 dark:text-white dark:hover:bg-blue-700",secondary:"btn-secondary bg-gray-100 text-gray-900 hover:bg-gray-200 shadow-md hover:shadow-lg dark:bg-gray-700 dark:text-gray-100 dark:hover:bg-gray-600",outline:"btn-outline bg-white/80 dark:bg-gray-800/80 text-gray-900 dark:text-gray-100 border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700 backdrop-blur-sm",danger:"btn-danger bg-red-600 text-white hover:bg-red-700 shadow-lg hover:shadow-xl shadow-red-600/25 hover:shadow-red-600/40 dark:bg-red-600 dark:text-white dark:hover:bg-red-700"},f={sm:"btn-sm px-3 py-2 text-sm rounded-lg",md:"btn-md px-4 py-2.5 text-sm rounded-lg",lg:"btn-lg px-6 py-3 text-base rounded-lg"},l=n?"w-full":"",h=o?"btn-loading":"",c=`${m} ${d[t]} ${f[e]} ${l} ${h} ${i}`.trim();return r("button",{className:c,disabled:a||o,...u,children:[o&&r("svg",{className:"btn-spinner animate-spin -ml-1 mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[r("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s]})}function gt({title:t,data:e,type:s="line",height:a=300,loading:o=!1,error:n,className:i="",xLabel:u,yLabel:m}){const d=Te(null);H(()=>{if(!d.current||!e)return;const c=d.current,_=c.getContext("2d");if(!_)return;const w=56,C=c.width-w*2,x=c.height-w*2;_.clearRect(0,0,c.width,c.height),s==="line"?f(_,e,w,C,x,u,m):s==="bar"?l(_,e,w,C,x,u,m):s==="doughnut"&&h(_,e,c.width/2,c.height/2,Math.min(c.width,c.height)/3)},[e,s]);const f=(c,_,w,C,x,v,E)=>{var M;const N=_.datasets[0];if(!N)return;const P=Math.max(...N.data),$=Math.min(...N.data),W=P-$||1;c.strokeStyle="#e5e7eb",c.lineWidth=1;for(let p=0;p<=5;p++){const g=w+x/5*p;c.beginPath(),c.moveTo(w,g),c.lineTo(w+C,g),c.stroke()}c.fillStyle="#6b7280",c.font="12px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial",c.textAlign="right";for(let p=0;p<=5;p++){const g=w+x/5*p,y=P-W/5*p,A=Number.isFinite(y)?y>=100?y.toFixed(0):y.toFixed(1):"0";c.fillText(A,w-8,g+4)}E&&(c.save(),c.translate(16,w+x/2),c.rotate(-Math.PI/2),c.textAlign="center",c.fillText(E,0,0),c.restore()),c.textAlign="center";const L=N.data.length,R=Math.min(6,Math.max(2,L)),j=Math.max(1,Math.floor((L-1)/(R-1)));for(let p=0;p<L;p+=j){const g=w+C/(L-1)*p,y=((M=_.labels)==null?void 0:M[p])||"";y&&c.fillText(y,g,w+x+18)}v&&c.fillText(v,w+C/2,w+x+34),c.strokeStyle="#3b82f6",c.lineWidth=2,c.beginPath(),N.data.forEach((p,g)=>{const y=w+C/(N.data.length-1)*g,A=w+x-(p-$)/W*x;g===0?c.moveTo(y,A):c.lineTo(y,A)}),c.stroke(),c.fillStyle="#3b82f6",N.data.forEach((p,g)=>{const y=w+C/(N.data.length-1)*g,A=w+x-(p-$)/W*x;c.beginPath(),c.arc(y,A,4,0,2*Math.PI),c.fill()})},l=(c,_,w,C,x,v,E)=>{var M;const N=_.datasets[0];if(!N)return;const P=Math.max(...N.data),$=C/N.data.length*.8,W=C/N.data.length*.2;c.fillStyle="#3b82f6",N.data.forEach((p,g)=>{const y=p/P*x,A=w+g*($+W)+W/2,F=w+x-y;c.fillRect(A,F,$,y)}),c.fillStyle="#6b7280",c.font="12px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial",c.textAlign="right";for(let p=0;p<=5;p++){const g=w+x/5*p,y=P-P/5*p,A=Number.isFinite(y)?y>=100?y.toFixed(0):y.toFixed(1):"0";c.fillText(A,w-8,g+4)}E&&(c.save(),c.translate(16,w+x/2),c.rotate(-Math.PI/2),c.textAlign="center",c.fillText(E,0,0),c.restore()),c.textAlign="center";const L=N.data.length,R=Math.min(6,Math.max(2,L)),j=Math.max(1,Math.floor((L-1)/(R-1)));for(let p=0;p<L;p+=j){const g=w+p*($+W)+W/2+$/2,y=((M=_.labels)==null?void 0:M[p])||"";y&&c.fillText(y,g,w+x+18)}v&&c.fillText(v,w+C/2,w+x+34)},h=(c,_,w,C,x)=>{const v=_.datasets[0];if(!v)return;const E=v.data.reduce(($,W)=>$+W,0),N=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6"];let P=0;v.data.forEach(($,W)=>{const L=$/E*2*Math.PI;c.beginPath(),c.arc(w,C,x,P,P+L),c.arc(w,C,x*.6,P+L,P,!0),c.closePath(),c.fillStyle=N[W%N.length],c.fill(),P+=L})};return o?r("div",{className:`flex items-center justify-center ${i}`,style:{height:a},children:r("div",{className:"text-center",children:[r("div",{className:"w-8 h-8 border-2 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-2"}),r("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Loading chart..."})]})}):n?r("div",{className:`flex items-center justify-center ${i}`,style:{height:a},children:r("div",{className:"text-center",children:[r("svg",{className:"w-12 h-12 mx-auto mb-4 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 16.5c-.77.833.192 2.5 1.732 2.5z"})}),r("p",{className:"text-sm text-red-600 dark:text-red-400",children:n})]})}):r("div",{className:`chart-container ${i}`,children:[t&&r("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:t}),r("div",{className:"relative",children:r("canvas",{ref:d,width:800,height:a,className:"w-full h-auto"})})]})}const Kr={},yt=t=>{let e;const s=new Set,a=(f,l)=>{const h=typeof f=="function"?f(e):f;if(!Object.is(h,e)){const c=e;e=l??(typeof h!="object"||h===null)?h:Object.assign({},e,h),s.forEach(_=>_(e,c))}},o=()=>e,m={setState:a,getState:o,getInitialState:()=>d,subscribe:f=>(s.add(f),()=>s.delete(f)),destroy:()=>{(Kr?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),s.clear()}},d=e=t(a,o,m);return m},es=t=>t?yt(t):yt;function Bt(t,e){for(var s in e)t[s]=e[s];return t}function He(t,e){for(var s in t)if(s!=="__source"&&!(s in e))return!0;for(var a in e)if(a!=="__source"&&t[a]!==e[a])return!0;return!1}function Ke(t,e){var s=e(),a=k({t:{__:s,u:e}}),o=a[0].t,n=a[1];return he(function(){o.__=s,o.u=e,$e(o)&&n({t:o})},[t,s,e]),H(function(){return $e(o)&&n({t:o}),t(function(){$e(o)&&n({t:o})})},[t]),s}function $e(t){var e,s,a=t.u,o=t.__;try{var n=a();return!((e=o)===(s=n)&&(e!==0||1/e==1/s)||e!=e&&s!=s)}catch{return!0}}function et(t){t()}function tt(t){return t}function rt(){return[!1,et]}var st=he;function Le(t,e){this.props=t,this.context=e}function Jt(t,e){function s(o){var n=this.props.ref,i=n==o.ref;return!i&&n&&(n.call?n(null):n.current=null),e?!e(this.props,o)||!i:He(this.props,o)}function a(o){return this.shouldComponentUpdate=s,K(t,o)}return a.displayName="Memo("+(t.displayName||t.name)+")",a.prototype.isReactComponent=!0,a.__f=!0,a.type=t,a}(Le.prototype=new X).isPureReactComponent=!0,Le.prototype.shouldComponentUpdate=function(t,e){return He(this.props,t)||He(this.state,e)};var vt=O.__b;O.__b=function(t){t.type&&t.type.__f&&t.ref&&(t.props.ref=t.ref,t.ref=null),vt&&vt(t)};var ts=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function Zt(t){function e(s){var a=Bt({},s);return delete a.ref,t(a,s.ref||null)}return e.$$typeof=ts,e.render=t,e.prototype.isReactComponent=e.__f=!0,e.displayName="ForwardRef("+(t.displayName||t.name)+")",e}var _t=function(t,e){return t==null?null:te(te(t).map(e))},Qt={map:_t,forEach:_t,count:function(t){return t?te(t).length:0},only:function(t){var e=te(t);if(e.length!==1)throw"Children.only";return e[0]},toArray:te},rs=O.__e;O.__e=function(t,e,s,a){if(t.then){for(var o,n=e;n=n.__;)if((o=n.__c)&&o.__c)return e.__e==null&&(e.__e=s.__e,e.__k=s.__k),o.__c(t,e)}rs(t,e,s,a)};var bt=O.unmount;function Xt(t,e,s){return t&&(t.__c&&t.__c.__H&&(t.__c.__H.__.forEach(function(a){typeof a.__c=="function"&&a.__c()}),t.__c.__H=null),(t=Bt({},t)).__c!=null&&(t.__c.__P===s&&(t.__c.__P=e),t.__c.__e=!0,t.__c=null),t.__k=t.__k&&t.__k.map(function(a){return Xt(a,e,s)})),t}function Yt(t,e,s){return t&&s&&(t.__v=null,t.__k=t.__k&&t.__k.map(function(a){return Yt(a,e,s)}),t.__c&&t.__c.__P===e&&(t.__e&&s.appendChild(t.__e),t.__c.__e=!0,t.__c.__P=s)),t}function pe(){this.__u=0,this.o=null,this.__b=null}function Kt(t){var e=t.__.__c;return e&&e.__a&&e.__a(t)}function er(t){var e,s,a;function o(n){if(e||(e=t()).then(function(i){s=i.default||i},function(i){a=i}),a)throw a;if(!s)throw e;return K(s,n)}return o.displayName="Lazy",o.__f=!0,o}function oe(){this.i=null,this.l=null}O.unmount=function(t){var e=t.__c;e&&e.__R&&e.__R(),e&&32&t.__u&&(t.type=null),bt&&bt(t)},(pe.prototype=new X).__c=function(t,e){var s=e.__c,a=this;a.o==null&&(a.o=[]),a.o.push(s);var o=Kt(a.__v),n=!1,i=function(){n||(n=!0,s.__R=null,o?o(u):u())};s.__R=i;var u=function(){if(!--a.__u){if(a.state.__a){var m=a.state.__a;a.__v.__k[0]=Yt(m,m.__c.__P,m.__c.__O)}var d;for(a.setState({__a:a.__b=null});d=a.o.pop();)d.forceUpdate()}};a.__u++||32&e.__u||a.setState({__a:a.__b=a.__v.__k[0]}),t.then(i,i)},pe.prototype.componentWillUnmount=function(){this.o=[]},pe.prototype.render=function(t,e){if(this.__b){if(this.__v.__k){var s=document.createElement("div"),a=this.__v.__k[0].__c;this.__v.__k[0]=Xt(this.__b,s,a.__O=a.__P)}this.__b=null}var o=e.__a&&K(Q,null,t.fallback);return o&&(o.__u&=-33),[K(Q,null,e.__a?null:t.children),o]};var xt=function(t,e,s){if(++s[1]===s[0]&&t.l.delete(e),t.props.revealOrder&&(t.props.revealOrder[0]!=="t"||!t.l.size))for(s=t.i;s;){for(;s.length>3;)s.pop()();if(s[1]<s[0])break;t.i=s=s[2]}};function ss(t){return this.getChildContext=function(){return t.context},t.children}function as(t){var e=this,s=t.h;if(e.componentWillUnmount=function(){ce(null,e.v),e.v=null,e.h=null},e.h&&e.h!==s&&e.componentWillUnmount(),!e.v){for(var a=e.__v;a!==null&&!a.__m&&a.__!==null;)a=a.__;e.h=s,e.v={nodeType:1,parentNode:s,childNodes:[],__k:{__m:a.__m},contains:function(){return!0},insertBefore:function(o,n){this.childNodes.push(o),e.h.insertBefore(o,n)},removeChild:function(o){this.childNodes.splice(this.childNodes.indexOf(o)>>>1,1),e.h.removeChild(o)}}}ce(K(ss,{context:e.context},t.__v),e.v)}function tr(t,e){var s=K(as,{__v:t,h:e});return s.containerInfo=e,s}(oe.prototype=new X).__a=function(t){var e=this,s=Kt(e.__v),a=e.l.get(t);return a[0]++,function(o){var n=function(){e.props.revealOrder?(a.push(o),xt(e,t,a)):o()};s?s(n):n()}},oe.prototype.render=function(t){this.i=null,this.l=new Map;var e=te(t.children);t.revealOrder&&t.revealOrder[0]==="b"&&e.reverse();for(var s=e.length;s--;)this.l.set(e[s],this.i=[1,0,this.i]);return t.children},oe.prototype.componentDidUpdate=oe.prototype.componentDidMount=function(){var t=this;this.l.forEach(function(e,s){xt(t,s,e)})};var rr=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,ns=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,os=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,is=/[A-Z0-9]/g,ls=typeof document<"u",cs=function(t){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(t)};function sr(t,e,s){return e.__k==null&&(e.textContent=""),ce(t,e),typeof s=="function"&&s(),t?t.__c:null}function ar(t,e,s){return zt(t,e),typeof s=="function"&&s(),t?t.__c:null}X.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(t){Object.defineProperty(X.prototype,t,{configurable:!0,get:function(){return this["UNSAFE_"+t]},set:function(e){Object.defineProperty(this,t,{configurable:!0,writable:!0,value:e})}})});var wt=O.event;function ds(){}function us(){return this.cancelBubble}function hs(){return this.defaultPrevented}O.event=function(t){return wt&&(t=wt(t)),t.persist=ds,t.isPropagationStopped=us,t.isDefaultPrevented=hs,t.nativeEvent=t};var at,ms={enumerable:!1,configurable:!0,get:function(){return this.class}},kt=O.vnode;O.vnode=function(t){typeof t.type=="string"&&function(e){var s=e.props,a=e.type,o={},n=a.indexOf("-")===-1;for(var i in s){var u=s[i];if(!(i==="value"&&"defaultValue"in s&&u==null||ls&&i==="children"&&a==="noscript"||i==="class"||i==="className")){var m=i.toLowerCase();i==="defaultValue"&&"value"in s&&s.value==null?i="value":i==="download"&&u===!0?u="":m==="translate"&&u==="no"?u=!1:m[0]==="o"&&m[1]==="n"?m==="ondoubleclick"?i="ondblclick":m!=="onchange"||a!=="input"&&a!=="textarea"||cs(s.type)?m==="onfocus"?i="onfocusin":m==="onblur"?i="onfocusout":os.test(i)&&(i=m):m=i="oninput":n&&ns.test(i)?i=i.replace(is,"-$&").toLowerCase():u===null&&(u=void 0),m==="oninput"&&o[i=m]&&(i="oninputCapture"),o[i]=u}}a=="select"&&o.multiple&&Array.isArray(o.value)&&(o.value=te(s.children).forEach(function(d){d.props.selected=o.value.indexOf(d.props.value)!=-1})),a=="select"&&o.defaultValue!=null&&(o.value=te(s.children).forEach(function(d){d.props.selected=o.multiple?o.defaultValue.indexOf(d.props.value)!=-1:o.defaultValue==d.props.value})),s.class&&!s.className?(o.class=s.class,Object.defineProperty(o,"className",ms)):(s.className&&!s.class||s.class&&s.className)&&(o.class=o.className=s.className),e.props=o}(t),t.$$typeof=rr,kt&&kt(t)};var Nt=O.__r;O.__r=function(t){Nt&&Nt(t),at=t.__c};var St=O.diffed;O.diffed=function(t){St&&St(t);var e=t.props,s=t.__e;s!=null&&t.type==="textarea"&&"value"in e&&e.value!==s.value&&(s.value=e.value==null?"":e.value),at=null};var nr={ReactCurrentDispatcher:{current:{readContext:function(t){return at.__n[t.__c].props.value},useCallback:Je,useContext:Ze,useDebugValue:Qe,useDeferredValue:tt,useEffect:H,useId:Xe,useImperativeHandle:Be,useInsertionEffect:st,useLayoutEffect:he,useMemo:se,useReducer:Ee,useRef:Te,useState:k,useSyncExternalStore:Ke,useTransition:rt}}},fs="18.3.1";function or(t){return K.bind(null,t)}function be(t){return!!t&&t.$$typeof===rr}function ir(t){return be(t)&&t.type===Q}function lr(t){return!!t&&!!t.displayName&&(typeof t.displayName=="string"||t.displayName instanceof String)&&t.displayName.startsWith("Memo(")}function cr(t){return be(t)?qr.apply(null,arguments):t}function dr(t){return!!t.__k&&(ce(null,t),!0)}function ur(t){return t&&(t.base||t.nodeType===1&&t)||null}var hr=function(t,e){return t(e)},mr=function(t,e){return t(e)},fr=Q,pr=be,gr={useState:k,useId:Xe,useReducer:Ee,useEffect:H,useLayoutEffect:he,useInsertionEffect:st,useTransition:rt,useDeferredValue:tt,useSyncExternalStore:Ke,startTransition:et,useRef:Te,useImperativeHandle:Be,useMemo:se,useCallback:Je,useContext:Ze,useDebugValue:Qe,version:"18.3.1",Children:Qt,render:sr,hydrate:ar,unmountComponentAtNode:dr,createPortal:tr,createElement:K,createContext:Gt,createFactory:or,cloneElement:cr,createRef:At,Fragment:Q,isValidElement:be,isElement:pr,isFragment:ir,isMemo:lr,findDOMNode:ur,Component:X,PureComponent:Le,memo:Jt,forwardRef:Zt,flushSync:mr,unstable_batchedUpdates:hr,StrictMode:fr,Suspense:pe,SuspenseList:oe,lazy:er,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:nr};const ps=Object.freeze(Object.defineProperty({__proto__:null,Children:Qt,Component:X,Fragment:Q,PureComponent:Le,StrictMode:fr,Suspense:pe,SuspenseList:oe,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:nr,cloneElement:cr,createContext:Gt,createElement:K,createFactory:or,createPortal:tr,createRef:At,default:gr,findDOMNode:ur,flushSync:mr,forwardRef:Zt,hydrate:ar,isElement:pr,isFragment:ir,isMemo:lr,isValidElement:be,lazy:er,memo:Jt,render:sr,startTransition:et,unmountComponentAtNode:dr,unstable_batchedUpdates:hr,useCallback:Je,useContext:Ze,useDebugValue:Qe,useDeferredValue:tt,useEffect:H,useErrorBoundary:Br,useId:Xe,useImperativeHandle:Be,useInsertionEffect:st,useLayoutEffect:he,useMemo:se,useReducer:Ee,useRef:Te,useState:k,useSyncExternalStore:Ke,useTransition:rt,version:fs},Symbol.toStringTag,{value:"Module"}));function gs(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function ys(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var s=function a(){return this instanceof a?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};s.prototype=e.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(t).forEach(function(a){var o=Object.getOwnPropertyDescriptor(t,a);Object.defineProperty(s,a,o.get?o:{enumerable:!0,get:function(){return t[a]}})}),s}var yr={exports:{}},vr={};const _r=ys(ps);var br={exports:{}},xr={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ue=_r;function vs(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var _s=typeof Object.is=="function"?Object.is:vs,bs=ue.useState,xs=ue.useEffect,ws=ue.useLayoutEffect,ks=ue.useDebugValue;function Ns(t,e){var s=e(),a=bs({inst:{value:s,getSnapshot:e}}),o=a[0].inst,n=a[1];return ws(function(){o.value=s,o.getSnapshot=e,De(o)&&n({inst:o})},[t,s,e]),xs(function(){return De(o)&&n({inst:o}),t(function(){De(o)&&n({inst:o})})},[t]),ks(s),s}function De(t){var e=t.getSnapshot;t=t.value;try{var s=e();return!_s(t,s)}catch{return!0}}function Ss(t,e){return e()}var Cs=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Ss:Ns;xr.useSyncExternalStore=ue.useSyncExternalStore!==void 0?ue.useSyncExternalStore:Cs;br.exports=xr;var Ls=br.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pe=_r,Es=Ls;function Ts(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ps=typeof Object.is=="function"?Object.is:Ts,Rs=Es.useSyncExternalStore,Us=Pe.useRef,$s=Pe.useEffect,Ds=Pe.useMemo,Os=Pe.useDebugValue;vr.useSyncExternalStoreWithSelector=function(t,e,s,a,o){var n=Us(null);if(n.current===null){var i={hasValue:!1,value:null};n.current=i}else i=n.current;n=Ds(function(){function m(c){if(!d){if(d=!0,f=c,c=a(c),o!==void 0&&i.hasValue){var _=i.value;if(o(_,c))return l=_}return l=c}if(_=l,Ps(f,c))return _;var w=a(c);return o!==void 0&&o(_,w)?(f=c,_):(f=c,l=w)}var d=!1,f,l,h=s===void 0?null:s;return[function(){return m(e())},h===null?void 0:function(){return m(h())}]},[e,s,a,o]);var u=Rs(t,n[0],n[1]);return $s(function(){i.hasValue=!0,i.value=u},[u]),Os(u),u};yr.exports=vr;var As=yr.exports;const Ms=gs(As),wr={},{useDebugValue:Ws}=gr,{useSyncExternalStoreWithSelector:js}=Ms;let Ct=!1;const Is=t=>t;function Hs(t,e=Is,s){(wr?"production":void 0)!=="production"&&s&&!Ct&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Ct=!0);const a=js(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,s);return Ws(a),a}const Lt=t=>{(wr?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof t=="function"?es(t):t,s=(a,o)=>Hs(e,a,o);return Object.assign(s,e),s},xe=t=>t?Lt(t):Lt,kr=xe(t=>({ruleGroups:[],loading:!1,error:null,setRuleGroups:e=>t({ruleGroups:e,error:null}),addRuleGroup:e=>t(s=>({ruleGroups:[...s.ruleGroups.filter(a=>a.name!==e.name),e]})),updateRuleGroup:(e,s)=>t(a=>({ruleGroups:a.ruleGroups.map(o=>o.name===e?s:o)})),removeRuleGroup:e=>t(s=>({ruleGroups:s.ruleGroups.filter(a=>a.name!==e)})),setLoading:e=>t({loading:e}),setError:e=>t({error:e})})),Nr=xe(t=>({upstreams:[],loading:!1,error:null,setUpstreams:e=>t({upstreams:e,error:null}),addUpstream:e=>t(s=>({upstreams:[...s.upstreams,e]})),removeUpstream:e=>t(s=>({upstreams:s.upstreams.filter(a=>a.address!==e)})),setLoading:e=>t({loading:e}),setError:e=>t({error:e})})),Sr=xe(t=>({stats:null,loading:!1,error:null,setStats:e=>t({stats:e,error:null}),setLoading:e=>t({loading:e}),setError:e=>t({error:e})})),Cr=xe(t=>({info:null,loading:!1,error:null,setInfo:e=>t({info:e,error:null}),setLoading:e=>t({loading:e}),setError:e=>t({error:e})})),Lr=xe(t=>({events:[],loading:!1,error:null,setEvents:e=>t({events:e,error:null}),addEvent:e=>t(s=>({events:[e,...s.events].slice(0,2e3)})),setLoading:e=>t({loading:e}),setError:e=>t({error:e})})),Er=()=>kr(t=>t.ruleGroups),Tr=()=>kr(t=>({setRuleGroups:t.setRuleGroups,addRuleGroup:t.addRuleGroup,updateRuleGroup:t.updateRuleGroup,removeRuleGroup:t.removeRuleGroup,setLoading:t.setLoading,setError:t.setError})),Pr=()=>Nr(t=>t.upstreams),Rr=()=>Nr(t=>({setUpstreams:t.setUpstreams,addUpstream:t.addUpstream,removeUpstream:t.removeUpstream,setLoading:t.setLoading,setError:t.setError})),Fs=()=>Sr(t=>t.stats),zs=()=>Sr(t=>({setStats:t.setStats,setLoading:t.setLoading,setError:t.setError})),Gs=()=>Lr(t=>t.events),qs=()=>Lr(t=>({setEvents:t.setEvents,addEvent:t.addEvent,setLoading:t.setLoading,setError:t.setError})),Vs=()=>Cr(t=>t.info),Bs=()=>Cr(t=>({setInfo:t.setInfo,setLoading:t.setLoading,setError:t.setError})),Oe=[{label:"1m",seconds:60},{label:"5m",seconds:300},{label:"15m",seconds:900}],Js={1:"A",28:"AAAA",2:"NS",5:"CNAME",6:"SOA",12:"PTR",15:"MX",16:"TXT",33:"SRV"};function Zs({provider:t}){const e=Fs(),{setStats:s,setError:a}=zs(),o=Er(),n=Pr(),i=Vs(),{setRuleGroups:u,setError:m}=Tr(),{setUpstreams:d,setError:f}=Rr(),{setInfo:l,setError:h}=Bs(),[c,_]=k(Oe[1]),[w,C]=k([]),[x,v]=k([]),E=y=>{window.location.hash=y,window.scrollTo(0,0)};H(()=>{const y=t.onStats(s),A=t.onRuleGroups(u),F=t.onUpstreams(d),B=t.onOverview?t.onOverview(T=>{T!=null&&T.stats&&s(T.stats);try{window.__ov=T}catch{}P(T)}):()=>{};return t.fetchStats().then(s).catch(T=>a(T.message)),t.fetchRuleGroups().then(u).catch(T=>m(T.message)),t.fetchUpstreams().then(d).catch(T=>f(T.message)),t.fetchServerInfo().then(l).catch(T=>h(T.message)),t.fetchOverview&&t.fetchOverview().then(T=>{T!=null&&T.stats&&s(T.stats),P(T);try{window.__ov=T}catch{}}).catch(()=>{}),()=>{y(),A(),F(),B()}},[t,s,u,d,a,m,f,l,h]);const[N,P]=k(null);H(()=>{if(!e)return;const y=30,A=e.effective_rps??(e.dns_queries_total?e.dns_queries_total/60:0);C(B=>{const T=[...B,Math.max(0,Number(A||0))];return T.length>y&&T.shift(),T});const F=(e.dns_request_avg_seconds??0)*1e3;v(B=>{const T=[...B,Math.max(0,Number(F||0))];return T.length>y&&T.shift(),T})},[e]);const $=(e==null?void 0:e.effective_rps)??(e?e.dns_queries_total/60:0),W=e!=null&&e.dns_request_avg_seconds?e.dns_request_avg_seconds*1e3:0,L=n?n.length:0,R=o?o.reduce((y,A)=>y+A.patterns.length,0):0,j=(()=>{if(!e)return null;const y=e.cache_hit_rate;return y==null||(e.dns_queries_total||0)===0?null:y})(),M=y=>Array.from({length:y},()=>""),p={labels:M(w.length),datasets:[{label:"RPS",data:w,borderColor:"#3b82f6",backgroundColor:"#3b82f6",fill:!1}]},g={labels:M(x.length),datasets:[{label:"Avg RT (ms)",data:x,borderColor:"#10b981",backgroundColor:"#10b981",fill:!1}]};return r("div",{className:"space-y-6",children:[r("div",{className:"flex items-center justify-between",children:[r("div",{children:[r("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Dashboard"}),r("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Monitor your DNS proxy performance and configuration"})]}),r("div",{className:"flex items-center space-x-4",children:r("select",{value:c.ms,onChange:y=>{const A=Oe.find(F=>F.ms===parseInt(y.currentTarget.value));A&&_(A)},className:"px-3 py-2 text-sm border border-gray-300 rounded-md bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-800 dark:text-gray-100 dark:border-gray-600 dark:focus:border-blue-400 dark:focus:ring-blue-400",children:Oe.map(y=>r("option",{value:y.ms,children:y.label},y.ms))})})]}),r("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[r(ke,{title:"DNS RPS",value:$.toFixed(1),icon:r("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),color:"blue",loading:!e}),r(ke,{title:"Response Time",value:`${W.toFixed(0)}ms`,icon:r("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),color:"green",loading:!e}),r(ke,{title:"Active Upstreams",value:L,icon:r("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),color:"purple",loading:!n}),r(ke,{title:"Total Rules",value:R,icon:r("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),color:"indigo",loading:!o})]}),r("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r(q,{title:"DNS Queries Over Time",subtitle:`Last ${c.label}`,children:r(gt,{data:p,type:"line",height:256,xLabel:"time",yLabel:"RPS",loading:!e})}),r(q,{title:"Response Time Over Time",subtitle:`Last ${c.label}`,children:r(gt,{data:g,type:"line",height:256,xLabel:"time",yLabel:"ms",loading:!e})})]}),r("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[r(q,{title:"Service Status",className:"lg:col-span-2",children:r("div",{className:"space-y-4",children:[r("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[r("div",{className:"flex items-center",children:[r("div",{className:`w-3 h-3 rounded-full mr-3 ${(e==null?void 0:e.service_ready)===1?"bg-green-500":"bg-red-500"}`}),r("div",{children:[r("p",{className:"font-medium text-gray-900 dark:text-white",children:"DNS Proxy"}),r("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:(e==null?void 0:e.service_ready)===1?"Running":"Stopped"})]})]}),r("div",{className:"text-right",children:[r("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Uptime"}),r("p",{className:"font-medium text-gray-900 dark:text-white",children:(N==null?void 0:N.uptime)??(i?i.uptime:"Unknown")})]})]}),r("div",{className:"grid grid-cols-2 gap-4",children:[r("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[r("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Cache hit rate"}),r("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:j==null?"N/A":`${(j*100).toFixed(2)}%`})]}),r("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[r("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Queries (1m)"}),r("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:[(N==null?void 0:N.queries_last_min)??"N/A",N!=null&&N.errors_last_min?` (${N==null?void 0:N.errors_last_min} errors)`:""]})]})]})]})}),r(q,{title:"Quick Actions",children:r("div",{className:"space-y-3",children:[r(U,{variant:"outline",fullWidth:!0,className:"justify-start hover:scale-[1.01] transition-transform",onClick:()=>E("rules"),children:[r("svg",{className:"w-5 h-5 mr-3 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add New Rule"]}),r(U,{variant:"outline",fullWidth:!0,className:"justify-start hover:scale-[1.01] transition-transform",onClick:()=>E("upstreams"),children:[r("svg",{className:"w-5 h-5 mr-3 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),"Add Upstream"]})]})})]})]})}function G({label:t,error:e,hint:s,required:a=!1,className:o="",id:n,...i}){const u=n||`input-${Math.random().toString(36).substr(2,9)}`,h=`input-field block w-full px-3 py-2 h-[42px] text-sm rounded-md border transition-all duration-200 ease-out focus:outline-none focus:ring-2 disabled:opacity-50 disabled:cursor-not-allowed bg-white text-gray-900 placeholder-gray-500 border-gray-300 hover:border-gray-400 focus:border-blue-500 focus:ring-blue-500 disabled:bg-gray-50 disabled:border-gray-300 dark:bg-gray-800 dark:text-gray-100 dark:placeholder-gray-400 dark:border-gray-600 dark:hover:border-gray-500 dark:focus:border-blue-400 dark:focus:ring-blue-400 dark:disabled:bg-gray-700 dark:disabled:border-gray-600 ${e?"border-red-500 focus:border-red-500 focus:ring-red-500 dark:border-red-400 dark:focus:border-red-400 dark:focus:ring-red-400":""} ${o}`.trim();return r("div",{className:"input-container space-y-1",children:[t&&r("label",{htmlFor:u,className:"input-label block text-sm font-medium text-gray-700 dark:text-gray-300",children:[t,a&&r("span",{className:"text-red-500 ml-1",children:"*"})]}),r("input",{id:u,className:h,...i}),s&&!e&&r("p",{className:"input-hint text-xs text-gray-500 dark:text-gray-400",children:s}),e&&r("p",{className:"input-error text-xs text-red-600 dark:text-red-400",children:e})]})}function Qs({provider:t}){const[e,s]=k(""),[a,o]=k("A"),[n,i]=k(""),[u,m]=k(!1),d=l=>{let h=(l||"").trim();if(!h)return h;h.startsWith("@")&&(h=h.slice(1));try{return new URL(h).hostname||h}catch{}try{return new URL(/^https?:\/\//i.test(h)?h:`http://${h}`).hostname||h}catch{}return h=h.replace(/^\w+:\/\//,""),h=h.replace(/\/.*$/,""),h};return r("div",{className:"space-y-6",children:[r("div",{children:[r("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Resolve"}),r("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Run a test DNS resolve via the active pipeline"})]}),r(q,{children:r("form",{onSubmit:async l=>{if(l.preventDefault(),!!e.trim()){m(!0),i("");try{const h=d(e),c=await t.testResolve(h,a),_=[`Upstream: ${c.upstream}`,`RCODE: ${c.rcode}`,`Answers: ${c.answers}`];c.response_time_ms!==void 0&&_.push(`Time: ${c.response_time_ms}ms`),c.ttl!==void 0&&_.push(`TTL: ${c.ttl}s`);const w=_.join(" | "),C=(c.records||[]).join(`
`);i(`${w}
${C}`)}catch(h){i(h.message)}finally{m(!1)}}},className:"space-y-4",children:[r("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[r(G,{label:"Domain",value:e,onInput:l=>s(l.target.value),placeholder:"example.com or https://www.example.com",required:!0}),r("div",{children:[r("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Type"}),r("select",{className:"w-full px-3 py-2 h-[42px] border border-gray-300 rounded-md bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-800 dark:text-gray-100 dark:border-gray-600 dark:focus:border-blue-400 dark:focus:ring-blue-400",value:a,onChange:l=>o(l.currentTarget.value),children:[r("option",{value:"A",children:"A"}),r("option",{value:"AAAA",children:"AAAA"}),r("option",{value:"CNAME",children:"CNAME"}),r("option",{value:"MX",children:"MX"}),r("option",{value:"NS",children:"NS"}),r("option",{value:"TXT",children:"TXT"}),r("option",{value:"SRV",children:"SRV"}),r("option",{value:"PTR",children:"PTR"})]})]}),r("div",{className:"flex items-end",children:r(U,{type:"submit",variant:"primary",fullWidth:!0,loading:u,disabled:u,children:u?"Resolving…":"Resolve"})})]}),n&&r("div",{children:[r("div",{className:"flex items-center justify-between mb-2",children:[r("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Result"}),r("div",{className:"flex gap-2",children:[r(U,{type:"button",variant:"outline",size:"sm",onClick:()=>navigator.clipboard.writeText(n),children:"Copy"}),r(U,{type:"button",variant:"secondary",size:"sm",onClick:()=>i(""),children:"Clear"})]})]}),r("pre",{className:"mt-1 p-3 rounded-md bg-gray-50 text-gray-800 dark:bg-gray-900 dark:text-gray-200 whitespace-pre-wrap text-sm border border-gray-200 dark:border-gray-700 font-mono leading-6 max-h-96 overflow-auto",children:n})]})]})})]})}function ge({children:t,variant:e="default",size:s="md",className:a="",...o}){const n="badge inline-flex items-center rounded-md font-medium",i={default:"bg-gray-100 text-gray-900 dark:bg-gray-800 dark:text-gray-100",primary:"bg-blue-600 text-white dark:bg-blue-600 dark:text-white",secondary:"bg-gray-200 text-gray-900 dark:bg-gray-700 dark:text-gray-100"},u={sm:"px-2 py-0.5 text-xs",md:"px-2.5 py-1 text-sm"},m=`${n} ${i[e]} ${u[s]} ${a}`.trim();return r("span",{className:m,...o,children:t})}const Xs=[{id:"overview",label:"Overview",icon:r("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[r("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"}),r("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 5a2 2 0 012-2h4a2 2 0 012 2v6H8V5z"})]})},{id:"rules",label:"Rules",icon:r("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})},{id:"upstreams",label:"Upstreams",icon:r("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})})},{id:"history",label:"History",icon:r("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})},{id:"hosts",label:"Hosts",icon:r("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7h18M3 12h18M3 17h18"})})},{id:"devices",label:"Devices",icon:r("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})})},{id:"resolve",label:"Resolve",icon:r("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3M3 11h18M5 19h14a2 2 0 002-2v-6H3v6a2 2 0 002 2z"})})},{id:"cache",label:"Cache",icon:r("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 10h16M4 14h16M4 18h16"})})},{id:"update",label:"Updates",icon:r("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}];function Ys({activeTab:t,onTabChange:e,collapsed:s=!1}){return r("aside",{className:`fixed left-0 top-0 z-40 h-screen bg-white/95 dark:bg-gray-800/95 backdrop-blur-sm border-r border-gray-100 dark:border-gray-700 transition-all duration-300 ${s?"w-16":"w-64"} ${s?"-translate-x-full lg:translate-x-0":"translate-x-0"} lg:translate-x-0`,children:[r("div",{className:"flex items-center justify-between h-16 px-3 border-b border-gray-100 dark:border-gray-700",children:[!s&&r("div",{className:"flex items-center space-x-2",children:[r("div",{className:"w-7 h-7 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center shadow-sm",children:r("span",{className:"text-white font-bold text-sm",children:"O"})}),r("span",{className:"text-lg font-semibold text-gray-900 dark:text-white tracking-tight",children:"Outway"})]}),s&&r("div",{className:"w-7 h-7 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center mx-auto shadow-sm",children:r("span",{className:"text-white font-bold text-sm",children:"O"})})]}),r("nav",{className:"flex-1 px-3 py-4 space-y-1 overflow-y-auto",children:Xs.map(a=>{const o=t===a.id;return r("button",{onClick:()=>e(a.id),className:`w-full flex items-center px-3 py-2.5 text-sm font-medium rounded-xl transition-all duration-200 ${o?"bg-blue-600 text-white shadow-lg shadow-blue-600/25":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-white"}`,children:[r("span",{className:`flex-shrink-0 ${s?"mx-auto":"mr-3"}`,children:a.icon}),!s&&r("span",{className:"truncate font-medium",children:a.label})]},a.id)})}),r("div",{className:"p-3 border-t border-gray-100 dark:border-gray-700",children:[!s&&r("div",{className:"flex items-center space-x-3",children:[r("div",{className:"w-8 h-8 bg-gradient-to-br from-gray-300 to-gray-400 dark:from-gray-600 dark:to-gray-700 rounded-full flex items-center justify-center shadow-sm",children:r("span",{className:"text-xs font-semibold text-gray-700 dark:text-gray-200",children:"A"})}),r("div",{className:"flex-1 min-w-0",children:[r("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:"Admin"}),r("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:"outway@example.com"})]})]}),s&&r("div",{className:"flex justify-center",children:r("div",{className:"w-8 h-8 bg-gradient-to-br from-gray-300 to-gray-400 dark:from-gray-600 dark:to-gray-700 rounded-full flex items-center justify-center shadow-sm",children:r("span",{className:"text-xs font-semibold text-gray-700 dark:text-gray-200",children:"A"})})})]})]})}const Et="outway-theme";function Ur(){const[t,e]=k(()=>typeof window>"u"?"auto":localStorage.getItem(Et)||"auto"),[s,a]=k("light");return H(()=>{const n=()=>{if(t==="auto"){const i=window.matchMedia("(prefers-color-scheme: dark)").matches;a(i?"dark":"light")}else a(t)};if(n(),t==="auto"){const i=window.matchMedia("(prefers-color-scheme: dark)"),u=()=>n();return i.addEventListener("change",u),()=>i.removeEventListener("change",u)}},[t]),H(()=>{const n=document.documentElement;s==="dark"?n.classList.add("dark"):n.classList.remove("dark")},[s]),H(()=>{typeof window<"u"&&localStorage.setItem(Et,t)},[t]),{theme:t,resolvedTheme:s,setTheme:n=>{e(n)}}}function Ks({className:t="",showLabel:e=!1,variant:s="select",...a}){const{theme:o,resolvedTheme:n,setTheme:i}=Ur(),u=h=>{i(h)},m=()=>{const h=["light","dark","auto"],_=(h.indexOf(o)+1)%h.length;i(h[_])},d=()=>{switch(o){case"light":return r("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})});case"dark":return r("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})});case"auto":return r("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}},f=()=>{switch(o){case"light":return"Light theme";case"dark":return"Dark theme";case"auto":return`Auto theme (${n})`}},l=[{value:"light",label:"Light",icon:"☀️"},{value:"dark",label:"Dark",icon:"🌙"},{value:"auto",label:"Auto",icon:"🔄"}];return s==="button"?r("div",{className:`flex items-center gap-2 ${t}`,...a,children:[r("button",{onClick:m,className:"p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-500 dark:text-gray-400 transition-colors duration-200","aria-label":f(),title:f(),children:d()}),e&&r("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:o==="auto"?`Auto (${n})`:o})]}):r("div",{className:`theme-toggle ${t}`,...a,children:r("select",{value:o,onChange:h=>u(h.currentTarget.value),className:"theme-select",children:l.map(h=>r("option",{value:h.value,children:[h.icon," ",h.label]},h.value))})})}function ea({onSidebarToggle:t,provider:e}){const[s,a]=k("ws");return H(()=>{if(!e||!e.onStatus)return;const o=e.onStatus(n=>a(n.channel));return()=>{o&&o()}},[e]),r("header",{className:"sticky top-0 z-30 bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm border-b border-gray-100 dark:border-gray-700",children:r("div",{className:"flex items-center justify-between h-14 px-4",children:[r("div",{className:"flex items-center gap-3",children:[t&&r("button",{onClick:t,className:"p-1.5 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-500 dark:text-gray-300 transition-all duration-200","aria-label":"Toggle sidebar",children:r("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 6h16M4 12h16M4 18h16"})})}),r("div",{className:"flex items-center lg:hidden select-none",children:[r("div",{className:"w-6 h-6 bg-gradient-to-br from-blue-500 to-blue-600 rounded flex items-center justify-center shadow-sm mr-2",children:r("span",{className:"text-white font-bold text-xs",children:"O"})}),r("span",{className:"text-sm font-semibold text-gray-900 dark:text-white tracking-tight",children:"Outway"})]})]}),r("div",{className:"flex items-center gap-2",children:[r("span",{className:`px-2 py-0.5 text-xs rounded-full ${s==="ws"?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300":"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300"}`,title:s==="ws"?"WebSocket live":"REST fallback",children:s.toUpperCase()}),(e==null?void 0:e.reconnect)&&s==="rest"&&r("button",{className:"inline-flex items-center gap-1 text-xs px-2 py-1 rounded-md border border-gray-300 dark:border-gray-600/50 text-gray-700 dark:text-gray-200 bg-transparent hover:bg-gray-50 dark:hover:bg-gray-700/50",title:"Try reconnect WebSocket",onClick:()=>e.reconnect&&e.reconnect(),children:[r("svg",{className:"w-3.5 h-3.5",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:r("path",{fillRule:"evenodd",d:"M4.083 9.75A6.75 6.75 0 0117.5 10a.75.75 0 001.5 0A8.25 8.25 0 103.5 15.398V13a.75.75 0 00-1.5 0v4a.75.75 0 00.75.75H7a.75.75 0 000-1.5H4.84A6.73 6.73 0 014.083 9.75z",clipRule:"evenodd"})}),"Reconnect"]}),r("div",{className:"mx-1",children:r(Ks,{variant:"button"})})]})]})})}function $r({children:t,className:e=""}){return r("div",{className:`overflow-auto border border-gray-200 dark:border-gray-700 rounded-lg ${e}`,children:r("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:t})})}function Dr({children:t}){return r("thead",{className:"bg-gray-50 dark:bg-gray-900",children:t})}function ie({children:t}){return r("tr",{children:t})}function ee({children:t,sortable:e=!1,active:s=!1,order:a="asc",onClick:o}){return r("th",{onClick:o,className:`px-4 py-2 text-left text-xs font-medium uppercase tracking-wider ${e?"cursor-pointer select-none":""} text-gray-500 dark:text-gray-400`,children:r("span",{className:"inline-flex items-center gap-1",children:[t,e&&s&&r("svg",{className:"w-3 h-3",viewBox:"0 0 20 20",fill:"currentColor",children:r("path",{d:a==="asc"?"M5 12l5-5 5 5H5z":"M5 8l5 5 5-5H5z"})})]})})}function Or({children:t}){return r("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:t})}function Z({children:t,align:e="left",colSpan:s,title:a}){return r("td",{className:`px-4 py-2 text-sm ${e==="right"?"text-right":""}`,colSpan:s,title:a,children:t})}function Fe({isOpen:t,title:e,children:s,onClose:a,primaryAction:o,secondaryAction:n,size:i="md",className:u=""}){return H(()=>{const d=f=>{f.key==="Escape"&&t&&a()};return t&&(document.addEventListener("keydown",d),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",d),document.body.style.overflow="unset"}},[t,a]),t?r("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[r("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:a}),r("div",{className:"flex min-h-full items-center justify-center p-4",children:r("div",{className:`relative w-full ${{sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl"}[i]} transform overflow-hidden rounded-lg bg-white dark:bg-gray-800 shadow-xl transition-all ${u}`,children:[e&&r("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:r("div",{className:"flex items-center justify-between",children:[r("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:e}),r("button",{onClick:a,className:"p-1 rounded-md text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",children:r("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),r("div",{className:"px-6 py-4",children:s}),(o||n)&&r("div",{className:"px-6 py-4 border-t border-gray-200 dark:border-gray-700",children:r("div",{className:"flex justify-end space-x-3",children:[n&&r(U,{variant:n.variant||"outline",onClick:n.onClick,disabled:n.disabled,children:n.label}),o&&r(U,{variant:o.variant||"primary",onClick:o.onClick,loading:o.loading,disabled:o.disabled,children:o.label})]})})]})})]}):null}function Ar({message:t,type:e="info",duration:s=5e3,onClose:a,position:o="top-right"}){const[n,i]=k(!1);H(()=>{const f=setTimeout(()=>i(!0),100),l=setTimeout(()=>{i(!1),setTimeout(a,300)},s);return()=>{clearTimeout(f),clearTimeout(l)}},[s,a]);const u={success:{bg:"bg-green-50 dark:bg-green-900",border:"border-green-200 dark:border-green-700",text:"text-green-800 dark:text-green-200",icon:r("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})},error:{bg:"bg-red-50 dark:bg-red-900",border:"border-red-200 dark:border-red-700",text:"text-red-800 dark:text-red-200",icon:r("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 16.5c-.77.833.192 2.5 1.732 2.5z"})})},warning:{bg:"bg-yellow-50 dark:bg-yellow-900",border:"border-yellow-200 dark:border-yellow-700",text:"text-yellow-800 dark:text-yellow-200",icon:r("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 16.5c-.77.833.192 2.5 1.732 2.5z"})})},info:{bg:"bg-blue-50 dark:bg-blue-900",border:"border-blue-200 dark:border-blue-700",text:"text-blue-800 dark:text-blue-200",icon:r("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}},m={"top-right":"top-4 right-4","top-left":"top-4 left-4","bottom-right":"bottom-4 right-4","bottom-left":"bottom-4 left-4"},d=u[e];return r("div",{className:`fixed ${m[o]} z-50 max-w-sm w-full`,children:r("div",{className:`${d.bg} ${d.border} border rounded-lg shadow-lg p-4 transition-all duration-300 ${n?"transform translate-x-0 opacity-100":"transform translate-x-full opacity-0"}`,children:r("div",{className:"flex items-start",children:[r("div",{className:`flex-shrink-0 ${d.text}`,children:d.icon}),r("div",{className:"ml-3 flex-1",children:r("p",{className:`text-sm font-medium ${d.text}`,children:t})}),r("div",{className:"ml-4 flex-shrink-0",children:r("button",{onClick:()=>{i(!1),setTimeout(a,300)},className:`${d.text} hover:opacity-75 transition-opacity`,children:r("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})})]})})})}function ta({toasts:t,onRemove:e}){return r("div",{className:"fixed inset-0 pointer-events-none z-50",children:t.map(s=>r(Ar,{message:s.message,type:s.type,duration:s.duration,onClose:()=>e(s.id)},s.id))})}function Ne({size:t="md",color:e="primary",text:s,className:a=""}){const o={sm:"w-4 h-4",md:"w-6 h-6",lg:"w-8 h-8"},n={primary:"text-blue-600",secondary:"text-gray-600",white:"text-white"};return r("div",{className:`flex items-center justify-center ${a}`,children:r("div",{className:"flex flex-col items-center space-y-2",children:[r("div",{className:`${o[t]} ${n[e]} animate-spin`,children:r("svg",{className:"w-full h-full",fill:"none",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[r("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),s&&r("p",{className:`text-sm ${n[e]} dark:text-gray-400`,children:s})]})})}function ra({provider:t}){const e=Er(),{setRuleGroups:s,setError:a}=Tr(),[o,n]=k(""),[i,u]=k(""),[m,d]=k(""),[f,l]=k([""]),[h,c]=k(!0),[_,w]=k(""),[C,x]=k(!1),[v,E]=k(null),[N,P]=k({});H(()=>{const b=t.onRuleGroups(S=>{s(S)});return t.fetchRuleGroups().then(s).catch(S=>{console.error("Failed to fetch rule groups:",S),a(S.message)}),b},[t,s,a]);const $=e.filter(b=>{var S;return b.name.toLowerCase().includes(_.toLowerCase())||((S=b.description)==null?void 0:S.toLowerCase().includes(_.toLowerCase()))||b.patterns.some(D=>D.toLowerCase().includes(_.toLowerCase()))}),W=()=>{l([...f,""])},L=b=>{l(f.filter((S,D)=>D!==b))},R=(b,S)=>{const D=[...f];D[b]=S,l(D)},j=async b=>{if(b.preventDefault(),!o.trim()||!m.trim()||f.some(S=>!S.trim())){a("Please fill in all required fields");return}x(!0);try{const S={name:o.trim(),description:i.trim()||"",via:m.trim(),patterns:f.filter(D=>D.trim()),pin_ttl:h};await t.createRuleGroup(S),n(""),u(""),d(""),l([""]),c(!0)}catch(S){console.error("Failed to create rule group:",S),a(S instanceof Error?S.message:"Failed to create rule group")}finally{x(!1)}},M=b=>{P(S=>({...S,[b.name]:{...b}}))},p=b=>{P(S=>{const D={...S};return delete D[b],D})},g=(b,S,D)=>{P(J=>({...J,[b]:{...J[b],[S]:D}}))},y=(b,S,D)=>{P(J=>{const me=J[b];if(!me)return J;const Re=me.patterns.slice();return Re[S]=D,{...J,[b]:{...me,patterns:Re}}})},A=b=>{P(S=>{const D=S[b];return D?{...S,[b]:{...D,patterns:[...D.patterns,""]}}:S})},F=(b,S)=>{P(D=>{const J=D[b];if(!J)return D;const me=J.patterns.filter((Re,Mr)=>Mr!==S);return{...D,[b]:{...J,patterns:me}}})},B=async b=>{const S=N[b];if(S)try{await t.updateRuleGroup(b,{name:S.name,description:S.description||"",via:S.via,patterns:S.patterns.filter(J=>J.trim()),pin_ttl:!!S.pin_ttl}),p(b);const D=await t.fetchRuleGroups();s(D)}catch(D){console.error("Failed to update rule group:",D),a(D instanceof Error?D.message:"Failed to update rule group")}},T=async b=>{try{await t.deleteRuleGroup(b),E(null)}catch(S){console.error("Failed to delete rule group:",S),a(S instanceof Error?S.message:"Failed to delete rule group")}};return r("div",{className:"space-y-6",children:[r("div",{className:"flex items-center justify-between",children:r("div",{children:[r("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Rule Groups"}),r("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Manage DNS routing rules and patterns"})]})}),r(q,{title:"Add New Rule Group",subtitle:"Create a new routing rule group",children:r("form",{onSubmit:j,className:"space-y-6",children:[r("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r(G,{label:"Group Name",value:o,onInput:b=>n(b.target.value),placeholder:"e.g., YouTube",required:!0}),r(G,{label:"Via Interface",value:m,onInput:b=>d(b.target.value),placeholder:"e.g., utun4",required:!0})]}),r(G,{label:"Description",value:i,onInput:b=>u(b.target.value),placeholder:"Optional description"}),r("div",{children:[r("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"DNS Patterns *"}),f.map((b,S)=>r("div",{className:"flex gap-3 mb-3",children:[r("div",{className:"flex-1",children:r(G,{value:b,onInput:D=>R(S,D.target.value),placeholder:"e.g., *.youtube.com",required:!0})}),f.length>1&&r(U,{type:"button",variant:"outline",size:"sm",onClick:()=>L(S),children:"Remove"})]},S)),r(U,{type:"button",variant:"secondary",size:"sm",onClick:W,children:"Add Pattern"})]}),r("div",{className:"flex items-center gap-3",children:[r("input",{type:"checkbox",id:"pin-ttl",checked:h,onChange:b=>c(b.target.checked),className:"rounded border-gray-300 dark:border-gray-600 text-black dark:text-white focus:ring-black dark:focus:ring-white"}),r("label",{htmlFor:"pin-ttl",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:r("span",{className:"input-label",children:"Pin TTL (keep IP/route until TTL expires)"})})]}),r("div",{className:"flex gap-3 pt-4 border-t border-gray-200 dark:border-gray-700",children:r(U,{type:"submit",variant:"primary",loading:C,disabled:C,children:C?"Creating...":"Create Rule Group"})})]})}),r("div",{children:r(G,{label:"Search Rule Groups",value:_,onInput:b=>w(b.target.value),placeholder:"Search by name, description, or pattern...",hint:"Filter rule groups by name, description, or DNS patterns"})}),r("div",{className:"grid gap-4",children:$.map(b=>r(q,{title:b.name,subtitle:b.description,children:[r("div",{className:"flex justify-between items-start mb-4",children:[r("div",{className:"flex items-center gap-3",children:[r(ge,{variant:"primary",children:b.patterns.length}),r("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:b.patterns.length===1?"pattern":"patterns"})]}),r("div",{className:"flex gap-2",children:[N[b.name]?r(Q,{children:[r(U,{variant:"secondary",size:"sm",onClick:()=>p(b.name),children:"Cancel"}),r(U,{variant:"primary",size:"sm",onClick:()=>B(b.name),children:"Save"})]}):r(U,{variant:"secondary",size:"sm",onClick:()=>M(b),children:"Edit"}),r(U,{variant:"outline",size:"sm",onClick:()=>E(b.name),children:"Delete"})]})]}),N[b.name]?r("div",{className:"space-y-4",children:[r("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[r("div",{className:"flex items-center gap-2",children:[r("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Via Interface:"}),r(G,{value:N[b.name].via,onInput:S=>g(b.name,"via",S.target.value)})]}),r("div",{className:"flex items-center gap-2",children:[r("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Pin TTL:"}),r("input",{type:"checkbox",checked:!!N[b.name].pin_ttl,onChange:S=>g(b.name,"pin_ttl",S.target.checked)})]})]}),r("div",{children:[r("span",{className:"font-medium text-sm text-gray-700 dark:text-gray-300",children:"Description:"}),r(G,{value:N[b.name].description||"",onInput:S=>g(b.name,"description",S.target.value),placeholder:"Optional description"})]}),r("div",{className:"mt-2 pt-2 border-t border-gray-200 dark:border-gray-700",children:[r("span",{className:"font-medium text-sm text-gray-700 dark:text-gray-300",children:"DNS Patterns:"}),N[b.name].patterns.map((S,D)=>r("div",{className:"flex gap-2 mt-2",children:[r(G,{value:S,onInput:J=>y(b.name,D,J.target.value)}),r(U,{variant:"outline",size:"sm",onClick:()=>F(b.name,D),children:"Remove"})]},D)),r(U,{className:"mt-2",variant:"secondary",size:"sm",onClick:()=>A(b.name),children:"Add Pattern"})]})]}):r(Q,{children:[r("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[r("div",{className:"flex items-center gap-2",children:[r("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Via Interface:"}),r(ge,{variant:"secondary",children:b.via})]}),r("div",{className:"flex items-center gap-2",children:[r("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Pin TTL:"}),r(ge,{variant:b.pin_ttl?"primary":"secondary",children:b.pin_ttl?"Yes":"No"})]})]}),r("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[r("span",{className:"font-medium text-sm text-gray-700 dark:text-gray-300",children:"DNS Patterns:"}),r("div",{className:"flex flex-wrap gap-2 mt-2",children:b.patterns.map((S,D)=>r("span",{className:"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200 px-2 py-1 rounded text-xs font-mono",children:S},D))})]})]})]},b.name))}),$.length===0&&r(q,{className:"text-center py-8",children:r("p",{className:"text-secondary",children:_?"No rule groups match your search.":"No rule groups configured."})}),v&&r("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r(q,{className:"max-w-md w-full mx-4",children:[r("h3",{className:"text-lg font-semibold mb-4",children:"Confirm Delete"}),r("p",{className:"text-secondary mb-6",children:['Are you sure you want to delete the rule group "',v,'"? This action cannot be undone.']}),r("div",{className:"flex gap-3 justify-end",children:[r(U,{variant:"secondary",onClick:()=>E(null),children:"Cancel"}),r(U,{variant:"danger",onClick:()=>T(v),children:"Delete"})]})]})})]})}function sa(t){return Js[t]||`TYPE${t}`}function aa(t){return t.length>50?t.substring(0,47)+"...":t}function na(t){return new Date(typeof t=="string"?t:t*1e3).toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"})}function oa(t){return t.trim()?[/^udp:[a-zA-Z0-9.-]+:\d+$/,/^tcp:[a-zA-Z0-9.-]+:\d+$/,/^https?:\/\/[a-zA-Z0-9.-]+(\/.*)?$/,/^[a-zA-Z0-9.-]+:\d+$/,/^[a-zA-Z0-9.-]+$/].some(a=>a.test(t))?{valid:!0}:{valid:!1,error:"Invalid upstream format. Use: udp:host:port, tcp:host:port, https://host/path, or host:port"}:{valid:!1,error:"Upstream is required"}}function ia({provider:t}){const e=Pr(),{setUpstreams:s,addUpstream:a,removeUpstream:o,setError:n}=Rr(),[i,u]=k(""),[m,d]=k(""),[f,l]=k(""),[h,c]=k(!1),[_,w]=k(null),[C,x]=k("asc"),[v,E]=k({});H(()=>t.onUpstreams(g=>{s(g)}),[t,s,n]);const N=[...e||[]].sort((p,g)=>{const y=(p.name||p.address).localeCompare(g.name||g.address);return C==="asc"?y:-y}),P=async p=>{p.preventDefault();const g=oa(i);if(!g.valid){n(g.error);return}c(!0),n(null);try{let y=i.trim();try{const B=new URL(y),T=B.protocol.replace(":","").toLowerCase();T!=="https"&&(y=`${T==="tls"?"dot":T==="quic"?"doq":T}://${B.host}`)}catch{y=`udp://${y.replace(/^(udp|tcp|tls|dot|quic|doq):\/\//i,"")}`}const A={name:(m||new URL(y).hostname).trim(),address:y};f!==""&&(A.weight=Number(f)),a(A);const F=[...e,A];await t.saveUpstreams(F),u(""),d(""),l("")}catch(y){console.error("Failed to save upstream:",y),n(y instanceof Error?y.message:"Failed to save upstream")}finally{c(!1)}},$=async p=>{try{o(p);const g=e.filter(y=>y.address!==p);await t.saveUpstreams(g),w(null)}catch(g){console.error("Failed to delete upstream:",g),n(g instanceof Error?g.message:"Failed to delete upstream")}},W=p=>{const g=e.find(y=>y.address===p);g&&E(y=>({...y,[p]:{...g}}))},L=p=>{E(g=>{const y={...g};return delete y[p],y})},R=async p=>{const g=v[p];if(!g)return;const y=e.find(T=>T.address===p);if(!y)return;const A={name:(g.name??y.name??"").trim(),address:(g.address??y.address).trim()},F=g.weight===void 0?y.weight:Number(g.weight);F!==void 0&&(A.weight=F);const B=e.map(T=>T.address===p?A:T);try{s(B),await t.saveUpstreams(B),L(p)}catch(T){console.error("Failed to save edit:",T),n(T instanceof Error?T.message:"Failed to save")}},j=(p,g,y)=>{E(A=>({...A,[p]:{...A[p],[g]:g==="weight"?y===""?void 0:Number(y):y}}))},M=()=>{x(p=>p==="asc"?"desc":"asc")};return r("div",{className:"space-y-6",children:[r("div",{className:"flex items-center justify-between",children:r("div",{children:[r("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Upstreams"}),r("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Manage DNS upstream servers and their configuration"})]})}),r(q,{title:"Add New Upstream",subtitle:"Add a new DNS upstream server",children:r("form",{onSubmit:P,className:"space-y-6",children:[r("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r(G,{label:"Name",value:m,onInput:p=>d(p.target.value),placeholder:"Human-friendly name"}),r(G,{label:"Address",value:i,onInput:p=>u(p.target.value),placeholder:"udp://8.8.8.8:53 or https://dns.google/dns-query",hint:"Use URL form",required:!0}),r(G,{label:"Weight",type:"number",value:f,onInput:p=>l(p.target.value===""?"":Number(p.target.value)),placeholder:"1"})]}),r("div",{className:"flex gap-3 pt-4 border-t border-gray-200 dark:border-gray-700",children:r(U,{type:"submit",variant:"primary",loading:h,disabled:h,children:h?"Adding...":"Add Upstream"})})]})}),r(q,{title:"Configured Upstreams",subtitle:`${e.length} upstream server${e.length===1?"":"s"} configured`,children:[r("div",{className:"flex justify-between items-center mb-6",children:[r("div",{className:"flex items-center gap-3",children:[r(ge,{variant:"primary",children:e.length}),r("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.length===1?"upstream server":"upstream servers"})]}),r(U,{variant:"secondary",size:"sm",onClick:M,title:`Sort ${C==="asc"?"Z-A":"A-Z"}`,children:C==="asc"?"A-Z":"Z-A"})]}),N.length===0?r("div",{className:"text-center py-8",children:r("p",{className:"text-gray-600 dark:text-gray-400",children:"No upstream servers configured yet."})}):r("div",{className:"space-y-3",children:N.map(p=>{var g,y,A;return r("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:v[p.address]?r("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 items-end",children:[r(G,{label:"Name",value:((g=v[p.address])==null?void 0:g.name)??p.name,onInput:F=>j(p.address,"name",F.target.value)}),r(G,{label:"Address",value:((y=v[p.address])==null?void 0:y.address)??p.address,onInput:F=>j(p.address,"address",F.target.value)}),r(G,{label:"Weight",type:"number",value:((A=v[p.address])==null?void 0:A.weight)??p.weight??"",onInput:F=>j(p.address,"weight",F.target.value)}),r("div",{className:"flex gap-2 justify-end",children:[r(U,{variant:"outline",size:"sm",onClick:()=>L(p.address),children:"Cancel"}),r(U,{variant:"primary",size:"sm",onClick:()=>R(p.address),children:"Save"})]})]}):r("div",{className:"flex items-center justify-between gap-4",children:[r("div",{className:"flex flex-col min-w-0",children:[r("span",{className:"text-sm text-gray-500 dark:text-gray-400 truncate max-w-[420px]",title:p.name||"Unnamed",children:p.name||"Unnamed"}),r("span",{className:"mt-1 px-2 py-1 rounded bg-gray-200 dark:bg-gray-700 text-gray-900 dark:text-gray-100 text-xs font-mono truncate max-w-[520px]",title:p.address,children:p.address})]}),r("div",{className:"flex items-center gap-3",children:[r("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["weight: ",p.weight??1]}),r(U,{variant:"secondary",size:"sm",onClick:()=>W(p.address),children:"Edit"}),r(U,{variant:"outline",size:"sm",onClick:()=>w(p.address),children:"Delete"})]})]})},p.address)})})]}),_&&r("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50",children:r("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-200 dark:border-gray-700 p-6 max-w-md w-full",children:[r("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Delete Upstream"}),r("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:["Are you sure you want to delete upstream ",r("strong",{children:['"',_,'"']}),"? This action cannot be undone."]}),r("div",{className:"flex gap-3 justify-end",children:[r(U,{variant:"outline",onClick:()=>w(null),children:"Cancel"}),r(U,{variant:"primary",onClick:()=>$(_),children:"Delete"})]})]})})]})}function la({provider:t}){const e=Gs(),{setEvents:s,setError:a}=qs(),[o,n]=k(""),[i,u]=k(200);H(()=>{const f=t.onHistory(l=>{s(l)});return t.fetchHistory().then(s).catch(l=>{console.error("Failed to fetch history:",l),a(l.message)}),f},[t,s,a]);const m=se(()=>{let f=e;if(o.trim()){const l=o.toLowerCase();f=e.filter(h=>h.name.toLowerCase().includes(l))}return f.slice(0,i)},[e,o,i]),d=()=>e.length<=i?r(Q,{}):r("div",{style:{marginTop:"12px",textAlign:"center"},children:[r("span",{className:"muted",children:["Showing ",i," of ",e.length," events."]}),i<1e3&&r("button",{className:"ow-btn ow-btn--secondary ow-btn--sm",style:{marginLeft:"8px"},onClick:()=>u(Math.min(i*2,2e3)),children:"Show More"})]});return r("div",{className:"space-y-6",children:[r("div",{className:"flex items-center justify-between",children:r("div",{children:[r("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Query History"}),r("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"View DNS query history and performance metrics"})]})}),r(q,{title:"Search and Filters",subtitle:"Filter DNS query history",children:r("div",{className:"space-y-4",children:[r(G,{label:"Filter by Domain",value:o,onInput:f=>n(f.target.value),placeholder:"Filter by domain name...",hint:"Enter a domain name to filter the results"}),r("div",{className:"flex items-center justify-between",children:[r("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Showing ",m.length," of ",e.length," events"]}),e.length>i&&r("button",{className:"text-sm text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300",onClick:()=>u(Math.min(i*2,2e3)),children:"Show More"})]})]})}),r(q,{title:"Query History",subtitle:`${m.length} DNS queries`,children:m.length===0?r("div",{className:"text-center py-8",children:r("p",{className:"text-gray-600 dark:text-gray-400",children:e.length===0?"No query history available":"No queries match filter"})}):r("div",{className:"overflow-x-auto",children:[r("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700 table-auto",children:[r("thead",{className:"bg-gray-50 dark:bg-gray-800",children:r("tr",{children:[r("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Time"}),r("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Domain"}),r("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Type"}),r("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Client IP"}),r("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Upstream"}),r("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Duration"}),r("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Status"})]})}),r("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700",children:m.map((f,l)=>r("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:[r("td",{className:"px-4 sm:px-6 py-3 sm:py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:na(f.time)}),r("td",{className:"px-4 sm:px-6 py-3 sm:py-4 whitespace-normal sm:whitespace-nowrap break-words text-sm font-medium text-gray-900 dark:text-gray-100",children:f.name}),r("td",{className:"px-4 sm:px-6 py-3 sm:py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:sa(f.qtype)}),r("td",{className:"px-4 sm:px-6 py-3 sm:py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400 font-mono",children:f.client_ip||"unknown"}),r("td",{className:"px-4 sm:px-6 py-3 sm:py-4 whitespace-normal sm:whitespace-nowrap break-words text-sm text-gray-500 dark:text-gray-400",title:f.upstream,children:aa(f.upstream)}),r("td",{className:"px-4 sm:px-6 py-3 sm:py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:f.duration}),r("td",{className:"px-4 sm:px-6 py-3 sm:py-4 whitespace-nowrap",children:r("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${f.status==="ok"?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400":"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400"}`,children:f.status==="ok"?"OK":"Error"})})]},`${f.time}-${f.name}-${l}`))})]}),d()]})})]})}function ca({provider:t}){const[e,s]=k([]),[a,o]=k(!0),[n,i]=k(null);H(()=>{let h=t.onHosts(c=>{s(c),o(!1)});return t.fetchHosts().then(s).catch(c=>i(String(c))).finally(()=>o(!1)),()=>{h()}},[t]);const u=()=>s(h=>[...h,{pattern:"",a:[],aaaa:[],ttl:60}]),m=h=>s(c=>c.filter((_,w)=>w!==h)),d=(h,c)=>s(_=>_.map((w,C)=>C===h?{...w,...c}:w)),f=h=>h?h.split(",").map(c=>c.trim()).filter(Boolean):[];return r("div",{className:"space-y-6",children:[r("div",{className:"flex items-center justify-between",children:[r("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Hosts"}),r("div",{className:"space-x-2",children:[r(U,{variant:"secondary",onClick:u,children:"Add"}),r(U,{onClick:async()=>{i(null);try{await t.saveHosts(e)}catch(h){i(String(h))}},children:"Save"})]})]}),n&&r("div",{className:"text-red-600 text-sm",children:n}),r(q,{title:"Overrides",subtitle:"Static DNS responses with wildcard support",children:a?r("div",{className:"text-gray-500",children:"Loading..."}):r("div",{className:"overflow-x-auto",children:r("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[r("thead",{className:"bg-gray-50 dark:bg-gray-800",children:r("tr",{children:[r("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:"Pattern"}),r("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:"A (comma separated)"}),r("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:"AAAA (comma separated)"}),r("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:"TTL"}),r("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),r("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700",children:[e.map((h,c)=>r("tr",{children:[r("td",{className:"px-3 py-2 w-[28%]",children:r(G,{value:h.pattern||"",onInput:_=>d(c,{pattern:_.currentTarget.value}),placeholder:"e.g. *.example.com"})}),r("td",{className:"px-3 py-2 w-[28%]",children:r(G,{value:(h.a||[]).join(", "),onInput:_=>d(c,{a:f(_.currentTarget.value)}),placeholder:"127.0.0.1, 10.0.0.1"})}),r("td",{className:"px-3 py-2 w-[28%]",children:r(G,{value:(h.aaaa||[]).join(", "),onInput:_=>d(c,{aaaa:f(_.currentTarget.value)}),placeholder:"::1, 2001:db8::1"})}),r("td",{className:"px-3 py-2 w-[8%]",children:r(G,{type:"number",value:String(h.ttl??60),onInput:_=>d(c,{ttl:Number(_.currentTarget.value)}),placeholder:"60"})}),r("td",{className:"px-3 py-2 text-right w-[8%]",children:r(U,{variant:"danger",onClick:()=>m(c),children:"Del"})})]},c)),e.length===0&&r("tr",{children:r("td",{colSpan:5,className:"px-3 py-6 text-sm text-gray-500 text-center",children:"No hosts configured. Click Add to create one."})})]})]})})})]})}function da({provider:t}){const[e,s]=k([]),[a,o]=k(!1),[n,i]=k(null),[u,m]=k(!1),[d,f]=k(null),[l,h]=k("idle");H(()=>{(async()=>{try{if(o(!0),t.fetchDevices){const E=await t.fetchDevices();s(E.devices||[])}}catch(E){i("Failed to load devices"),console.error("Failed to load devices:",E)}finally{o(!1)}})()},[t]);const c=async v=>{f(v),m(!0),h("waking");try{if(!t.wakeDevice)throw new Error("Wake device API not available");const E={id:v.id},N=await t.wakeDevice(E);h(N.success?"success":"error"),N.success&&s(P=>P.map($=>$.id===v.id?{...$,status:"online",last_seen:new Date().toISOString()}:$))}catch(E){h("error"),console.error("Failed to wake device:",E)}},_=async()=>{o(!0),i(null);try{if(t.scanDevices){const v=await t.scanDevices();s(v.devices||[])}else if(t.fetchDevices){const v=await t.fetchDevices();s(v.devices||[])}}catch(v){i("Failed to scan network"),console.error("Failed to scan network:",v)}finally{o(!1)}},w=v=>{switch(v){case"online":return"primary";case"offline":return"secondary";case"unknown":return"default";default:return"default"}},C=v=>{switch(v){case"online":return"Online";case"offline":return"Offline";case"unknown":return"Unknown";default:return"Unknown"}},x=v=>{const E=new Date(v),P=new Date().getTime()-E.getTime(),$=Math.floor(P/6e4),W=Math.floor($/60),L=Math.floor(W/24);return $<1?"Just now":$<60?`${$}m ago`:W<24?`${W}h ago`:`${L}d ago`};return r("div",{className:"space-y-6",children:[r("div",{className:"flex items-center justify-between",children:[r("div",{children:[r("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Devices"}),r("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Manage network devices, DNS resolution, and Wake-on-LAN"})]}),r("div",{className:"flex items-center space-x-3",children:r(U,{variant:"outline",onClick:_,loading:a,children:[r("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),"Scan Network"]})})]}),n&&r("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:r("div",{className:"flex",children:[r("svg",{className:"w-5 h-5 text-red-400 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),r("div",{children:[r("h3",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:"Error"}),r("p",{className:"text-sm text-red-700 dark:text-red-300 mt-1",children:n})]})]})}),r("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[r(q,{children:r("div",{className:"flex items-center",children:[r("div",{className:"p-3 bg-green-100 dark:bg-green-900/20 rounded-lg",children:r("svg",{className:"w-6 h-6 text-green-600 dark:text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),r("div",{className:"ml-4",children:[r("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Online Devices"}),r("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:e.filter(v=>v.status==="online").length})]})]})}),r(q,{children:r("div",{className:"flex items-center",children:[r("div",{className:"p-3 bg-red-100 dark:bg-red-900/20 rounded-lg",children:r("svg",{className:"w-6 h-6 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),r("div",{className:"ml-4",children:[r("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Offline Devices"}),r("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:e.filter(v=>v.status==="offline").length})]})]})}),r(q,{children:r("div",{className:"flex items-center",children:[r("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/20 rounded-lg",children:r("svg",{className:"w-6 h-6 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),r("div",{className:"ml-4",children:[r("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Devices"}),r("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:e.length})]})]})})]}),r(q,{title:"Network Devices",subtitle:"Manage and wake up devices on your network",children:r($r,{children:[r(Dr,{children:r(ie,{children:[r(ee,{children:"Device Name"}),r(ee,{children:"MAC Address"}),r(ee,{children:"IP Address"}),r(ee,{children:"Status"}),r(ee,{children:"Last Seen"}),r(ee,{children:"Vendor"}),r(ee,{children:"Actions"})]})}),r(Or,{children:e.length===0?r(ie,{children:r(Z,{colSpan:7,children:r("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:a?"Loading...":"No devices found. Try scanning the network or adding a device manually."})})}):e.map(v=>r(ie,{children:[r(Z,{children:r("span",{className:"font-medium",children:v.name})}),r(Z,{children:r("span",{className:"font-mono text-sm",children:v.mac})}),r(Z,{children:v.ip}),r(Z,{children:r(ge,{variant:w(v.status),children:C(v.status)})}),r(Z,{children:x(v.last_seen)}),r(Z,{children:v.vendor||"Unknown"}),r(Z,{children:r("div",{className:"flex space-x-2",children:r(U,{size:"sm",variant:"outline",onClick:()=>c(v),disabled:v.status==="online",children:[r("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"Wake"]})})})]},v.id))})]})}),r(Fe,{isOpen:u,onClose:()=>{m(!1),h("idle")},title:"Wake Up Device",children:r("div",{className:"space-y-4",children:[r("div",{className:"text-center",children:[r("div",{className:"w-16 h-16 bg-blue-100 dark:bg-blue-900/20 rounded-full flex items-center justify-center mx-auto mb-4",children:r("svg",{className:"w-8 h-8 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),r("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:(d==null?void 0:d.name)||"Unknown Device"}),r("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:(d==null?void 0:d.mac)||"Unknown MAC"})]}),l==="waking"&&r("div",{className:"text-center",children:[r("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),r("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Sending wake-up packet..."})]}),l==="success"&&r("div",{className:"text-center",children:[r("div",{className:"w-8 h-8 bg-green-100 dark:bg-green-900/20 rounded-full flex items-center justify-center mx-auto mb-2",children:r("svg",{className:"w-5 h-5 text-green-600 dark:text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),r("p",{className:"text-sm text-green-600 dark:text-green-400",children:"Wake-up packet sent successfully!"})]}),l==="error"&&r("div",{className:"text-center",children:[r("div",{className:"w-8 h-8 bg-red-100 dark:bg-red-900/20 rounded-full flex items-center justify-center mx-auto mb-2",children:r("svg",{className:"w-5 h-5 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),r("p",{className:"text-sm text-red-600 dark:text-red-400",children:"Failed to send wake-up packet"})]}),r("div",{className:"flex justify-end space-x-3 mt-6",children:[r(U,{variant:"outline",onClick:()=>{m(!1),h("idle")},children:"Close"}),l==="idle"&&d&&r(U,{onClick:()=>c(d),children:"Send Wake Packet"})]})]})})]})}const ua=(t,e)=>{const s=e.split("/"),a=s[0],o=s[1];if(!a||!o)return null;for(const n of t){const i=n.name.toLowerCase();if(i.includes(a.toLowerCase())&&i.includes(o.toLowerCase()))return n}for(const n of t)if(n.name.toLowerCase().includes(a.toLowerCase()))return n;for(const n of t){const i=n.name.toLowerCase();if(i.includes(".tar.gz")||i.includes(".zip")||i.includes(".bin"))return n}return null},ha=({provider:t})=>{const[e,s]=k(null),[a,o]=k(null),[n,i]=k(!1),[u,m]=k(!1),[d,f]=k(!1),[l,h]=k(!1),[c,_]=k(null),[w,C]=k(null),x=(L,R)=>{_({message:L,type:R}),setTimeout(()=>_(null),5e3)};H(()=>t?t.onUpdateAvailable(R=>{console.log("WebSocket update notification received:",R),s(R),x(`Update available: ${R.latest_version}`,"success")}):void 0,[t]);const v=async()=>{i(!0);try{const L=await fetch("/api/v1/update/check");if(!L.ok)throw new Error("Failed to check for updates");const R=await L.json();s(R)}catch(L){x(`Failed to check for updates: ${L}`,"error")}finally{i(!1)}},E=async()=>{var j;if(!((j=e==null?void 0:e.release)!=null&&j.assets))return;const L=(a==null?void 0:a.platform)||"",R=ua(e.release.assets,L);if(!R){x("No suitable update found for your platform","error");return}m(!0);try{const M=await fetch("/api/v1/update/download",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({download_url:R.browser_download_url})});if(!M.ok)throw new Error("Failed to download update");const p=await M.json();C(p.path),x("Update downloaded successfully","success")}catch(M){x(`Failed to download update: ${M}`,"error")}finally{m(!1)}},N=async(L=30,R=2e3)=>{h(!0);let j=0;const M=async()=>{try{return(await fetch("/api/v1/update/status",{method:"HEAD",signal:AbortSignal.timeout(5e3)})).ok}catch{return!1}},p=async()=>{if(j++,j>L){h(!1),x("Server did not come back online after installation. Please check manually.","error");return}if(await M()){h(!1),x("Server is back online! Reloading page...","success"),setTimeout(()=>{window.location.reload()},1e3);return}setTimeout(p,R)};x("Installation complete. Waiting for server to restart...","success"),p()},P=async()=>{if(w){f(!0);try{const L=await fetch("/api/v1/update/install",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({update_path:w})});if(!L.ok)throw new Error("Failed to install update");const R=await L.json();x(R.message||"Update installed successfully. Server will restart...","success"),C(null),await N()}catch(L){x(`Failed to install update: ${L}`,"error")}finally{f(!1)}}},$=L=>new Date(L).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),W=L=>{const R=L.match(/(?:(\d+)h)?(?:(\d+)m)?(?:(\d+(?:\.\d+)?)s)?/);if(!R)return L;const j=parseInt(R[1]||"0"),M=parseInt(R[2]||"0"),p=parseFloat(R[3]||"0"),g=[];return j>0&&g.push(`${j}h`),M>0&&g.push(`${M}m`),p>0&&g.push(`${Math.floor(p)}s`),g.join(" ")||"0s"};return H(()=>{(async()=>{try{const R=await fetch("/api/v1/update/status");if(R.ok){const j=await R.json();o(j)}}catch(R){console.error("Failed to load update status:",R)}})(),v()},[]),r("div",{className:"space-y-6",children:[r("div",{className:"flex items-center justify-between",children:r("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Updates"})}),c&&r(Ar,{message:c.message,type:c.type,onClose:()=>_(null)}),r(q,{children:r("div",{className:"p-6",children:[r("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-6",children:"Current Version"}),a?r("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[r("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-lg p-4",children:[r("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-1",children:"Version"}),r("p",{className:"text-xl font-bold text-gray-900 dark:text-white",children:a.current_version})]}),r("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-lg p-4",children:[r("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-1",children:"Build Time"}),r("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:$(a.build_time)})]}),r("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-lg p-4",children:[r("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-1",children:"Uptime"}),r("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:W(a.uptime)})]}),r("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-lg p-4",children:[r("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-1",children:"Platform"}),r("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:a.platform})]})]}):r("div",{className:"flex items-center justify-center py-12",children:r(Ne,{})})]})}),r(q,{children:r("div",{className:"p-6",children:[r("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[r("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Check for Updates"}),r(U,{onClick:v,disabled:n,className:"flex items-center gap-2 w-full sm:w-auto",children:[n?r(Ne,{size:"sm"}):null,"Check for Updates"]})]}),e&&r("div",{className:"space-y-4",children:[e.has_update?r("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-xl p-6",children:[r("div",{className:"flex items-center gap-3 mb-3",children:[r("div",{className:"w-3 h-3 bg-blue-500 rounded-full animate-pulse"}),r("p",{className:"text-blue-800 dark:text-blue-200 font-semibold text-lg",children:"Update Available"})]}),r("p",{className:"text-blue-700 dark:text-blue-300 text-base mb-2",children:["New version ",r("span",{className:"font-bold",children:e.latest_version})," is available"]}),r("p",{className:"text-blue-600 dark:text-blue-400 text-sm",children:["Current version: ",e.current_version]}),e.release&&r("div",{className:"mt-3 space-y-2",children:[r("p",{className:"text-sm text-blue-600 dark:text-blue-400",children:["Released: ",$(e.release.published_at)]}),e.release.body&&r("details",{className:"mt-2",children:[r("summary",{className:"text-sm text-blue-600 dark:text-blue-400 cursor-pointer hover:underline",children:"Release Notes"}),r("div",{className:"mt-2 p-3 bg-white dark:bg-gray-800 rounded border text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap",children:e.release.body})]})]})]}):r("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-xl p-6",children:[r("div",{className:"flex items-center gap-3 mb-3",children:[r("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),r("p",{className:"text-green-800 dark:text-green-200 font-semibold text-lg",children:"You are up to date"})]}),r("p",{className:"text-green-700 dark:text-green-300 text-base",children:["Running latest version ",r("span",{className:"font-bold",children:e.current_version})]})]}),e.has_update&&r("div",{className:"flex flex-col sm:flex-row gap-3 mt-6",children:w?r(U,{onClick:P,disabled:d||l,className:"flex items-center justify-center gap-2 px-6 py-3 bg-red-600 hover:bg-red-700 text-white font-medium",children:[d?r(Ne,{size:"sm"}):null,l?"Waiting for server...":"Install Update"]}):r(U,{onClick:E,disabled:u,className:"flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium",children:[u?r(Ne,{size:"sm"}):null,"Download Update"]})})]})]})})]})};function ma(t){let e=(t||"").trim();if(!e)return e;e.startsWith("@")&&(e=e.slice(1));try{return new URL(e).hostname||e}catch{}try{return new URL(/^https?:\/\//i.test(e)?e:`http://${e}`).hostname||e}catch{}return e=e.replace(/^\w+:\/\//,""),e=e.replace(/\/.*$/,""),e}function Tt({label:t,value:e,onChange:s,children:a,className:o="",...n}){return r("div",{children:[t&&r("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:t}),r("select",{value:e,onChange:s,className:`w-full px-3 py-2 h-[42px] border border-gray-300 rounded-md bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-800 dark:text-gray-100 dark:border-gray-600 dark:focus:border-blue-400 dark:focus:ring-blue-400 ${o}`,...n,children:a})]})}function fa({provider:t}){const[e,s]=k(""),[a,o]=k(""),[n,i]=k(!1),[u,m]=k([]),[d,f]=k(0),[l,h]=k(0),[c,_]=k(20),[w,C]=k(""),[x,v]=k(""),[E,N]=k("expires"),[P,$]=k("desc"),[W,L]=k({open:!1}),[R,j]=k(!1);H(()=>{try{const g=JSON.parse(localStorage.getItem("cache.ui")||"{}");typeof g.limit=="number"&&_(g.limit),g.sort&&N(g.sort),g.order&&$(g.order)}catch{}},[]),H(()=>{try{localStorage.setItem("cache.ui",JSON.stringify({limit:c,sort:E,order:P}))}catch{}},[c,E,P]),H(()=>{const g=window.setTimeout(()=>v(w),300);return()=>window.clearTimeout(g)},[w]),H(()=>{var F,B,T;const g=(F=t.onCache)==null?void 0:F.call(t,b=>{!b||!Array.isArray(b.items)||(m(b.items),f(b.total||0))});let y=0;const A=(B=t.onCacheUpdated)==null?void 0:B.call(t,()=>{var S;const b=Date.now();b-y<800||(y=b,(S=t.fetchCache)==null||S.call(t,{offset:l,limit:c,q:x,sort:E,order:P}).then(D=>{D&&(m(D.items||[]),f(D.total||0))}).catch(()=>{}))});return(T=t.fetchCache)==null||T.call(t,{offset:l,limit:c,q:x,sort:E,order:P}).then(b=>{b&&(m(b.items||[]),f(b.total||0))}).catch(()=>{}),()=>{g&&g(),A&&A()}},[t,l,c,x,E,P]);const M=se(()=>Math.max(1,Math.ceil(d/c)),[d,c]),p=se(()=>Math.floor(l/c)+1,[l,c]);return r("div",{className:"space-y-6",children:[r("div",{children:[r("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Cache"}),r("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Manage local DNS cache"})]}),r(q,{children:r("div",{className:"space-y-4",children:[r("div",{className:"flex flex-wrap items-end gap-3",children:[r("div",{className:"flex-1 min-w-[260px]",children:r(G,{label:"Domain",value:e,onInput:g=>s(g.target.value),placeholder:"example.com"})}),r("div",{className:"w-64",children:r(Tt,{label:"Type (optional)",value:a,onChange:g=>o(g.target.value),children:[r("option",{value:"",children:"All"}),r("option",{value:"1",children:"A"}),r("option",{value:"28",children:"AAAA"}),r("option",{value:"5",children:"CNAME"}),r("option",{value:"15",children:"MX"}),r("option",{value:"2",children:"NS"}),r("option",{value:"16",children:"TXT"}),r("option",{value:"33",children:"SRV"}),r("option",{value:"12",children:"PTR"})]})}),r("div",{className:"ml-auto flex items-end gap-3",children:[r(U,{type:"button",variant:"secondary",size:"md",className:"h-[42px]",disabled:n,onClick:async()=>{const g=ma(e);if(g){i(!0);try{await t.cacheDelete({name:g,qtype:a?parseInt(a,10):void 0})}finally{i(!1)}}},children:"Delete domain cache"}),r(U,{type:"button",variant:"outline",size:"md",className:"h-[42px]",disabled:n,onClick:()=>j(!0),children:"Flush all"}),r("div",{className:"flex items-center gap-2",children:[r("label",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Per page"}),r(Tt,{value:String(c),onChange:g=>_(parseInt(g.target.value,10)),children:[r("option",{value:"10",children:"10"}),r("option",{value:"20",children:"20"}),r("option",{value:"50",children:"50"})]})]})]})]}),r("div",{children:r(G,{label:"Search",value:w,onInput:g=>C(g.target.value),placeholder:"Filter by domain"})}),r($r,{children:[r(Dr,{children:r(ie,{children:[[{key:"name",label:"Domain"},{key:"qtype",label:"Type"},{key:"answers",label:"Answers"},{key:"expires",label:"Expires"}].map(g=>r(ee,{sortable:!0,active:E===g.key,order:P,onClick:()=>{E===g.key?$(P==="asc"?"desc":"asc"):(N(g.key),$("asc")),h(0)},children:g.label},g.key)),r(ee,{})]})}),r(Or,{children:[u.map(g=>r(ie,{children:[r(Z,{children:g.name}),r(Z,{children:{1:"A",28:"AAAA",5:"CNAME",15:"MX",2:"NS",16:"TXT",33:"SRV",12:"PTR"}[g.qtype]||g.qtype}),r(Z,{children:g.answers}),r(Z,{children:[Math.max(0,Math.floor((new Date(g.expires_at).getTime()-Date.now())/1e3)),"s"]}),r(Z,{align:"right",children:[r(U,{type:"button",size:"sm",variant:"outline",onClick:async()=>{var y,A;i(!0);try{await((y=t.cacheDelete)==null?void 0:y.call(t,{name:g.name,qtype:g.qtype})),await((A=t.fetchCache)==null?void 0:A.call(t,{offset:l,limit:c,q:x,sort:E,order:P}))}finally{i(!1)}},children:"Delete"}),r(U,{type:"button",size:"sm",className:"ml-2",variant:"secondary",onClick:async()=>{try{const y=await t.restProvider.fetchCacheKey(g.key);L({open:!0,key:g.key,data:y})}catch{}},children:"View"})]})]},g.key)),u.length===0&&r(ie,{children:r(Z,{align:"left",colSpan:5,children:[" ",r("span",{className:"px-4 py-6 block text-sm text-gray-500 dark:text-gray-400",children:"No cache entries"})," "]})})]})]}),r("div",{className:"flex items-center justify-between",children:[r("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Total: ",d]}),r("div",{className:"flex items-center gap-2",children:[r(U,{type:"button",variant:"outline",size:"sm",disabled:p<=1,onClick:()=>h(Math.max(0,l-c)),children:"Prev"}),r("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:[p," / ",M]}),r(U,{type:"button",variant:"outline",size:"sm",disabled:p>=M,onClick:()=>h(l+c),children:"Next"})]})]})]})}),r(Fe,{isOpen:W.open,title:`Cache entry: ${W.key}`,onClose:()=>L({open:!1}),children:W.data?r("div",{className:"space-y-2",children:[r("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:["RCODE: ",W.data.rcode]}),r("pre",{className:"p-3 rounded-md bg-gray-50 text-gray-800 dark:bg-gray-900 dark:text-gray-200 whitespace-pre-wrap text-sm border border-gray-200 dark:border-gray-700 max-h-80 overflow-auto",children:(W.data.answers||[]).join(`
`)})]}):r("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Loading…"})}),r(Fe,{isOpen:R,title:"Confirm flush",onClose:()=>j(!1),primaryAction:{label:"Flush all",onClick:async()=>{var g,y;i(!0);try{await((g=t.cacheFlush)==null?void 0:g.call(t)),await((y=t.fetchCache)==null?void 0:y.call(t,{offset:0,limit:c,q:x,sort:E,order:P})),h(0)}finally{i(!1),j(!1)}},variant:"primary"},secondaryAction:{label:"Cancel",onClick:()=>j(!1)},children:r("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:"This will clear the entire cache. Continue?"})})]})}function pa(){const t=()=>{const l=window.location.hash.slice(1);return["overview","rules","upstreams","history","hosts","devices","resolve","cache","update"].includes(l)?l:"overview"},[e,s]=k(t()),[a,o]=k(!1),[n,i]=k(null),[u,m]=k([]);Ur(),H(()=>{var C;const l=new Yr("/ws");let h=null;l.connect().then(()=>{i(l),console.log("Provider connected")}).catch(x=>{console.error("Failed to connect provider:",x)});const c=()=>{const x=window.location.hash.slice(1);["overview","rules","upstreams","history","hosts","devices","resolve","cache","update"].includes(x)&&s(x)};c(),window.addEventListener("hashchange",c);const _=()=>{window.innerWidth<1024&&o(!0)};_(),window.addEventListener("resize",_);const w=(C=l.onStatus)==null?void 0:C.call(l,x=>{if(x.channel==="rest"){h&&clearTimeout(h),h=window.setTimeout(()=>{m(v=>[{id:`${Date.now()}`,message:"WebSocket unavailable — using polling",type:"warning",duration:2500},...v].slice(0,4)),h=null},1200);return}h&&(clearTimeout(h),h=null),m(v=>[{id:`${Date.now()}`,message:"Realtime updates via WebSocket",type:"success",duration:2500},...v].slice(0,4))});return()=>{window.removeEventListener("hashchange",c),window.removeEventListener("resize",_),h&&clearTimeout(h),w&&w(),l.close()}},[]);const d=l=>{window.location.hash.slice(1)!==l?window.location.hash=l:s(l),window.innerWidth<1024&&o(!0),window.scrollTo(0,0)},f=()=>{o(!a)};return n?r("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-700",children:[r(ta,{toasts:u,onRemove:l=>m(h=>h.filter(c=>c.id!==l))}),r(Ys,{activeTab:e,onTabChange:d,collapsed:a}),r("div",{className:`transition-all duration-300 ${a?"lg:ml-16":"lg:ml-64"}`,children:[r(ea,{onSidebarToggle:f,sidebarCollapsed:a,provider:n}),r("main",{className:"p-6",children:r("div",{className:"max-w-7xl mx-auto",children:[e==="overview"&&r(Zs,{provider:n}),e==="rules"&&r(ra,{provider:n}),e==="upstreams"&&r(ia,{provider:n}),e==="history"&&r(la,{provider:n}),e==="hosts"&&r(ca,{provider:n}),e==="devices"&&r(da,{provider:n}),e==="resolve"&&r(Qs,{provider:n}),e==="cache"&&r(fa,{provider:n}),e==="update"&&r(ha,{provider:n})]})})]}),!a&&r("div",{className:"fixed inset-0 z-30 bg-black/50 lg:hidden",onClick:f})]}):r("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:r("div",{className:"text-center",children:[r("div",{className:"w-16 h-16 bg-gray-200 dark:bg-gray-700 rounded-full animate-pulse mx-auto mb-4"}),r("p",{className:"text-gray-600 dark:text-gray-400",children:"Connecting to server..."})]})})}ce(r(pa,{}),document.getElementById("app"));
