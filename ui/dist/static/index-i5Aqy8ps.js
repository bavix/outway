var Ur=Object.defineProperty;var $r=(t,e,r)=>e in t?Ur(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var G=(t,e,r)=>$r(t,typeof e!="symbol"?e+"":e,r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(a){if(a.ep)return;a.ep=!0;const o=r(a);fetch(a.href,o)}})();var fe,R,St,te,tt,Ct,Et,Tt,De,Pe,Ae,Rt,me={},Ut=[],Lr=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,pe=Array.isArray;function Y(t,e){for(var r in e)t[r]=e[r];return t}function je(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function X(t,e,r){var n,a,o,i={};for(o in e)o=="key"?n=e[o]:o=="ref"?a=e[o]:i[o]=e[o];if(arguments.length>2&&(i.children=arguments.length>3?fe.call(arguments,2):r),typeof t=="function"&&t.defaultProps!=null)for(o in t.defaultProps)i[o]===void 0&&(i[o]=t.defaultProps[o]);return ue(t,i,n,a,null)}function ue(t,e,r,n,a){var o={type:t,props:e,key:r,ref:n,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:a??++St,__i:-1,__u:0};return a==null&&R.vnode!=null&&R.vnode(o),o}function $t(){return{current:null}}function Z(t){return t.children}function Q(t,e){this.props=t,this.context=e}function ne(t,e){if(e==null)return t.__?ne(t.__,t.__i+1):null;for(var r;e<t.__k.length;e++)if((r=t.__k[e])!=null&&r.__e!=null)return r.__e;return typeof t.type=="function"?ne(t):null}function Lt(t){var e,r;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((r=t.__k[e])!=null&&r.__e!=null){t.__e=t.__c.base=r.__e;break}return Lt(t)}}function Me(t){(!t.__d&&(t.__d=!0)&&te.push(t)&&!ke.__r++||tt!=R.debounceRendering)&&((tt=R.debounceRendering)||Ct)(ke)}function ke(){for(var t,e,r,n,a,o,i,d=1;te.length;)te.length>d&&te.sort(Et),t=te.shift(),d=te.length,t.__d&&(r=void 0,n=void 0,a=(n=(e=t).__v).__e,o=[],i=[],e.__P&&((r=Y({},n)).__v=n.__v+1,R.vnode&&R.vnode(r),He(e.__P,r,n,e.__n,e.__P.namespaceURI,32&n.__u?[a]:null,o,a??ne(n),!!(32&n.__u),i),r.__v=n.__v,r.__.__k[r.__i]=r,Mt(o,r,i),n.__e=n.__=null,r.__e!=a&&Lt(r)));ke.__r=0}function Pt(t,e,r,n,a,o,i,d,f,u,h){var l,m,c,_,b,k,y,S=n&&n.__k||Ut,O=e.length;for(f=Pr(r,e,S,f,O),l=0;l<O;l++)(c=r.__k[l])!=null&&(m=c.__i==-1?me:S[c.__i]||me,c.__i=l,k=He(t,c,m,a,o,i,d,f,u,h),_=c.__e,c.ref&&m.ref!=c.ref&&(m.ref&&Fe(m.ref,null,c),h.push(c.ref,c.__c||_,c)),b==null&&_!=null&&(b=_),(y=!!(4&c.__u))||m.__k===c.__k?f=At(c,f,t,y):typeof c.type=="function"&&k!==void 0?f=k:_&&(f=_.nextSibling),c.__u&=-7);return r.__e=b,f}function Pr(t,e,r,n,a){var o,i,d,f,u,h=r.length,l=h,m=0;for(t.__k=new Array(a),o=0;o<a;o++)(i=e[o])!=null&&typeof i!="boolean"&&typeof i!="function"?(f=o+m,(i=t.__k[o]=typeof i=="string"||typeof i=="number"||typeof i=="bigint"||i.constructor==String?ue(null,i,null,null,null):pe(i)?ue(Z,{children:i},null,null,null):i.constructor==null&&i.__b>0?ue(i.type,i.props,i.key,i.ref?i.ref:null,i.__v):i).__=t,i.__b=t.__b+1,d=null,(u=i.__i=Ar(i,r,f,l))!=-1&&(l--,(d=r[u])&&(d.__u|=2)),d==null||d.__v==null?(u==-1&&(a>h?m--:a<h&&m++),typeof i.type!="function"&&(i.__u|=4)):u!=f&&(u==f-1?m--:u==f+1?m++:(u>f?m--:m++,i.__u|=4))):t.__k[o]=null;if(l)for(o=0;o<h;o++)(d=r[o])!=null&&!(2&d.__u)&&(d.__e==n&&(n=ne(d)),Wt(d,d));return n}function At(t,e,r,n){var a,o;if(typeof t.type=="function"){for(a=t.__k,o=0;a&&o<a.length;o++)a[o]&&(a[o].__=t,e=At(a[o],e,r,n));return e}t.__e!=e&&(n&&(e&&t.type&&!e.parentNode&&(e=ne(t)),r.insertBefore(t.__e,e||null)),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function K(t,e){return e=e||[],t==null||typeof t=="boolean"||(pe(t)?t.some(function(r){K(r,e)}):e.push(t)),e}function Ar(t,e,r,n){var a,o,i,d=t.key,f=t.type,u=e[r],h=u!=null&&(2&u.__u)==0;if(u===null&&t.key==null||h&&d==u.key&&f==u.type)return r;if(n>(h?1:0)){for(a=r-1,o=r+1;a>=0||o<e.length;)if((u=e[i=a>=0?a--:o++])!=null&&!(2&u.__u)&&d==u.key&&f==u.type)return i}return-1}function rt(t,e,r){e[0]=="-"?t.setProperty(e,r??""):t[e]=r==null?"":typeof r!="number"||Lr.test(e)?r:r+"px"}function ye(t,e,r,n,a){var o,i;e:if(e=="style")if(typeof r=="string")t.style.cssText=r;else{if(typeof n=="string"&&(t.style.cssText=n=""),n)for(e in n)r&&e in r||rt(t.style,e,"");if(r)for(e in r)n&&r[e]==n[e]||rt(t.style,e,r[e])}else if(e[0]=="o"&&e[1]=="n")o=e!=(e=e.replace(Tt,"$1")),i=e.toLowerCase(),e=i in t||e=="onFocusOut"||e=="onFocusIn"?i.slice(2):e.slice(2),t.l||(t.l={}),t.l[e+o]=r,r?n?r.u=n.u:(r.u=De,t.addEventListener(e,o?Ae:Pe,o)):t.removeEventListener(e,o?Ae:Pe,o);else{if(a=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t)try{t[e]=r??"";break e}catch{}typeof r=="function"||(r==null||r===!1&&e[4]!="-"?t.removeAttribute(e):t.setAttribute(e,e=="popover"&&r==1?"":r))}}function st(t){return function(e){if(this.l){var r=this.l[e.type+t];if(e.t==null)e.t=De++;else if(e.t<r.u)return;return r(R.event?R.event(e):e)}}}function He(t,e,r,n,a,o,i,d,f,u){var h,l,m,c,_,b,k,y,S,O,N,A,W,j,E,U,I,P=e.type;if(e.constructor!=null)return null;128&r.__u&&(f=!!(32&r.__u),o=[d=e.__e=r.__e]),(h=R.__b)&&h(e);e:if(typeof P=="function")try{if(y=e.props,S="prototype"in P&&P.prototype.render,O=(h=P.contextType)&&n[h.__c],N=h?O?O.props.value:h.__:n,r.__c?k=(l=e.__c=r.__c).__=l.__E:(S?e.__c=l=new P(y,N):(e.__c=l=new Q(y,N),l.constructor=P,l.render=Or),O&&O.sub(l),l.props=y,l.state||(l.state={}),l.context=N,l.__n=n,m=l.__d=!0,l.__h=[],l._sb=[]),S&&l.__s==null&&(l.__s=l.state),S&&P.getDerivedStateFromProps!=null&&(l.__s==l.state&&(l.__s=Y({},l.__s)),Y(l.__s,P.getDerivedStateFromProps(y,l.__s))),c=l.props,_=l.state,l.__v=e,m)S&&P.getDerivedStateFromProps==null&&l.componentWillMount!=null&&l.componentWillMount(),S&&l.componentDidMount!=null&&l.__h.push(l.componentDidMount);else{if(S&&P.getDerivedStateFromProps==null&&y!==c&&l.componentWillReceiveProps!=null&&l.componentWillReceiveProps(y,N),!l.__e&&l.shouldComponentUpdate!=null&&l.shouldComponentUpdate(y,l.__s,N)===!1||e.__v==r.__v){for(e.__v!=r.__v&&(l.props=y,l.state=l.__s,l.__d=!1),e.__e=r.__e,e.__k=r.__k,e.__k.some(function(p){p&&(p.__=e)}),A=0;A<l._sb.length;A++)l.__h.push(l._sb[A]);l._sb=[],l.__h.length&&i.push(l);break e}l.componentWillUpdate!=null&&l.componentWillUpdate(y,l.__s,N),S&&l.componentDidUpdate!=null&&l.__h.push(function(){l.componentDidUpdate(c,_,b)})}if(l.context=N,l.props=y,l.__P=t,l.__e=!1,W=R.__r,j=0,S){for(l.state=l.__s,l.__d=!1,W&&W(e),h=l.render(l.props,l.state,l.context),E=0;E<l._sb.length;E++)l.__h.push(l._sb[E]);l._sb=[]}else do l.__d=!1,W&&W(e),h=l.render(l.props,l.state,l.context),l.state=l.__s;while(l.__d&&++j<25);l.state=l.__s,l.getChildContext!=null&&(n=Y(Y({},n),l.getChildContext())),S&&!m&&l.getSnapshotBeforeUpdate!=null&&(b=l.getSnapshotBeforeUpdate(c,_)),U=h,h!=null&&h.type===Z&&h.key==null&&(U=Ot(h.props.children)),d=Pt(t,pe(U)?U:[U],e,r,n,a,o,i,d,f,u),l.base=e.__e,e.__u&=-161,l.__h.length&&i.push(l),k&&(l.__E=l.__=null)}catch(p){if(e.__v=null,f||o!=null)if(p.then){for(e.__u|=f?160:128;d&&d.nodeType==8&&d.nextSibling;)d=d.nextSibling;o[o.indexOf(d)]=null,e.__e=d}else{for(I=o.length;I--;)je(o[I]);Oe(e)}else e.__e=r.__e,e.__k=r.__k,p.then||Oe(e);R.__e(p,e,r)}else o==null&&e.__v==r.__v?(e.__k=r.__k,e.__e=r.__e):d=e.__e=Mr(r.__e,e,r,n,a,o,i,f,u);return(h=R.diffed)&&h(e),128&e.__u?void 0:d}function Oe(t){t&&t.__c&&(t.__c.__e=!0),t&&t.__k&&t.__k.forEach(Oe)}function Mt(t,e,r){for(var n=0;n<r.length;n++)Fe(r[n],r[++n],r[++n]);R.__c&&R.__c(e,t),t.some(function(a){try{t=a.__h,a.__h=[],t.some(function(o){o.call(a)})}catch(o){R.__e(o,a.__v)}})}function Ot(t){return typeof t!="object"||t==null||t.__b&&t.__b>0?t:pe(t)?t.map(Ot):Y({},t)}function Mr(t,e,r,n,a,o,i,d,f){var u,h,l,m,c,_,b,k=r.props,y=e.props,S=e.type;if(S=="svg"?a="http://www.w3.org/2000/svg":S=="math"?a="http://www.w3.org/1998/Math/MathML":a||(a="http://www.w3.org/1999/xhtml"),o!=null){for(u=0;u<o.length;u++)if((c=o[u])&&"setAttribute"in c==!!S&&(S?c.localName==S:c.nodeType==3)){t=c,o[u]=null;break}}if(t==null){if(S==null)return document.createTextNode(y);t=document.createElementNS(a,S,y.is&&y),d&&(R.__m&&R.__m(e,o),d=!1),o=null}if(S==null)k===y||d&&t.data==y||(t.data=y);else{if(o=o&&fe.call(t.childNodes),k=r.props||me,!d&&o!=null)for(k={},u=0;u<t.attributes.length;u++)k[(c=t.attributes[u]).name]=c.value;for(u in k)if(c=k[u],u!="children"){if(u=="dangerouslySetInnerHTML")l=c;else if(!(u in y)){if(u=="value"&&"defaultValue"in y||u=="checked"&&"defaultChecked"in y)continue;ye(t,u,null,c,a)}}for(u in y)c=y[u],u=="children"?m=c:u=="dangerouslySetInnerHTML"?h=c:u=="value"?_=c:u=="checked"?b=c:d&&typeof c!="function"||k[u]===c||ye(t,u,c,k[u],a);if(h)d||l&&(h.__html==l.__html||h.__html==t.innerHTML)||(t.innerHTML=h.__html),e.__k=[];else if(l&&(t.innerHTML=""),Pt(e.type=="template"?t.content:t,pe(m)?m:[m],e,r,n,S=="foreignObject"?"http://www.w3.org/1999/xhtml":a,o,i,o?o[0]:r.__k&&ne(r,0),d,f),o!=null)for(u=o.length;u--;)je(o[u]);d||(u="value",S=="progress"&&_==null?t.removeAttribute("value"):_!=null&&(_!==t[u]||S=="progress"&&!_||S=="option"&&_!=k[u])&&ye(t,u,_,k[u],a),u="checked",b!=null&&b!=t[u]&&ye(t,u,b,k[u],a))}return t}function Fe(t,e,r){try{if(typeof t=="function"){var n=typeof t.__u=="function";n&&t.__u(),n&&e==null||(t.__u=t(e))}else t.current=e}catch(a){R.__e(a,r)}}function Wt(t,e,r){var n,a;if(R.unmount&&R.unmount(t),(n=t.ref)&&(n.current&&n.current!=t.__e||Fe(n,null,e)),(n=t.__c)!=null){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(o){R.__e(o,e)}n.base=n.__P=null}if(n=t.__k)for(a=0;a<n.length;a++)n[a]&&Wt(n[a],e,r||typeof t.type!="function");r||je(t.__e),t.__c=t.__=t.__e=void 0}function Or(t,e,r){return this.constructor(t,r)}function ae(t,e,r){var n,a,o,i;e==document&&(e=document.documentElement),R.__&&R.__(t,e),a=(n=typeof r=="function")?null:r&&r.__k||e.__k,o=[],i=[],He(e,t=(!n&&r||e).__k=X(Z,null,[t]),a||me,me,e.namespaceURI,!n&&r?[r]:a?null:e.firstChild?fe.call(e.childNodes):null,o,!n&&r?r:a?a.__e:e.firstChild,n,i),Mt(o,t,i)}function It(t,e){ae(t,e,It)}function Wr(t,e,r){var n,a,o,i,d=Y({},t.props);for(o in t.type&&t.type.defaultProps&&(i=t.type.defaultProps),e)o=="key"?n=e[o]:o=="ref"?a=e[o]:d[o]=e[o]===void 0&&i!=null?i[o]:e[o];return arguments.length>2&&(d.children=arguments.length>3?fe.call(arguments,2):r),ue(t.type,d,n||t.key,a||t.ref,null)}function Dt(t){function e(r){var n,a;return this.getChildContext||(n=new Set,(a={})[e.__c]=this,this.getChildContext=function(){return a},this.componentWillUnmount=function(){n=null},this.shouldComponentUpdate=function(o){this.props.value!=o.value&&n.forEach(function(i){i.__e=!0,Me(i)})},this.sub=function(o){n.add(o);var i=o.componentWillUnmount;o.componentWillUnmount=function(){n&&n.delete(o),i&&i.call(o)}}),r.children}return e.__c="__cC"+Rt++,e.__=t,e.Provider=e.__l=(e.Consumer=function(r,n){return r.children(n)}).contextType=e,e}fe=Ut.slice,R={__e:function(t,e,r,n){for(var a,o,i;e=e.__;)if((a=e.__c)&&!a.__)try{if((o=a.constructor)&&o.getDerivedStateFromError!=null&&(a.setState(o.getDerivedStateFromError(t)),i=a.__d),a.componentDidCatch!=null&&(a.componentDidCatch(t,n||{}),i=a.__d),i)return a.__E=a}catch(d){t=d}throw t}},St=0,Q.prototype.setState=function(t,e){var r;r=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=Y({},this.state),typeof t=="function"&&(t=t(Y({},r),this.props)),t&&Y(r,t),t!=null&&this.__v&&(e&&this._sb.push(e),Me(this))},Q.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),Me(this))},Q.prototype.render=Z,te=[],Ct=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Et=function(t,e){return t.__v.__b-e.__v.__b},ke.__r=0,Tt=/(PointerCapture)$|Capture$/i,De=0,Pe=st(!1),Ae=st(!0),Rt=0;var Ir=0;function s(t,e,r,n,a,o){e||(e={});var i,d,f=e;if("ref"in f)for(d in f={},e)d=="ref"?i=e[d]:f[d]=e[d];var u={type:t,props:f,key:r,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--Ir,__i:-1,__u:0,__source:a,__self:o};if(typeof t=="function"&&(i=t.defaultProps))for(d in i)f[d]===void 0&&(f[d]=i[d]);return R.vnode&&R.vnode(u),u}var ee,D,Re,nt,oe=0,jt=[],H=R,at=H.__b,ot=H.__r,it=H.diffed,lt=H.__c,ct=H.unmount,dt=H.__;function re(t,e){H.__h&&H.__h(D,t,oe||e),oe=0;var r=D.__H||(D.__H={__:[],__h:[]});return t>=r.__.length&&r.__.push({}),r.__[t]}function C(t){return oe=1,Se(Ht,t)}function Se(t,e,r){var n=re(ee++,2);if(n.t=t,!n.__c&&(n.__=[r?r(e):Ht(void 0,e),function(d){var f=n.__N?n.__N[0]:n.__[0],u=n.t(f,d);f!==u&&(n.__N=[u,n.__[1]],n.__c.setState({}))}],n.__c=D,!D.__f)){var a=function(d,f,u){if(!n.__c.__H)return!0;var h=n.__c.__H.__.filter(function(m){return!!m.__c});if(h.every(function(m){return!m.__N}))return!o||o.call(this,d,f,u);var l=n.__c.props!==d;return h.forEach(function(m){if(m.__N){var c=m.__[0];m.__=m.__N,m.__N=void 0,c!==m.__[0]&&(l=!0)}}),o&&o.call(this,d,f,u)||l};D.__f=!0;var o=D.shouldComponentUpdate,i=D.componentWillUpdate;D.componentWillUpdate=function(d,f,u){if(this.__e){var h=o;o=void 0,a(d,f,u),o=h}i&&i.call(this,d,f,u)},D.shouldComponentUpdate=a}return n.__N||n.__}function V(t,e){var r=re(ee++,3);!H.__s&&Je(r.__H,e)&&(r.__=t,r.u=e,D.__H.__h.push(r))}function le(t,e){var r=re(ee++,4);!H.__s&&Je(r.__H,e)&&(r.__=t,r.u=e,D.__h.push(r))}function Ce(t){return oe=5,ce(function(){return{current:t}},[])}function ze(t,e,r){oe=6,le(function(){if(typeof t=="function"){var n=t(e());return function(){t(null),n&&typeof n=="function"&&n()}}if(t)return t.current=e(),function(){return t.current=null}},r==null?r:r.concat(t))}function ce(t,e){var r=re(ee++,7);return Je(r.__H,e)&&(r.__=t(),r.__H=e,r.__h=t),r.__}function Ge(t,e){return oe=8,ce(function(){return t},e)}function Ve(t){var e=D.context[t.__c],r=re(ee++,9);return r.c=t,e?(r.__==null&&(r.__=!0,e.sub(D)),e.props.value):t.__}function Be(t,e){H.useDebugValue&&H.useDebugValue(e?e(t):t)}function Dr(t){var e=re(ee++,10),r=C();return e.__=t,D.componentDidCatch||(D.componentDidCatch=function(n,a){e.__&&e.__(n,a),r[1](n)}),[r[0],function(){r[1](void 0)}]}function qe(){var t=re(ee++,11);if(!t.__){for(var e=D.__v;e!==null&&!e.__m&&e.__!==null;)e=e.__;var r=e.__m||(e.__m=[0,0]);t.__="P"+r[0]+"-"+r[1]++}return t.__}function jr(){for(var t;t=jt.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(xe),t.__H.__h.forEach(We),t.__H.__h=[]}catch(e){t.__H.__h=[],H.__e(e,t.__v)}}H.__b=function(t){D=null,at&&at(t)},H.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),dt&&dt(t,e)},H.__r=function(t){ot&&ot(t),ee=0;var e=(D=t.__c).__H;e&&(Re===D?(e.__h=[],D.__h=[],e.__.forEach(function(r){r.__N&&(r.__=r.__N),r.u=r.__N=void 0})):(e.__h.forEach(xe),e.__h.forEach(We),e.__h=[],ee=0)),Re=D},H.diffed=function(t){it&&it(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(jt.push(e)!==1&&nt===H.requestAnimationFrame||((nt=H.requestAnimationFrame)||Hr)(jr)),e.__H.__.forEach(function(r){r.u&&(r.__H=r.u),r.u=void 0})),Re=D=null},H.__c=function(t,e){e.some(function(r){try{r.__h.forEach(xe),r.__h=r.__h.filter(function(n){return!n.__||We(n)})}catch(n){e.some(function(a){a.__h&&(a.__h=[])}),e=[],H.__e(n,r.__v)}}),lt&&lt(t,e)},H.unmount=function(t){ct&&ct(t);var e,r=t.__c;r&&r.__H&&(r.__H.__.forEach(function(n){try{xe(n)}catch(a){e=a}}),r.__H=void 0,e&&H.__e(e,r.__v))};var ut=typeof requestAnimationFrame=="function";function Hr(t){var e,r=function(){clearTimeout(n),ut&&cancelAnimationFrame(e),setTimeout(t)},n=setTimeout(r,35);ut&&(e=requestAnimationFrame(r))}function xe(t){var e=D,r=t.__c;typeof r=="function"&&(t.__c=void 0,r()),D=e}function We(t){var e=D;t.__c=t.__(),D=e}function Je(t,e){return!t||t.length!==e.length||e.some(function(r,n){return r!==t[n]})}function Ht(t,e){return typeof e=="function"?e(t):e}class Fr{constructor(e){G(this,"ws",null);G(this,"reconnectTimeout",null);G(this,"reconnectAttempts",0);G(this,"maxReconnectAttempts",10);G(this,"baseDelay",500);G(this,"maxDelay",1e4);G(this,"callbacks",new Map);G(this,"lastSnapshot",{});this.url=e}async connect(){return new Promise((e,r)=>{try{const n=this.url.replace(/^http/,"ws");this.ws=new WebSocket(n),this.ws.onopen=()=>{console.log("WebSocket connected"),this.reconnectAttempts=0,this.clearReconnectTimeout(),e()},this.ws.onmessage=a=>{try{const o=JSON.parse(a.data);this.handleMessage(o)}catch(o){console.warn("Invalid WebSocket message:",o)}},this.ws.onclose=()=>{console.log("WebSocket disconnected"),this.scheduleReconnect()},this.ws.onerror=a=>{console.error("WebSocket error:",a),r(a)},this.ws.addEventListener("ping",()=>{var a;((a=this.ws)==null?void 0:a.readyState)===WebSocket.OPEN&&this.ws.send("pong")})}catch(n){r(n)}})}close(){this.clearReconnectTimeout(),this.ws&&(this.ws.close(),this.ws=null)}handleMessage(e){let r=e.data;if(e.type==="upstreams"&&Array.isArray(r)){const a=this.lastSnapshot.upstreams||[];r=r.map((o,i)=>{var m;const d=(o.name||o.Name||"").toString(),f=o.weight??o.Weight,u=(o.type||o.Type||"").toString().toLowerCase(),h=(o.address||o.Address||"").toString();let l=h;if(/^(https?|udp|tcp|tls|dot|quic|doq):\/\//i.test(h)||(u&&u!=="doh"?l=`${u}://${h}`:l=`udp://${h}`),!l||l==="udp://"){const c=a.find(_=>_.name===d);l=(c==null?void 0:c.address)||((m=a[i])==null?void 0:m.address)||l}return{name:d,address:l,weight:f}})}if(e.type==="history"){const a=Array.isArray(r)?r:r&&Array.isArray(r.events)?r.events:[];r=a;try{console.debug("[WS] history",Array.isArray(a)?a.length:0)}catch{}}if(e.type==="overview"&&r)try{window.__ov=r}catch{}this.lastSnapshot[e.type]=r;const n=this.callbacks.get(e.type);n&&n.forEach(a=>{try{a(r)}catch(o){console.error("Callback error:",o)}})}scheduleReconnect(){if(this.reconnectAttempts>=this.maxReconnectAttempts){console.error("Max reconnection attempts reached");return}this.clearReconnectTimeout();const e=Math.min(this.baseDelay*Math.pow(1.8,this.reconnectAttempts),this.maxDelay),r=e*.25,n=e+(Math.random()-.5)*r;this.reconnectTimeout=window.setTimeout(()=>{this.reconnectAttempts++,console.log(`Attempting to reconnect (${this.reconnectAttempts}/${this.maxReconnectAttempts})`),this.connect().catch(console.error)},n)}clearReconnectTimeout(){this.reconnectTimeout&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null)}onRuleGroups(e){return this.subscribe("rule_groups",e)}onUpstreams(e){return this.subscribe("upstreams",e)}onStats(e){return this.subscribe("stats",e)}onHistory(e){return this.subscribe("history",e)}onHosts(e){return this.subscribe("hosts",e)}onOverview(e){return this.subscribe("overview",e)}onUpdateAvailable(e){return this.subscribe("update_available",e)}subscribe(e,r){if(this.callbacks.has(e)||this.callbacks.set(e,new Set),this.callbacks.get(e).add(r),this.lastSnapshot[e])try{r(this.lastSnapshot[e])}catch(n){console.error("Snapshot callback error:",n)}return()=>{const n=this.callbacks.get(e);n&&(n.delete(r),n.size===0&&this.callbacks.delete(e))}}async fetchRuleGroups(){throw new Error("Use REST provider for fetch operations")}async createRuleGroup(e){throw new Error("Use REST provider for mutation operations")}async updateRuleGroup(e,r){throw new Error("Use REST provider for mutation operations")}async deleteRuleGroup(e){throw new Error("Use REST provider for mutation operations")}async fetchUpstreams(){throw new Error("Use REST provider for fetch operations")}async saveUpstreams(e){throw new Error("Use REST provider for mutation operations")}async fetchStats(){throw new Error("Use REST provider for fetch operations")}async fetchHistory(){throw new Error("Use REST provider for fetch operations")}async fetchServerInfo(){throw new Error("Use REST provider for fetch operations")}async fetchConfig(){throw new Error("Use REST provider for fetch operations")}async updateConfig(e){throw new Error("Use REST provider for mutation operations")}async fetchHosts(){throw new Error("Use REST provider for fetch operations")}async saveHosts(e){throw new Error("Use REST provider for mutation operations")}async testResolve(e,r){throw new Error("Use REST provider for fetch operations")}}class zr{constructor(e=""){G(this,"pollingTimers",new Map);G(this,"callbacks",new Map);G(this,"pollingConfig",{stats:3e4,history:6e4,rule_groups:3e5,upstreams:3e5,hosts:3e5});this.baseUrl=e}async connect(){this.startPolling("stats",()=>this.fetchStats()),this.startPolling("history",()=>this.fetchHistory()),this.startPolling("rule_groups",()=>this.fetchRuleGroups()),this.startPolling("upstreams",()=>this.fetchUpstreams()),this.startPolling("hosts",()=>this.fetchHosts())}close(){this.pollingTimers.forEach(e=>clearInterval(e)),this.pollingTimers.clear(),this.callbacks.clear()}async fetchJSON(e,r={}){const n=await fetch(`${this.baseUrl}${e}`,{headers:{"Content-Type":"application/json",...r.headers},...r});if(!n.ok)throw new Error(`HTTP ${n.status}: ${await n.text()}`);const a=n.headers.get("content-type");return a!=null&&a.includes("application/json")?n.json():n.text()}startPolling(e,r){const n=this.pollingConfig[e];r().then(o=>{this.notifyCallbacks(e,o)}).catch(console.error);const a=window.setInterval(()=>{r().then(o=>{this.notifyCallbacks(e,o)}).catch(console.error)},n);this.pollingTimers.set(e,a)}notifyCallbacks(e,r){const n=this.callbacks.get(e);n&&n.forEach(a=>{try{a(r)}catch(o){console.error("Polling callback error:",o)}})}onRuleGroups(e){return this.subscribe("rule_groups",e)}onUpstreams(e){return this.subscribe("upstreams",e)}onStats(e){return this.subscribe("stats",e)}onHistory(e){return this.subscribe("history",e)}onHosts(e){return this.subscribe("hosts",e)}onUpdateAvailable(e){return()=>{}}subscribe(e,r){return this.callbacks.has(e)||this.callbacks.set(e,new Set),this.callbacks.get(e).add(r),()=>{const n=this.callbacks.get(e);n&&(n.delete(r),n.size===0&&this.callbacks.delete(e))}}async fetchRuleGroups(){return(await this.fetchJSON("/api/v1/rule-groups")).rule_groups}async createRuleGroup(e){await this.fetchJSON("/api/v1/rule-groups",{method:"POST",body:JSON.stringify(e)})}async updateRuleGroup(e,r){await this.fetchJSON(`/api/v1/rule-groups/${encodeURIComponent(e)}`,{method:"PUT",body:JSON.stringify(r)})}async deleteRuleGroup(e){await this.fetchJSON(`/api/v1/rule-groups/${encodeURIComponent(e)}`,{method:"DELETE"})}async fetchUpstreams(){return(await this.fetchJSON("/api/v1/upstreams")).upstreams.map(r=>{var f,u;const n=r.name||r.Name||"",a=r.weight??r.Weight,o=(f=r.type)==null?void 0:f.toString().toLowerCase(),i=((u=r.address)==null?void 0:u.toString())||"";let d=i;return/^(https?|udp|tcp|tls|dot|quic|doq):\/\//i.test(i)?d=i:o&&o!=="doh"&&(d=`${o}://${i.replace(/^(udp|tcp|tls|dot|quic|doq):\/\//i,"")}`),{name:n,address:d,weight:a}})}async saveUpstreams(e){const r=e.map(n=>{const a=String(n.address||"").trim();let o=(n.name||"").trim();const i=typeof n.weight=="number"?n.weight:void 0;try{const u=new URL(a),h=u.protocol.replace(":","").toLowerCase();let l=a;return h!=="https"&&(l=`${h==="tls"?"dot":h==="quic"?"doq":h}://${u.host}`),o||(o=u.hostname),{name:o,address:l,...i!==void 0?{weight:i}:{}}}catch{}const d=a.replace(/^(udp|tcp|tls|dot|quic|doq):\/\//i,"");o||(o=d.split(":")[0]||d);const f=`udp://${d}`;return{name:o,address:f,...i!==void 0?{weight:i}:{}}});await this.fetchJSON("/api/v1/upstreams",{method:"POST",body:JSON.stringify({upstreams:r})})}async fetchStats(){return this.fetchJSON("/api/v1/stats")}async fetchHistory(){return(await this.fetchJSON("/api/v1/history")).events}async fetchHosts(){return(await this.fetchJSON("/api/v1/hosts")).hosts}async saveHosts(e){await this.fetchJSON("/api/v1/hosts",{method:"PUT",body:JSON.stringify({hosts:e})})}async fetchServerInfo(){return this.fetchJSON("/api/v1/info")}async testResolve(e,r){const n=new URLSearchParams({name:e,type:r});return this.fetchJSON(`/api/v1/resolve?${n.toString()}`)}onOverview(e){return this.subscribe("overview",e)}async fetchOverview(){return this.fetchJSON("/api/v1/overview")}}class Gr{constructor(e="/ws",r=""){G(this,"wsProvider");G(this,"restProvider");G(this,"isWSConnected",!1);G(this,"listeners",new Map);G(this,"wsUnsubs",new Map);G(this,"restUnsubs",new Map);G(this,"statusListeners",new Set);this.wsProvider=new Fr(e),this.restProvider=new zr(r)}async connect(){try{await this.wsProvider.connect(),this.isWSConnected=!0,console.log("Using WebSocket provider")}catch(e){console.warn("WebSocket connection failed, falling back to REST:",e),this.isWSConnected=!1}try{await this.restProvider.connect(),console.log("REST provider ready")}catch(e){throw console.error("REST provider failed:",e),e}this.resubscribeAll(),this.monitorWSConnection(),this.emitStatus()}close(){this.wsProvider.close(),this.restProvider.close(),this.wsUnsubs.forEach(e=>e()),this.restUnsubs.forEach(e=>e()),this.wsUnsubs.clear(),this.restUnsubs.clear(),this.listeners.clear(),this.statusListeners.clear()}monitorWSConnection(){const e=setInterval(()=>{var a;const r=this.isWSConnected;if(!(((a=this.wsProvider.ws)==null?void 0:a.readyState)===WebSocket.OPEN)){setTimeout(()=>{var d;const o=((d=this.wsProvider.ws)==null?void 0:d.readyState)!==WebSocket.OPEN,i=this.isWSConnected;this.isWSConnected=!o,i!==this.isWSConnected&&(this.resubscribeAll(),console.log(this.isWSConnected?"WebSocket active":"Using REST fallback"),this.emitStatus())},1500);return}this.isWSConnected=!0,r!==!0&&(this.resubscribeAll(),console.log(this.isWSConnected?"WebSocket active":"Using REST fallback"),this.emitStatus())},1e4);this.wsUnsubs.set("_monitor",()=>clearInterval(e))}addListener(e,r){return this.listeners.has(e)||this.listeners.set(e,new Set),this.listeners.get(e).add(r),this.resubscribe(e),()=>{const n=this.listeners.get(e);n&&(n.delete(r),n.size===0&&this.listeners.delete(e));const a=this.wsUnsubs.get(e);a&&a();const o=this.restUnsubs.get(e);o&&o(),this.wsUnsubs.delete(e),this.restUnsubs.delete(e)}}resubscribe(e){const r=this.wsUnsubs.get(e);r&&r();const n=this.restUnsubs.get(e);n&&n(),this.wsUnsubs.delete(e),this.restUnsubs.delete(e);const a=this.listeners.get(e);if(!a||a.size===0)return;const o=i=>a.forEach(d=>{try{d(i)}catch{}});if(this.isWSConnected)switch(e){case"rule_groups":this.wsUnsubs.set(e,this.wsProvider.onRuleGroups(o));break;case"upstreams":this.wsUnsubs.set(e,this.wsProvider.onUpstreams(o));break;case"stats":this.wsUnsubs.set(e,this.wsProvider.onStats(o));break;case"history":this.wsUnsubs.set(e,this.wsProvider.onHistory(o));break;case"hosts":this.wsUnsubs.set(e,this.wsProvider.onHosts(o));break;case"overview":this.wsUnsubs.set(e,this.wsProvider.onOverview(o));break;case"update_available":this.wsUnsubs.set(e,this.wsProvider.onUpdateAvailable(o));break}else switch(e){case"rule_groups":this.restUnsubs.set(e,this.restProvider.onRuleGroups(o));break;case"upstreams":this.restUnsubs.set(e,this.restProvider.onUpstreams(o));break;case"stats":this.restUnsubs.set(e,this.restProvider.onStats(o));break;case"history":this.restUnsubs.set(e,this.restProvider.onHistory(o));break;case"hosts":this.restUnsubs.set(e,this.restProvider.onHosts(o));break;case"overview":this.restUnsubs.set(e,this.restProvider.onOverview(o));break;case"update_available":this.restUnsubs.set(e,this.restProvider.onUpdateAvailable(o));break}}resubscribeAll(){Array.from(this.listeners.keys()).forEach(e=>this.resubscribe(e))}emitStatus(){const e={channel:this.isWSConnected?"ws":"rest",connected:!0};this.statusListeners.forEach(r=>{try{r(e)}catch{}})}onStatus(e){return this.statusListeners.add(e),e({channel:this.isWSConnected?"ws":"rest",connected:!0}),()=>{this.statusListeners.delete(e)}}async reconnect(){try{await this.wsProvider.connect(),this.isWSConnected=!0,this.resubscribeAll(),this.emitStatus()}catch{}}onRuleGroups(e){return this.addListener("rule_groups",e)}onUpstreams(e){return this.addListener("upstreams",e)}onStats(e){return this.addListener("stats",e)}onHistory(e){return this.addListener("history",e)}onHosts(e){return this.addListener("hosts",e)}onOverview(e){return this.addListener("overview",e)}onUpdateAvailable(e){return this.addListener("update_available",e)}async fetchRuleGroups(){try{return await this.restProvider.fetchRuleGroups()}catch(e){throw console.error("Failed to fetch rule groups:",e),e}}async createRuleGroup(e){try{await this.restProvider.createRuleGroup(e)}catch(r){throw console.error("Failed to create rule group:",r),r}}async updateRuleGroup(e,r){try{await this.restProvider.updateRuleGroup(e,r)}catch(n){throw console.error("Failed to update rule group:",n),n}}async deleteRuleGroup(e){try{await this.restProvider.deleteRuleGroup(e)}catch(r){throw console.error("Failed to delete rule group:",r),r}}async fetchUpstreams(){var e;try{return this.isWSConnected&&this.wsProvider&&((e=this.wsProvider.lastSnapshot)!=null&&e.upstreams)?this.wsProvider.lastSnapshot.upstreams:await this.restProvider.fetchUpstreams()}catch(r){throw console.error("Failed to fetch upstreams:",r),r}}async saveUpstreams(e){try{await this.restProvider.saveUpstreams(e)}catch(r){throw console.error("Failed to save upstreams:",r),r}}async fetchStats(){try{return await this.restProvider.fetchStats()}catch(e){throw console.error("Failed to fetch stats:",e),e}}async fetchHistory(){try{return await this.restProvider.fetchHistory()}catch(e){throw console.error("Failed to fetch history:",e),e}}async fetchHosts(){try{return await this.restProvider.fetchHosts()}catch(e){throw console.error("Failed to fetch hosts:",e),e}}async saveHosts(e){try{await this.restProvider.saveHosts(e)}catch(r){throw console.error("Failed to save hosts:",r),r}}async fetchServerInfo(){try{return await this.restProvider.fetchServerInfo()}catch(e){throw console.error("Failed to fetch server info:",e),e}}async fetchOverview(){try{return await this.restProvider.fetchOverview()}catch(e){throw console.error("Failed to fetch overview:",e),e}}async testResolve(e,r){try{return await this.restProvider.testResolve(e,r)}catch(n){throw console.error("Failed to run resolve test:",n),n}}}function B({children:t,className:e="",title:r,subtitle:n,...a}){const o=`card bg-white/80 dark:bg-gray-800/70 backdrop-blur-sm rounded-xl p-6 border border-gray-200/50 dark:border-gray-700/50 shadow-lg hover:shadow-xl transition-all duration-300 ${e}`.trim();return s("div",{className:o,...a,children:[(r||n)&&s("div",{className:"card-header pb-4 mb-6 border-b border-gray-200 dark:border-gray-700",children:[r&&s("h3",{className:"card-title text-xl font-semibold text-gray-900 dark:text-gray-100 leading-tight",children:r}),n&&s("p",{className:"card-subtitle text-sm text-gray-600 dark:text-gray-400 mt-2 leading-relaxed",children:n})]}),s("div",{className:"card-content text-gray-700 dark:text-gray-300 leading-relaxed",children:t})]})}function ve({title:t,value:e,change:r,icon:n,color:a="blue",className:o=""}){const i={blue:"text-blue-600 dark:text-blue-400",green:"text-green-600 dark:text-green-400",red:"text-red-600 dark:text-red-400",yellow:"text-yellow-600 dark:text-yellow-400",purple:"text-purple-600 dark:text-purple-400",indigo:"text-indigo-600 dark:text-indigo-400"},d=`stats-card bg-white rounded-md p-6 shadow-sm dark:bg-black dark:shadow-none ${o}`.trim();return s("div",{className:d,children:s("div",{className:"flex items-center justify-between",children:[s("div",{children:[s("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t}),s("p",{className:"text-2xl font-bold text-black dark:text-white mt-1",children:e}),r&&s("p",{className:`text-xs font-medium mt-2 ${r.type==="increase"?"text-green-600":"text-red-600"}`,children:[r.type==="increase"?"↗":"↘"," ",Math.abs(r.value),"%"]})]}),n&&s("div",{className:`flex-shrink-0 w-6 h-6 flex items-center justify-center rounded-full ${i[a]}`,children:n})]})})}function M({variant:t="primary",size:e="md",children:r,disabled:n=!1,loading:a=!1,fullWidth:o=!1,className:i="",...d}){const f="btn inline-flex items-center justify-center font-medium rounded-md disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 ease-out",u={primary:"btn-primary bg-blue-600 text-white hover:bg-blue-700 shadow-lg hover:shadow-xl shadow-blue-600/25 hover:shadow-blue-600/40 dark:bg-blue-600 dark:text-white dark:hover:bg-blue-700",secondary:"btn-secondary bg-gray-100 text-gray-900 hover:bg-gray-200 shadow-md hover:shadow-lg dark:bg-gray-700 dark:text-gray-100 dark:hover:bg-gray-600",outline:"btn-outline bg-white/80 dark:bg-gray-800/80 text-gray-900 dark:text-gray-100 border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700 backdrop-blur-sm",danger:"btn-danger bg-red-600 text-white hover:bg-red-700 shadow-lg hover:shadow-xl shadow-red-600/25 hover:shadow-red-600/40 dark:bg-red-600 dark:text-white dark:hover:bg-red-700"},h={sm:"btn-sm px-3 py-2 text-sm rounded-lg",md:"btn-md px-4 py-2.5 text-sm rounded-lg",lg:"btn-lg px-6 py-3 text-base rounded-lg"},l=o?"w-full":"",m=a?"btn-loading":"",c=`${f} ${u[t]} ${h[e]} ${l} ${m} ${i}`.trim();return s("button",{className:c,disabled:n||a,...d,children:[a&&s("svg",{className:"btn-spinner animate-spin -ml-1 mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),r]})}function ht({title:t,data:e,type:r="line",height:n=300,loading:a=!1,error:o,className:i="",xLabel:d,yLabel:f}){const u=Ce(null);V(()=>{if(!u.current||!e)return;const c=u.current,_=c.getContext("2d");if(!_)return;const b=56,k=c.width-b*2,y=c.height-b*2;_.clearRect(0,0,c.width,c.height),r==="line"?h(_,e,b,k,y,d,f):r==="bar"?l(_,e,b,k,y,d,f):r==="doughnut"&&m(_,e,c.width/2,c.height/2,Math.min(c.width,c.height)/3)},[e,r]);const h=(c,_,b,k,y,S,O)=>{var P;const N=_.datasets[0];if(!N)return;const A=Math.max(...N.data),W=Math.min(...N.data),j=A-W||1;c.strokeStyle="#e5e7eb",c.lineWidth=1;for(let p=0;p<=5;p++){const x=b+y/5*p;c.beginPath(),c.moveTo(b,x),c.lineTo(b+k,x),c.stroke()}c.fillStyle="#6b7280",c.font="12px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial",c.textAlign="right";for(let p=0;p<=5;p++){const x=b+y/5*p,g=A-j/5*p,L=Number.isFinite(g)?g>=100?g.toFixed(0):g.toFixed(1):"0";c.fillText(L,b-8,x+4)}O&&(c.save(),c.translate(16,b+y/2),c.rotate(-Math.PI/2),c.textAlign="center",c.fillText(O,0,0),c.restore()),c.textAlign="center";const E=N.data.length,U=Math.min(6,Math.max(2,E)),I=Math.max(1,Math.floor((E-1)/(U-1)));for(let p=0;p<E;p+=I){const x=b+k/(E-1)*p,g=((P=_.labels)==null?void 0:P[p])||"";g&&c.fillText(g,x,b+y+18)}S&&c.fillText(S,b+k/2,b+y+34),c.strokeStyle="#3b82f6",c.lineWidth=2,c.beginPath(),N.data.forEach((p,x)=>{const g=b+k/(N.data.length-1)*x,L=b+y-(p-W)/j*y;x===0?c.moveTo(g,L):c.lineTo(g,L)}),c.stroke(),c.fillStyle="#3b82f6",N.data.forEach((p,x)=>{const g=b+k/(N.data.length-1)*x,L=b+y-(p-W)/j*y;c.beginPath(),c.arc(g,L,4,0,2*Math.PI),c.fill()})},l=(c,_,b,k,y,S,O)=>{var P;const N=_.datasets[0];if(!N)return;const A=Math.max(...N.data),W=k/N.data.length*.8,j=k/N.data.length*.2;c.fillStyle="#3b82f6",N.data.forEach((p,x)=>{const g=p/A*y,L=b+x*(W+j)+j/2,F=b+y-g;c.fillRect(L,F,W,g)}),c.fillStyle="#6b7280",c.font="12px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial",c.textAlign="right";for(let p=0;p<=5;p++){const x=b+y/5*p,g=A-A/5*p,L=Number.isFinite(g)?g>=100?g.toFixed(0):g.toFixed(1):"0";c.fillText(L,b-8,x+4)}O&&(c.save(),c.translate(16,b+y/2),c.rotate(-Math.PI/2),c.textAlign="center",c.fillText(O,0,0),c.restore()),c.textAlign="center";const E=N.data.length,U=Math.min(6,Math.max(2,E)),I=Math.max(1,Math.floor((E-1)/(U-1)));for(let p=0;p<E;p+=I){const x=b+p*(W+j)+j/2+W/2,g=((P=_.labels)==null?void 0:P[p])||"";g&&c.fillText(g,x,b+y+18)}S&&c.fillText(S,b+k/2,b+y+34)},m=(c,_,b,k,y)=>{const S=_.datasets[0];if(!S)return;const O=S.data.reduce((W,j)=>W+j,0),N=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6"];let A=0;S.data.forEach((W,j)=>{const E=W/O*2*Math.PI;c.beginPath(),c.arc(b,k,y,A,A+E),c.arc(b,k,y*.6,A+E,A,!0),c.closePath(),c.fillStyle=N[j%N.length],c.fill(),A+=E})};return a?s("div",{className:`flex items-center justify-center ${i}`,style:{height:n},children:s("div",{className:"text-center",children:[s("div",{className:"w-8 h-8 border-2 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-2"}),s("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Loading chart..."})]})}):o?s("div",{className:`flex items-center justify-center ${i}`,style:{height:n},children:s("div",{className:"text-center",children:[s("svg",{className:"w-12 h-12 mx-auto mb-4 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 16.5c-.77.833.192 2.5 1.732 2.5z"})}),s("p",{className:"text-sm text-red-600 dark:text-red-400",children:o})]})}):s("div",{className:`chart-container ${i}`,children:[t&&s("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:t}),s("div",{className:"relative",children:s("canvas",{ref:u,width:800,height:n,className:"w-full h-auto"})})]})}const Vr={},mt=t=>{let e;const r=new Set,n=(h,l)=>{const m=typeof h=="function"?h(e):h;if(!Object.is(m,e)){const c=e;e=l??(typeof m!="object"||m===null)?m:Object.assign({},e,m),r.forEach(_=>_(e,c))}},a=()=>e,f={setState:n,getState:a,getInitialState:()=>u,subscribe:h=>(r.add(h),()=>r.delete(h)),destroy:()=>{(Vr?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},u=e=t(n,a,f);return f},Br=t=>t?mt(t):mt;function Ft(t,e){for(var r in e)t[r]=e[r];return t}function Ie(t,e){for(var r in t)if(r!=="__source"&&!(r in e))return!0;for(var n in e)if(n!=="__source"&&t[n]!==e[n])return!0;return!1}function Ze(t,e){var r=e(),n=C({t:{__:r,u:e}}),a=n[0].t,o=n[1];return le(function(){a.__=r,a.u=e,Ue(a)&&o({t:a})},[t,r,e]),V(function(){return Ue(a)&&o({t:a}),t(function(){Ue(a)&&o({t:a})})},[t]),r}function Ue(t){var e,r,n=t.u,a=t.__;try{var o=n();return!((e=a)===(r=o)&&(e!==0||1/e==1/r)||e!=e&&r!=r)}catch{return!0}}function Qe(t){t()}function Ye(t){return t}function Xe(){return[!1,Qe]}var Ke=le;function Ne(t,e){this.props=t,this.context=e}function zt(t,e){function r(a){var o=this.props.ref,i=o==a.ref;return!i&&o&&(o.call?o(null):o.current=null),e?!e(this.props,a)||!i:Ie(this.props,a)}function n(a){return this.shouldComponentUpdate=r,X(t,a)}return n.displayName="Memo("+(t.displayName||t.name)+")",n.prototype.isReactComponent=!0,n.__f=!0,n.type=t,n}(Ne.prototype=new Q).isPureReactComponent=!0,Ne.prototype.shouldComponentUpdate=function(t,e){return Ie(this.props,t)||Ie(this.state,e)};var ft=R.__b;R.__b=function(t){t.type&&t.type.__f&&t.ref&&(t.props.ref=t.ref,t.ref=null),ft&&ft(t)};var qr=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function Gt(t){function e(r){var n=Ft({},r);return delete n.ref,t(n,r.ref||null)}return e.$$typeof=qr,e.render=t,e.prototype.isReactComponent=e.__f=!0,e.displayName="ForwardRef("+(t.displayName||t.name)+")",e}var pt=function(t,e){return t==null?null:K(K(t).map(e))},Vt={map:pt,forEach:pt,count:function(t){return t?K(t).length:0},only:function(t){var e=K(t);if(e.length!==1)throw"Children.only";return e[0]},toArray:K},Jr=R.__e;R.__e=function(t,e,r,n){if(t.then){for(var a,o=e;o=o.__;)if((a=o.__c)&&a.__c)return e.__e==null&&(e.__e=r.__e,e.__k=r.__k),a.__c(t,e)}Jr(t,e,r,n)};var gt=R.unmount;function Bt(t,e,r){return t&&(t.__c&&t.__c.__H&&(t.__c.__H.__.forEach(function(n){typeof n.__c=="function"&&n.__c()}),t.__c.__H=null),(t=Ft({},t)).__c!=null&&(t.__c.__P===r&&(t.__c.__P=e),t.__c.__e=!0,t.__c=null),t.__k=t.__k&&t.__k.map(function(n){return Bt(n,e,r)})),t}function qt(t,e,r){return t&&r&&(t.__v=null,t.__k=t.__k&&t.__k.map(function(n){return qt(n,e,r)}),t.__c&&t.__c.__P===e&&(t.__e&&r.appendChild(t.__e),t.__c.__e=!0,t.__c.__P=r)),t}function he(){this.__u=0,this.o=null,this.__b=null}function Jt(t){var e=t.__.__c;return e&&e.__a&&e.__a(t)}function Zt(t){var e,r,n;function a(o){if(e||(e=t()).then(function(i){r=i.default||i},function(i){n=i}),n)throw n;if(!r)throw e;return X(r,o)}return a.displayName="Lazy",a.__f=!0,a}function se(){this.i=null,this.l=null}R.unmount=function(t){var e=t.__c;e&&e.__R&&e.__R(),e&&32&t.__u&&(t.type=null),gt&&gt(t)},(he.prototype=new Q).__c=function(t,e){var r=e.__c,n=this;n.o==null&&(n.o=[]),n.o.push(r);var a=Jt(n.__v),o=!1,i=function(){o||(o=!0,r.__R=null,a?a(d):d())};r.__R=i;var d=function(){if(!--n.__u){if(n.state.__a){var f=n.state.__a;n.__v.__k[0]=qt(f,f.__c.__P,f.__c.__O)}var u;for(n.setState({__a:n.__b=null});u=n.o.pop();)u.forceUpdate()}};n.__u++||32&e.__u||n.setState({__a:n.__b=n.__v.__k[0]}),t.then(i,i)},he.prototype.componentWillUnmount=function(){this.o=[]},he.prototype.render=function(t,e){if(this.__b){if(this.__v.__k){var r=document.createElement("div"),n=this.__v.__k[0].__c;this.__v.__k[0]=Bt(this.__b,r,n.__O=n.__P)}this.__b=null}var a=e.__a&&X(Z,null,t.fallback);return a&&(a.__u&=-33),[X(Z,null,e.__a?null:t.children),a]};var _t=function(t,e,r){if(++r[1]===r[0]&&t.l.delete(e),t.props.revealOrder&&(t.props.revealOrder[0]!=="t"||!t.l.size))for(r=t.i;r;){for(;r.length>3;)r.pop()();if(r[1]<r[0])break;t.i=r=r[2]}};function Zr(t){return this.getChildContext=function(){return t.context},t.children}function Qr(t){var e=this,r=t.h;if(e.componentWillUnmount=function(){ae(null,e.v),e.v=null,e.h=null},e.h&&e.h!==r&&e.componentWillUnmount(),!e.v){for(var n=e.__v;n!==null&&!n.__m&&n.__!==null;)n=n.__;e.h=r,e.v={nodeType:1,parentNode:r,childNodes:[],__k:{__m:n.__m},contains:function(){return!0},insertBefore:function(a,o){this.childNodes.push(a),e.h.insertBefore(a,o)},removeChild:function(a){this.childNodes.splice(this.childNodes.indexOf(a)>>>1,1),e.h.removeChild(a)}}}ae(X(Zr,{context:e.context},t.__v),e.v)}function Qt(t,e){var r=X(Qr,{__v:t,h:e});return r.containerInfo=e,r}(se.prototype=new Q).__a=function(t){var e=this,r=Jt(e.__v),n=e.l.get(t);return n[0]++,function(a){var o=function(){e.props.revealOrder?(n.push(a),_t(e,t,n)):a()};r?r(o):o()}},se.prototype.render=function(t){this.i=null,this.l=new Map;var e=K(t.children);t.revealOrder&&t.revealOrder[0]==="b"&&e.reverse();for(var r=e.length;r--;)this.l.set(e[r],this.i=[1,0,this.i]);return t.children},se.prototype.componentDidUpdate=se.prototype.componentDidMount=function(){var t=this;this.l.forEach(function(e,r){_t(t,r,e)})};var Yt=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,Yr=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,Xr=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,Kr=/[A-Z0-9]/g,es=typeof document<"u",ts=function(t){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(t)};function Xt(t,e,r){return e.__k==null&&(e.textContent=""),ae(t,e),typeof r=="function"&&r(),t?t.__c:null}function Kt(t,e,r){return It(t,e),typeof r=="function"&&r(),t?t.__c:null}Q.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(t){Object.defineProperty(Q.prototype,t,{configurable:!0,get:function(){return this["UNSAFE_"+t]},set:function(e){Object.defineProperty(this,t,{configurable:!0,writable:!0,value:e})}})});var yt=R.event;function rs(){}function ss(){return this.cancelBubble}function ns(){return this.defaultPrevented}R.event=function(t){return yt&&(t=yt(t)),t.persist=rs,t.isPropagationStopped=ss,t.isDefaultPrevented=ns,t.nativeEvent=t};var et,as={enumerable:!1,configurable:!0,get:function(){return this.class}},vt=R.vnode;R.vnode=function(t){typeof t.type=="string"&&function(e){var r=e.props,n=e.type,a={},o=n.indexOf("-")===-1;for(var i in r){var d=r[i];if(!(i==="value"&&"defaultValue"in r&&d==null||es&&i==="children"&&n==="noscript"||i==="class"||i==="className")){var f=i.toLowerCase();i==="defaultValue"&&"value"in r&&r.value==null?i="value":i==="download"&&d===!0?d="":f==="translate"&&d==="no"?d=!1:f[0]==="o"&&f[1]==="n"?f==="ondoubleclick"?i="ondblclick":f!=="onchange"||n!=="input"&&n!=="textarea"||ts(r.type)?f==="onfocus"?i="onfocusin":f==="onblur"?i="onfocusout":Xr.test(i)&&(i=f):f=i="oninput":o&&Yr.test(i)?i=i.replace(Kr,"-$&").toLowerCase():d===null&&(d=void 0),f==="oninput"&&a[i=f]&&(i="oninputCapture"),a[i]=d}}n=="select"&&a.multiple&&Array.isArray(a.value)&&(a.value=K(r.children).forEach(function(u){u.props.selected=a.value.indexOf(u.props.value)!=-1})),n=="select"&&a.defaultValue!=null&&(a.value=K(r.children).forEach(function(u){u.props.selected=a.multiple?a.defaultValue.indexOf(u.props.value)!=-1:a.defaultValue==u.props.value})),r.class&&!r.className?(a.class=r.class,Object.defineProperty(a,"className",as)):(r.className&&!r.class||r.class&&r.className)&&(a.class=a.className=r.className),e.props=a}(t),t.$$typeof=Yt,vt&&vt(t)};var bt=R.__r;R.__r=function(t){bt&&bt(t),et=t.__c};var xt=R.diffed;R.diffed=function(t){xt&&xt(t);var e=t.props,r=t.__e;r!=null&&t.type==="textarea"&&"value"in e&&e.value!==r.value&&(r.value=e.value==null?"":e.value),et=null};var er={ReactCurrentDispatcher:{current:{readContext:function(t){return et.__n[t.__c].props.value},useCallback:Ge,useContext:Ve,useDebugValue:Be,useDeferredValue:Ye,useEffect:V,useId:qe,useImperativeHandle:ze,useInsertionEffect:Ke,useLayoutEffect:le,useMemo:ce,useReducer:Se,useRef:Ce,useState:C,useSyncExternalStore:Ze,useTransition:Xe}}},os="18.3.1";function tr(t){return X.bind(null,t)}function ge(t){return!!t&&t.$$typeof===Yt}function rr(t){return ge(t)&&t.type===Z}function sr(t){return!!t&&!!t.displayName&&(typeof t.displayName=="string"||t.displayName instanceof String)&&t.displayName.startsWith("Memo(")}function nr(t){return ge(t)?Wr.apply(null,arguments):t}function ar(t){return!!t.__k&&(ae(null,t),!0)}function or(t){return t&&(t.base||t.nodeType===1&&t)||null}var ir=function(t,e){return t(e)},lr=function(t,e){return t(e)},cr=Z,dr=ge,ur={useState:C,useId:qe,useReducer:Se,useEffect:V,useLayoutEffect:le,useInsertionEffect:Ke,useTransition:Xe,useDeferredValue:Ye,useSyncExternalStore:Ze,startTransition:Qe,useRef:Ce,useImperativeHandle:ze,useMemo:ce,useCallback:Ge,useContext:Ve,useDebugValue:Be,version:"18.3.1",Children:Vt,render:Xt,hydrate:Kt,unmountComponentAtNode:ar,createPortal:Qt,createElement:X,createContext:Dt,createFactory:tr,cloneElement:nr,createRef:$t,Fragment:Z,isValidElement:ge,isElement:dr,isFragment:rr,isMemo:sr,findDOMNode:or,Component:Q,PureComponent:Ne,memo:zt,forwardRef:Gt,flushSync:lr,unstable_batchedUpdates:ir,StrictMode:cr,Suspense:he,SuspenseList:se,lazy:Zt,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:er};const is=Object.freeze(Object.defineProperty({__proto__:null,Children:Vt,Component:Q,Fragment:Z,PureComponent:Ne,StrictMode:cr,Suspense:he,SuspenseList:se,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:er,cloneElement:nr,createContext:Dt,createElement:X,createFactory:tr,createPortal:Qt,createRef:$t,default:ur,findDOMNode:or,flushSync:lr,forwardRef:Gt,hydrate:Kt,isElement:dr,isFragment:rr,isMemo:sr,isValidElement:ge,lazy:Zt,memo:zt,render:Xt,startTransition:Qe,unmountComponentAtNode:ar,unstable_batchedUpdates:ir,useCallback:Ge,useContext:Ve,useDebugValue:Be,useDeferredValue:Ye,useEffect:V,useErrorBoundary:Dr,useId:qe,useImperativeHandle:ze,useInsertionEffect:Ke,useLayoutEffect:le,useMemo:ce,useReducer:Se,useRef:Ce,useState:C,useSyncExternalStore:Ze,useTransition:Xe,version:os},Symbol.toStringTag,{value:"Module"}));function ls(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function cs(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var a=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return t[n]}})}),r}var hr={exports:{}},mr={};const fr=cs(is);var pr={exports:{}},gr={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ie=fr;function ds(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var us=typeof Object.is=="function"?Object.is:ds,hs=ie.useState,ms=ie.useEffect,fs=ie.useLayoutEffect,ps=ie.useDebugValue;function gs(t,e){var r=e(),n=hs({inst:{value:r,getSnapshot:e}}),a=n[0].inst,o=n[1];return fs(function(){a.value=r,a.getSnapshot=e,$e(a)&&o({inst:a})},[t,r,e]),ms(function(){return $e(a)&&o({inst:a}),t(function(){$e(a)&&o({inst:a})})},[t]),ps(r),r}function $e(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!us(t,r)}catch{return!0}}function _s(t,e){return e()}var ys=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?_s:gs;gr.useSyncExternalStore=ie.useSyncExternalStore!==void 0?ie.useSyncExternalStore:ys;pr.exports=gr;var vs=pr.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ee=fr,bs=vs;function xs(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ws=typeof Object.is=="function"?Object.is:xs,ks=bs.useSyncExternalStore,Ns=Ee.useRef,Ss=Ee.useEffect,Cs=Ee.useMemo,Es=Ee.useDebugValue;mr.useSyncExternalStoreWithSelector=function(t,e,r,n,a){var o=Ns(null);if(o.current===null){var i={hasValue:!1,value:null};o.current=i}else i=o.current;o=Cs(function(){function f(c){if(!u){if(u=!0,h=c,c=n(c),a!==void 0&&i.hasValue){var _=i.value;if(a(_,c))return l=_}return l=c}if(_=l,ws(h,c))return _;var b=n(c);return a!==void 0&&a(_,b)?(h=c,_):(h=c,l=b)}var u=!1,h,l,m=r===void 0?null:r;return[function(){return f(e())},m===null?void 0:function(){return f(m())}]},[e,r,n,a]);var d=ks(t,o[0],o[1]);return Ss(function(){i.hasValue=!0,i.value=d},[d]),Es(d),d};hr.exports=mr;var Ts=hr.exports;const Rs=ls(Ts),_r={},{useDebugValue:Us}=ur,{useSyncExternalStoreWithSelector:$s}=Rs;let wt=!1;const Ls=t=>t;function Ps(t,e=Ls,r){(_r?"production":void 0)!=="production"&&r&&!wt&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),wt=!0);const n=$s(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,r);return Us(n),n}const kt=t=>{(_r?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof t=="function"?Br(t):t,r=(n,a)=>Ps(e,n,a);return Object.assign(r,e),r},_e=t=>t?kt(t):kt,yr=_e(t=>({ruleGroups:[],loading:!1,error:null,setRuleGroups:e=>t({ruleGroups:e,error:null}),addRuleGroup:e=>t(r=>({ruleGroups:[...r.ruleGroups.filter(n=>n.name!==e.name),e]})),updateRuleGroup:(e,r)=>t(n=>({ruleGroups:n.ruleGroups.map(a=>a.name===e?r:a)})),removeRuleGroup:e=>t(r=>({ruleGroups:r.ruleGroups.filter(n=>n.name!==e)})),setLoading:e=>t({loading:e}),setError:e=>t({error:e})})),vr=_e(t=>({upstreams:[],loading:!1,error:null,setUpstreams:e=>t({upstreams:e,error:null}),addUpstream:e=>t(r=>({upstreams:[...r.upstreams,e]})),removeUpstream:e=>t(r=>({upstreams:r.upstreams.filter(n=>n.address!==e)})),setLoading:e=>t({loading:e}),setError:e=>t({error:e})})),br=_e(t=>({stats:null,loading:!1,error:null,setStats:e=>t({stats:e,error:null}),setLoading:e=>t({loading:e}),setError:e=>t({error:e})})),xr=_e(t=>({info:null,loading:!1,error:null,setInfo:e=>t({info:e,error:null}),setLoading:e=>t({loading:e}),setError:e=>t({error:e})})),wr=_e(t=>({events:[],loading:!1,error:null,setEvents:e=>t({events:e,error:null}),addEvent:e=>t(r=>({events:[e,...r.events].slice(0,2e3)})),setLoading:e=>t({loading:e}),setError:e=>t({error:e})})),kr=()=>yr(t=>t.ruleGroups),Nr=()=>yr(t=>({setRuleGroups:t.setRuleGroups,addRuleGroup:t.addRuleGroup,updateRuleGroup:t.updateRuleGroup,removeRuleGroup:t.removeRuleGroup,setLoading:t.setLoading,setError:t.setError})),Sr=()=>vr(t=>t.upstreams),Cr=()=>vr(t=>({setUpstreams:t.setUpstreams,addUpstream:t.addUpstream,removeUpstream:t.removeUpstream,setLoading:t.setLoading,setError:t.setError})),As=()=>br(t=>t.stats),Ms=()=>br(t=>({setStats:t.setStats,setLoading:t.setLoading,setError:t.setError})),Os=()=>wr(t=>t.events),Ws=()=>wr(t=>({setEvents:t.setEvents,addEvent:t.addEvent,setLoading:t.setLoading,setError:t.setError})),Is=()=>xr(t=>t.info),Ds=()=>xr(t=>({setInfo:t.setInfo,setLoading:t.setLoading,setError:t.setError})),Le=[{label:"1m",seconds:60},{label:"5m",seconds:300},{label:"15m",seconds:900}],js={1:"A",28:"AAAA",2:"NS",5:"CNAME",6:"SOA",12:"PTR",15:"MX",16:"TXT",33:"SRV"};function Hs({provider:t}){const e=As(),{setStats:r,setError:n}=Ms(),a=kr(),o=Sr(),i=Is(),{setRuleGroups:d,setError:f}=Nr(),{setUpstreams:u,setError:h}=Cr(),{setInfo:l,setError:m}=Ds(),[c,_]=C(Le[1]),[b,k]=C([]),[y,S]=C([]),O=g=>{window.location.hash=g,window.scrollTo(0,0)};V(()=>{const g=t.onStats(r),L=t.onRuleGroups(d),F=t.onUpstreams(u),J=t.onOverview?t.onOverview(T=>{T!=null&&T.stats&&r(T.stats);try{window.__ov=T}catch{}A(T)}):()=>{};return t.fetchStats().then(r).catch(T=>n(T.message)),t.fetchRuleGroups().then(d).catch(T=>f(T.message)),t.fetchUpstreams().then(u).catch(T=>h(T.message)),t.fetchServerInfo().then(l).catch(T=>m(T.message)),t.fetchOverview&&t.fetchOverview().then(T=>{T!=null&&T.stats&&r(T.stats),A(T);try{window.__ov=T}catch{}}).catch(()=>{}),()=>{g(),L(),F(),J()}},[t,r,d,u,n,f,h,l,m]);const[N,A]=C(null);V(()=>{if(!e)return;const g=30,L=e.effective_rps??(e.dns_queries_total?e.dns_queries_total/60:0);k(J=>{const T=[...J,Math.max(0,Number(L||0))];return T.length>g&&T.shift(),T});const F=(e.dns_request_avg_seconds??0)*1e3;S(J=>{const T=[...J,Math.max(0,Number(F||0))];return T.length>g&&T.shift(),T})},[e]);const W=(e==null?void 0:e.effective_rps)??(e?e.dns_queries_total/60:0),j=e!=null&&e.dns_request_avg_seconds?e.dns_request_avg_seconds*1e3:0,E=o?o.length:0,U=a?a.reduce((g,L)=>g+L.patterns.length,0):0,I=(()=>{if(!e)return null;const g=e.cache_hit_rate;return g==null||(e.dns_queries_total||0)===0?null:g})(),P=g=>Array.from({length:g},()=>""),p={labels:P(b.length),datasets:[{label:"RPS",data:b,borderColor:"#3b82f6",backgroundColor:"#3b82f6",fill:!1}]},x={labels:P(y.length),datasets:[{label:"Avg RT (ms)",data:y,borderColor:"#10b981",backgroundColor:"#10b981",fill:!1}]};return s("div",{className:"space-y-6",children:[s("div",{className:"flex items-center justify-between",children:[s("div",{children:[s("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Dashboard"}),s("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Monitor your DNS proxy performance and configuration"})]}),s("div",{className:"flex items-center space-x-4",children:s("select",{value:c.ms,onChange:g=>{const L=Le.find(F=>F.ms===parseInt(g.currentTarget.value));L&&_(L)},className:"px-3 py-2 text-sm border border-gray-300 rounded-md bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-800 dark:text-gray-100 dark:border-gray-600 dark:focus:border-blue-400 dark:focus:ring-blue-400",children:Le.map(g=>s("option",{value:g.ms,children:g.label},g.ms))})})]}),s("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[s(ve,{title:"DNS RPS",value:W.toFixed(1),icon:s("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),color:"blue",loading:!e}),s(ve,{title:"Response Time",value:`${j.toFixed(0)}ms`,icon:s("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),color:"green",loading:!e}),s(ve,{title:"Active Upstreams",value:E,icon:s("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),color:"purple",loading:!o}),s(ve,{title:"Total Rules",value:U,icon:s("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),color:"indigo",loading:!a})]}),s("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s(B,{title:"DNS Queries Over Time",subtitle:`Last ${c.label}`,children:s(ht,{data:p,type:"line",height:256,xLabel:"time",yLabel:"RPS",loading:!e})}),s(B,{title:"Response Time Over Time",subtitle:`Last ${c.label}`,children:s(ht,{data:x,type:"line",height:256,xLabel:"time",yLabel:"ms",loading:!e})})]}),s("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s(B,{title:"Service Status",className:"lg:col-span-2",children:s("div",{className:"space-y-4",children:[s("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[s("div",{className:"flex items-center",children:[s("div",{className:`w-3 h-3 rounded-full mr-3 ${(e==null?void 0:e.service_ready)===1?"bg-green-500":"bg-red-500"}`}),s("div",{children:[s("p",{className:"font-medium text-gray-900 dark:text-white",children:"DNS Proxy"}),s("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:(e==null?void 0:e.service_ready)===1?"Running":"Stopped"})]})]}),s("div",{className:"text-right",children:[s("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Uptime"}),s("p",{className:"font-medium text-gray-900 dark:text-white",children:(N==null?void 0:N.uptime)??(i?i.uptime:"Unknown")})]})]}),s("div",{className:"grid grid-cols-2 gap-4",children:[s("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[s("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Cache hit rate"}),s("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:I==null?"N/A":`${(I*100).toFixed(2)}%`})]}),s("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[s("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Queries (1m)"}),s("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:[(N==null?void 0:N.queries_last_min)??"N/A",N!=null&&N.errors_last_min?` (${N==null?void 0:N.errors_last_min} errors)`:""]})]})]})]})}),s(B,{title:"Quick Actions",children:s("div",{className:"space-y-3",children:[s(M,{variant:"outline",fullWidth:!0,className:"justify-start hover:scale-[1.01] transition-transform",onClick:()=>O("rules"),children:[s("svg",{className:"w-5 h-5 mr-3 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add New Rule"]}),s(M,{variant:"outline",fullWidth:!0,className:"justify-start hover:scale-[1.01] transition-transform",onClick:()=>O("upstreams"),children:[s("svg",{className:"w-5 h-5 mr-3 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),"Add Upstream"]})]})})]})]})}function z({label:t,error:e,hint:r,required:n=!1,className:a="",id:o,...i}){const d=o||`input-${Math.random().toString(36).substr(2,9)}`,m=`input-field block w-full px-3 py-2.5 text-sm rounded-md border transition-all duration-200 ease-out focus:outline-none focus:ring-2 disabled:opacity-50 disabled:cursor-not-allowed bg-white text-gray-900 placeholder-gray-500 border-gray-300 hover:border-gray-400 focus:border-blue-500 focus:ring-blue-500 disabled:bg-gray-50 disabled:border-gray-300 dark:bg-gray-800 dark:text-gray-100 dark:placeholder-gray-400 dark:border-gray-600 dark:hover:border-gray-500 dark:focus:border-blue-400 dark:focus:ring-blue-400 dark:disabled:bg-gray-700 dark:disabled:border-gray-600 ${e?"border-red-500 focus:border-red-500 focus:ring-red-500 dark:border-red-400 dark:focus:border-red-400 dark:focus:ring-red-400":""} ${a}`.trim();return s("div",{className:"input-container space-y-1",children:[t&&s("label",{htmlFor:d,className:"input-label block text-sm font-medium text-gray-700 dark:text-gray-300",children:[t,n&&s("span",{className:"text-red-500 ml-1",children:"*"})]}),s("input",{id:d,className:m,...i}),r&&!e&&s("p",{className:"input-hint text-xs text-gray-500 dark:text-gray-400",children:r}),e&&s("p",{className:"input-error text-xs text-red-600 dark:text-red-400",children:e})]})}function Fs({provider:t}){const[e,r]=C(""),[n,a]=C("A"),[o,i]=C(""),[d,f]=C(!1);return s("div",{className:"space-y-6",children:[s("div",{children:[s("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Resolve"}),s("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Run a test DNS resolve via the active pipeline"})]}),s(B,{children:s("form",{onSubmit:async h=>{if(h.preventDefault(),!!e.trim()){f(!0),i("");try{const l=await t.testResolve(e.trim(),n),m=[`Upstream: ${l.upstream}`,`RCODE: ${l.rcode}`,`Answers: ${l.answers}`];l.response_time_ms!==void 0&&m.push(`Time: ${l.response_time_ms}ms`),l.ttl!==void 0&&m.push(`TTL: ${l.ttl}s`);const c=m.join(" | "),_=(l.records||[]).join(`
`);i(`${c}
${_}`)}catch(l){i(l.message)}finally{f(!1)}}},className:"space-y-4",children:[s("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[s(z,{label:"Domain",value:e,onInput:h=>r(h.target.value),placeholder:"example.com",required:!0}),s("div",{children:[s("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Type"}),s("select",{className:"w-full px-3 py-2 h-[42px] border border-gray-300 rounded-md bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-800 dark:text-gray-100 dark:border-gray-600 dark:focus:border-blue-400 dark:focus:ring-blue-400",value:n,onChange:h=>a(h.currentTarget.value),children:[s("option",{value:"A",children:"A"}),s("option",{value:"AAAA",children:"AAAA"}),s("option",{value:"CNAME",children:"CNAME"}),s("option",{value:"MX",children:"MX"}),s("option",{value:"NS",children:"NS"}),s("option",{value:"TXT",children:"TXT"}),s("option",{value:"SRV",children:"SRV"}),s("option",{value:"PTR",children:"PTR"})]})]}),s("div",{className:"flex items-end",children:s(M,{type:"submit",variant:"primary",fullWidth:!0,loading:d,disabled:d,children:d?"Resolving…":"Resolve"})})]}),o&&s("div",{children:[s("div",{className:"flex items-center justify-between mb-2",children:[s("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Result"}),s("div",{className:"flex gap-2",children:[s(M,{type:"button",variant:"outline",size:"sm",onClick:()=>navigator.clipboard.writeText(o),children:"Copy"}),s(M,{type:"button",variant:"secondary",size:"sm",onClick:()=>i(""),children:"Clear"})]})]}),s("pre",{className:"mt-1 p-3 rounded-md bg-gray-50 text-gray-800 dark:bg-gray-900 dark:text-gray-200 whitespace-pre-wrap text-sm border border-gray-200 dark:border-gray-700 font-mono leading-6 max-h-96 overflow-auto",children:o})]})]})})]})}function we({children:t,variant:e="default",size:r="md",className:n="",...a}){const o="badge inline-flex items-center rounded-md font-medium",i={default:"bg-gray-100 text-gray-900 dark:bg-gray-800 dark:text-gray-100",primary:"bg-blue-600 text-white dark:bg-blue-600 dark:text-white",secondary:"bg-gray-200 text-gray-900 dark:bg-gray-700 dark:text-gray-100"},d={sm:"px-2 py-0.5 text-xs",md:"px-2.5 py-1 text-sm"},f=`${o} ${i[e]} ${d[r]} ${n}`.trim();return s("span",{className:f,...a,children:t})}const zs=[{id:"overview",label:"Overview",icon:s("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"}),s("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 5a2 2 0 012-2h4a2 2 0 012 2v6H8V5z"})]})},{id:"rules",label:"Rules",icon:s("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})},{id:"upstreams",label:"Upstreams",icon:s("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})})},{id:"history",label:"History",icon:s("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})},{id:"hosts",label:"Hosts",icon:s("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7h18M3 12h18M3 17h18"})})},{id:"resolve",label:"Resolve",icon:s("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3M3 11h18M5 19h14a2 2 0 002-2v-6H3v6a2 2 0 002 2z"})})},{id:"update",label:"Updates",icon:s("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}];function Gs({activeTab:t,onTabChange:e,collapsed:r=!1}){return s("aside",{className:`fixed left-0 top-0 z-40 h-screen bg-white/95 dark:bg-gray-800/95 backdrop-blur-sm border-r border-gray-100 dark:border-gray-700 transition-all duration-300 ${r?"w-16":"w-64"} ${r?"-translate-x-full lg:translate-x-0":"translate-x-0"} lg:translate-x-0`,children:[s("div",{className:"flex items-center justify-between h-16 px-3 border-b border-gray-100 dark:border-gray-700",children:[!r&&s("div",{className:"flex items-center space-x-2",children:[s("div",{className:"w-7 h-7 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center shadow-sm",children:s("span",{className:"text-white font-bold text-sm",children:"O"})}),s("span",{className:"text-lg font-semibold text-gray-900 dark:text-white tracking-tight",children:"Outway"})]}),r&&s("div",{className:"w-7 h-7 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center mx-auto shadow-sm",children:s("span",{className:"text-white font-bold text-sm",children:"O"})})]}),s("nav",{className:"flex-1 px-3 py-4 space-y-1 overflow-y-auto",children:zs.map(n=>{const a=t===n.id;return s("button",{onClick:()=>e(n.id),className:`w-full flex items-center px-3 py-2.5 text-sm font-medium rounded-xl transition-all duration-200 ${a?"bg-blue-600 text-white shadow-lg shadow-blue-600/25":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-white"}`,children:[s("span",{className:`flex-shrink-0 ${r?"mx-auto":"mr-3"}`,children:n.icon}),!r&&s("span",{className:"truncate font-medium",children:n.label})]},n.id)})}),s("div",{className:"p-3 border-t border-gray-100 dark:border-gray-700",children:[!r&&s("div",{className:"flex items-center space-x-3",children:[s("div",{className:"w-8 h-8 bg-gradient-to-br from-gray-300 to-gray-400 dark:from-gray-600 dark:to-gray-700 rounded-full flex items-center justify-center shadow-sm",children:s("span",{className:"text-xs font-semibold text-gray-700 dark:text-gray-200",children:"A"})}),s("div",{className:"flex-1 min-w-0",children:[s("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:"Admin"}),s("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:"outway@example.com"})]})]}),r&&s("div",{className:"flex justify-center",children:s("div",{className:"w-8 h-8 bg-gradient-to-br from-gray-300 to-gray-400 dark:from-gray-600 dark:to-gray-700 rounded-full flex items-center justify-center shadow-sm",children:s("span",{className:"text-xs font-semibold text-gray-700 dark:text-gray-200",children:"A"})})})]})]})}const Nt="outway-theme";function Er(){const[t,e]=C(()=>typeof window>"u"?"auto":localStorage.getItem(Nt)||"auto"),[r,n]=C("light");return V(()=>{const o=()=>{if(t==="auto"){const i=window.matchMedia("(prefers-color-scheme: dark)").matches;n(i?"dark":"light")}else n(t)};if(o(),t==="auto"){const i=window.matchMedia("(prefers-color-scheme: dark)"),d=()=>o();return i.addEventListener("change",d),()=>i.removeEventListener("change",d)}},[t]),V(()=>{const o=document.documentElement;r==="dark"?o.classList.add("dark"):o.classList.remove("dark")},[r]),V(()=>{typeof window<"u"&&localStorage.setItem(Nt,t)},[t]),{theme:t,resolvedTheme:r,setTheme:o=>{e(o)}}}function Vs({className:t="",showLabel:e=!1,variant:r="select",...n}){const{theme:a,resolvedTheme:o,setTheme:i}=Er(),d=m=>{i(m)},f=()=>{const m=["light","dark","auto"],_=(m.indexOf(a)+1)%m.length;i(m[_])},u=()=>{switch(a){case"light":return s("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})});case"dark":return s("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})});case"auto":return s("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}},h=()=>{switch(a){case"light":return"Light theme";case"dark":return"Dark theme";case"auto":return`Auto theme (${o})`}},l=[{value:"light",label:"Light",icon:"☀️"},{value:"dark",label:"Dark",icon:"🌙"},{value:"auto",label:"Auto",icon:"🔄"}];return r==="button"?s("div",{className:`flex items-center gap-2 ${t}`,...n,children:[s("button",{onClick:f,className:"p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-500 dark:text-gray-400 transition-colors duration-200","aria-label":h(),title:h(),children:u()}),e&&s("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:a==="auto"?`Auto (${o})`:a})]}):s("div",{className:`theme-toggle ${t}`,...n,children:s("select",{value:a,onChange:m=>d(m.currentTarget.value),className:"theme-select",children:l.map(m=>s("option",{value:m.value,children:[m.icon," ",m.label]},m.value))})})}function Bs({onSidebarToggle:t,provider:e}){const[r,n]=C("ws");return V(()=>{if(!e||!e.onStatus)return;const a=e.onStatus(o=>n(o.channel));return()=>{a&&a()}},[e]),s("header",{className:"sticky top-0 z-30 bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm border-b border-gray-100 dark:border-gray-700",children:s("div",{className:"flex items-center justify-between h-14 px-4",children:[s("div",{className:"flex items-center gap-3",children:[t&&s("button",{onClick:t,className:"p-1.5 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-500 dark:text-gray-300 transition-all duration-200","aria-label":"Toggle sidebar",children:s("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 6h16M4 12h16M4 18h16"})})}),s("div",{className:"flex items-center lg:hidden select-none",children:[s("div",{className:"w-6 h-6 bg-gradient-to-br from-blue-500 to-blue-600 rounded flex items-center justify-center shadow-sm mr-2",children:s("span",{className:"text-white font-bold text-xs",children:"O"})}),s("span",{className:"text-sm font-semibold text-gray-900 dark:text-white tracking-tight",children:"Outway"})]})]}),s("div",{className:"flex items-center gap-2",children:[s("span",{className:`px-2 py-0.5 text-xs rounded-full ${r==="ws"?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300":"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300"}`,title:r==="ws"?"WebSocket live":"REST fallback",children:r.toUpperCase()}),(e==null?void 0:e.reconnect)&&r==="rest"&&s("button",{className:"inline-flex items-center gap-1 text-xs px-2 py-1 rounded-md border border-gray-300 dark:border-gray-600/50 text-gray-700 dark:text-gray-200 bg-transparent hover:bg-gray-50 dark:hover:bg-gray-700/50",title:"Try reconnect WebSocket",onClick:()=>e.reconnect&&e.reconnect(),children:[s("svg",{className:"w-3.5 h-3.5",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:s("path",{fillRule:"evenodd",d:"M4.083 9.75A6.75 6.75 0 0117.5 10a.75.75 0 001.5 0A8.25 8.25 0 103.5 15.398V13a.75.75 0 00-1.5 0v4a.75.75 0 00.75.75H7a.75.75 0 000-1.5H4.84A6.73 6.73 0 014.083 9.75z",clipRule:"evenodd"})}),"Reconnect"]}),s("div",{className:"mx-1",children:s(Vs,{variant:"button"})})]})]})})}function Tr({message:t,type:e="info",duration:r=5e3,onClose:n,position:a="top-right"}){const[o,i]=C(!1);V(()=>{const h=setTimeout(()=>i(!0),100),l=setTimeout(()=>{i(!1),setTimeout(n,300)},r);return()=>{clearTimeout(h),clearTimeout(l)}},[r,n]);const d={success:{bg:"bg-green-50 dark:bg-green-900",border:"border-green-200 dark:border-green-700",text:"text-green-800 dark:text-green-200",icon:s("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})},error:{bg:"bg-red-50 dark:bg-red-900",border:"border-red-200 dark:border-red-700",text:"text-red-800 dark:text-red-200",icon:s("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 16.5c-.77.833.192 2.5 1.732 2.5z"})})},warning:{bg:"bg-yellow-50 dark:bg-yellow-900",border:"border-yellow-200 dark:border-yellow-700",text:"text-yellow-800 dark:text-yellow-200",icon:s("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 16.5c-.77.833.192 2.5 1.732 2.5z"})})},info:{bg:"bg-blue-50 dark:bg-blue-900",border:"border-blue-200 dark:border-blue-700",text:"text-blue-800 dark:text-blue-200",icon:s("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}},f={"top-right":"top-4 right-4","top-left":"top-4 left-4","bottom-right":"bottom-4 right-4","bottom-left":"bottom-4 left-4"},u=d[e];return s("div",{className:`fixed ${f[a]} z-50 max-w-sm w-full`,children:s("div",{className:`${u.bg} ${u.border} border rounded-lg shadow-lg p-4 transition-all duration-300 ${o?"transform translate-x-0 opacity-100":"transform translate-x-full opacity-0"}`,children:s("div",{className:"flex items-start",children:[s("div",{className:`flex-shrink-0 ${u.text}`,children:u.icon}),s("div",{className:"ml-3 flex-1",children:s("p",{className:`text-sm font-medium ${u.text}`,children:t})}),s("div",{className:"ml-4 flex-shrink-0",children:s("button",{onClick:()=>{i(!1),setTimeout(n,300)},className:`${u.text} hover:opacity-75 transition-opacity`,children:s("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})})]})})})}function qs({toasts:t,onRemove:e}){return s("div",{className:"fixed inset-0 pointer-events-none z-50",children:t.map(r=>s(Tr,{message:r.message,type:r.type,duration:r.duration,onClose:()=>e(r.id)},r.id))})}function be({size:t="md",color:e="primary",text:r,className:n=""}){const a={sm:"w-4 h-4",md:"w-6 h-6",lg:"w-8 h-8"},o={primary:"text-blue-600",secondary:"text-gray-600",white:"text-white"};return s("div",{className:`flex items-center justify-center ${n}`,children:s("div",{className:"flex flex-col items-center space-y-2",children:[s("div",{className:`${a[t]} ${o[e]} animate-spin`,children:s("svg",{className:"w-full h-full",fill:"none",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[s("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),r&&s("p",{className:`text-sm ${o[e]} dark:text-gray-400`,children:r})]})})}function Js({provider:t}){const e=kr(),{setRuleGroups:r,setError:n}=Nr(),[a,o]=C(""),[i,d]=C(""),[f,u]=C(""),[h,l]=C([""]),[m,c]=C(!0),[_,b]=C(""),[k,y]=C(!1),[S,O]=C(null),[N,A]=C({});V(()=>{const v=t.onRuleGroups(w=>{r(w)});return t.fetchRuleGroups().then(r).catch(w=>{console.error("Failed to fetch rule groups:",w),n(w.message)}),v},[t,r,n]);const W=e.filter(v=>{var w;return v.name.toLowerCase().includes(_.toLowerCase())||((w=v.description)==null?void 0:w.toLowerCase().includes(_.toLowerCase()))||v.patterns.some($=>$.toLowerCase().includes(_.toLowerCase()))}),j=()=>{l([...h,""])},E=v=>{l(h.filter((w,$)=>$!==v))},U=(v,w)=>{const $=[...h];$[v]=w,l($)},I=async v=>{if(v.preventDefault(),!a.trim()||!f.trim()||h.some(w=>!w.trim())){n("Please fill in all required fields");return}y(!0);try{const w={name:a.trim(),description:i.trim()||"",via:f.trim(),patterns:h.filter($=>$.trim()),pin_ttl:m};await t.createRuleGroup(w),o(""),d(""),u(""),l([""]),c(!0)}catch(w){console.error("Failed to create rule group:",w),n(w instanceof Error?w.message:"Failed to create rule group")}finally{y(!1)}},P=v=>{A(w=>({...w,[v.name]:{...v}}))},p=v=>{A(w=>{const $={...w};return delete $[v],$})},x=(v,w,$)=>{A(q=>({...q,[v]:{...q[v],[w]:$}}))},g=(v,w,$)=>{A(q=>{const de=q[v];if(!de)return q;const Te=de.patterns.slice();return Te[w]=$,{...q,[v]:{...de,patterns:Te}}})},L=v=>{A(w=>{const $=w[v];return $?{...w,[v]:{...$,patterns:[...$.patterns,""]}}:w})},F=(v,w)=>{A($=>{const q=$[v];if(!q)return $;const de=q.patterns.filter((Te,Rr)=>Rr!==w);return{...$,[v]:{...q,patterns:de}}})},J=async v=>{const w=N[v];if(w)try{await t.updateRuleGroup(v,{name:w.name,description:w.description||"",via:w.via,patterns:w.patterns.filter(q=>q.trim()),pin_ttl:!!w.pin_ttl}),p(v);const $=await t.fetchRuleGroups();r($)}catch($){console.error("Failed to update rule group:",$),n($ instanceof Error?$.message:"Failed to update rule group")}},T=async v=>{try{await t.deleteRuleGroup(v),O(null)}catch(w){console.error("Failed to delete rule group:",w),n(w instanceof Error?w.message:"Failed to delete rule group")}};return s("div",{className:"space-y-6",children:[s("div",{className:"flex items-center justify-between",children:s("div",{children:[s("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Rule Groups"}),s("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Manage DNS routing rules and patterns"})]})}),s(B,{title:"Add New Rule Group",subtitle:"Create a new routing rule group",children:s("form",{onSubmit:I,className:"space-y-6",children:[s("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s(z,{label:"Group Name",value:a,onInput:v=>o(v.target.value),placeholder:"e.g., YouTube",required:!0}),s(z,{label:"Via Interface",value:f,onInput:v=>u(v.target.value),placeholder:"e.g., utun4",required:!0})]}),s(z,{label:"Description",value:i,onInput:v=>d(v.target.value),placeholder:"Optional description"}),s("div",{children:[s("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"DNS Patterns *"}),h.map((v,w)=>s("div",{className:"flex gap-3 mb-3",children:[s("div",{className:"flex-1",children:s(z,{value:v,onInput:$=>U(w,$.target.value),placeholder:"e.g., *.youtube.com",required:!0})}),h.length>1&&s(M,{type:"button",variant:"outline",size:"sm",onClick:()=>E(w),children:"Remove"})]},w)),s(M,{type:"button",variant:"secondary",size:"sm",onClick:j,children:"Add Pattern"})]}),s("div",{className:"flex items-center gap-3",children:[s("input",{type:"checkbox",id:"pin-ttl",checked:m,onChange:v=>c(v.target.checked),className:"rounded border-gray-300 dark:border-gray-600 text-black dark:text-white focus:ring-black dark:focus:ring-white"}),s("label",{htmlFor:"pin-ttl",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:s("span",{className:"input-label",children:"Pin TTL (keep IP/route until TTL expires)"})})]}),s("div",{className:"flex gap-3 pt-4 border-t border-gray-200 dark:border-gray-700",children:s(M,{type:"submit",variant:"primary",loading:k,disabled:k,children:k?"Creating...":"Create Rule Group"})})]})}),s("div",{children:s(z,{label:"Search Rule Groups",value:_,onInput:v=>b(v.target.value),placeholder:"Search by name, description, or pattern...",hint:"Filter rule groups by name, description, or DNS patterns"})}),s("div",{className:"grid gap-4",children:W.map(v=>s(B,{title:v.name,subtitle:v.description,children:[s("div",{className:"flex justify-between items-start mb-4",children:[s("div",{className:"flex items-center gap-3",children:[s(we,{variant:"primary",children:v.patterns.length}),s("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:v.patterns.length===1?"pattern":"patterns"})]}),s("div",{className:"flex gap-2",children:[N[v.name]?s(Z,{children:[s(M,{variant:"secondary",size:"sm",onClick:()=>p(v.name),children:"Cancel"}),s(M,{variant:"primary",size:"sm",onClick:()=>J(v.name),children:"Save"})]}):s(M,{variant:"secondary",size:"sm",onClick:()=>P(v),children:"Edit"}),s(M,{variant:"outline",size:"sm",onClick:()=>O(v.name),children:"Delete"})]})]}),N[v.name]?s("div",{className:"space-y-4",children:[s("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[s("div",{className:"flex items-center gap-2",children:[s("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Via Interface:"}),s(z,{value:N[v.name].via,onInput:w=>x(v.name,"via",w.target.value)})]}),s("div",{className:"flex items-center gap-2",children:[s("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Pin TTL:"}),s("input",{type:"checkbox",checked:!!N[v.name].pin_ttl,onChange:w=>x(v.name,"pin_ttl",w.target.checked)})]})]}),s("div",{children:[s("span",{className:"font-medium text-sm text-gray-700 dark:text-gray-300",children:"Description:"}),s(z,{value:N[v.name].description||"",onInput:w=>x(v.name,"description",w.target.value),placeholder:"Optional description"})]}),s("div",{className:"mt-2 pt-2 border-t border-gray-200 dark:border-gray-700",children:[s("span",{className:"font-medium text-sm text-gray-700 dark:text-gray-300",children:"DNS Patterns:"}),N[v.name].patterns.map((w,$)=>s("div",{className:"flex gap-2 mt-2",children:[s(z,{value:w,onInput:q=>g(v.name,$,q.target.value)}),s(M,{variant:"outline",size:"sm",onClick:()=>F(v.name,$),children:"Remove"})]},$)),s(M,{className:"mt-2",variant:"secondary",size:"sm",onClick:()=>L(v.name),children:"Add Pattern"})]})]}):s(Z,{children:[s("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[s("div",{className:"flex items-center gap-2",children:[s("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Via Interface:"}),s(we,{variant:"secondary",children:v.via})]}),s("div",{className:"flex items-center gap-2",children:[s("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Pin TTL:"}),s(we,{variant:v.pin_ttl?"primary":"secondary",children:v.pin_ttl?"Yes":"No"})]})]}),s("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[s("span",{className:"font-medium text-sm text-gray-700 dark:text-gray-300",children:"DNS Patterns:"}),s("div",{className:"flex flex-wrap gap-2 mt-2",children:v.patterns.map((w,$)=>s("span",{className:"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200 px-2 py-1 rounded text-xs font-mono",children:w},$))})]})]})]},v.name))}),W.length===0&&s(B,{className:"text-center py-8",children:s("p",{className:"text-secondary",children:_?"No rule groups match your search.":"No rule groups configured."})}),S&&s("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s(B,{className:"max-w-md w-full mx-4",children:[s("h3",{className:"text-lg font-semibold mb-4",children:"Confirm Delete"}),s("p",{className:"text-secondary mb-6",children:['Are you sure you want to delete the rule group "',S,'"? This action cannot be undone.']}),s("div",{className:"flex gap-3 justify-end",children:[s(M,{variant:"secondary",onClick:()=>O(null),children:"Cancel"}),s(M,{variant:"danger",onClick:()=>T(S),children:"Delete"})]})]})})]})}function Zs(t){return js[t]||`TYPE${t}`}function Qs(t){return t.length>50?t.substring(0,47)+"...":t}function Ys(t){return new Date(typeof t=="string"?t:t*1e3).toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"})}function Xs(t){return t.trim()?[/^udp:[a-zA-Z0-9.-]+:\d+$/,/^tcp:[a-zA-Z0-9.-]+:\d+$/,/^https?:\/\/[a-zA-Z0-9.-]+(\/.*)?$/,/^[a-zA-Z0-9.-]+:\d+$/,/^[a-zA-Z0-9.-]+$/].some(n=>n.test(t))?{valid:!0}:{valid:!1,error:"Invalid upstream format. Use: udp:host:port, tcp:host:port, https://host/path, or host:port"}:{valid:!1,error:"Upstream is required"}}function Ks({provider:t}){const e=Sr(),{setUpstreams:r,addUpstream:n,removeUpstream:a,setError:o}=Cr(),[i,d]=C(""),[f,u]=C(""),[h,l]=C(""),[m,c]=C(!1),[_,b]=C(null),[k,y]=C("asc"),[S,O]=C({});V(()=>t.onUpstreams(x=>{r(x)}),[t,r,o]);const N=[...e||[]].sort((p,x)=>{const g=(p.name||p.address).localeCompare(x.name||x.address);return k==="asc"?g:-g}),A=async p=>{p.preventDefault();const x=Xs(i);if(!x.valid){o(x.error);return}c(!0),o(null);try{let g=i.trim();try{const J=new URL(g),T=J.protocol.replace(":","").toLowerCase();T!=="https"&&(g=`${T==="tls"?"dot":T==="quic"?"doq":T}://${J.host}`)}catch{g=`udp://${g.replace(/^(udp|tcp|tls|dot|quic|doq):\/\//i,"")}`}const L={name:(f||new URL(g).hostname).trim(),address:g};h!==""&&(L.weight=Number(h)),n(L);const F=[...e,L];await t.saveUpstreams(F),d(""),u(""),l("")}catch(g){console.error("Failed to save upstream:",g),o(g instanceof Error?g.message:"Failed to save upstream")}finally{c(!1)}},W=async p=>{try{a(p);const x=e.filter(g=>g.address!==p);await t.saveUpstreams(x),b(null)}catch(x){console.error("Failed to delete upstream:",x),o(x instanceof Error?x.message:"Failed to delete upstream")}},j=p=>{const x=e.find(g=>g.address===p);x&&O(g=>({...g,[p]:{...x}}))},E=p=>{O(x=>{const g={...x};return delete g[p],g})},U=async p=>{const x=S[p];if(!x)return;const g=e.find(T=>T.address===p);if(!g)return;const L={name:(x.name??g.name??"").trim(),address:(x.address??g.address).trim()},F=x.weight===void 0?g.weight:Number(x.weight);F!==void 0&&(L.weight=F);const J=e.map(T=>T.address===p?L:T);try{r(J),await t.saveUpstreams(J),E(p)}catch(T){console.error("Failed to save edit:",T),o(T instanceof Error?T.message:"Failed to save")}},I=(p,x,g)=>{O(L=>({...L,[p]:{...L[p],[x]:x==="weight"?g===""?void 0:Number(g):g}}))},P=()=>{y(p=>p==="asc"?"desc":"asc")};return s("div",{className:"space-y-6",children:[s("div",{className:"flex items-center justify-between",children:s("div",{children:[s("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Upstreams"}),s("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Manage DNS upstream servers and their configuration"})]})}),s(B,{title:"Add New Upstream",subtitle:"Add a new DNS upstream server",children:s("form",{onSubmit:A,className:"space-y-6",children:[s("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s(z,{label:"Name",value:f,onInput:p=>u(p.target.value),placeholder:"Human-friendly name"}),s(z,{label:"Address",value:i,onInput:p=>d(p.target.value),placeholder:"udp://8.8.8.8:53 or https://dns.google/dns-query",hint:"Use URL form",required:!0}),s(z,{label:"Weight",type:"number",value:h,onInput:p=>l(p.target.value===""?"":Number(p.target.value)),placeholder:"1"})]}),s("div",{className:"flex gap-3 pt-4 border-t border-gray-200 dark:border-gray-700",children:s(M,{type:"submit",variant:"primary",loading:m,disabled:m,children:m?"Adding...":"Add Upstream"})})]})}),s(B,{title:"Configured Upstreams",subtitle:`${e.length} upstream server${e.length===1?"":"s"} configured`,children:[s("div",{className:"flex justify-between items-center mb-6",children:[s("div",{className:"flex items-center gap-3",children:[s(we,{variant:"primary",children:e.length}),s("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.length===1?"upstream server":"upstream servers"})]}),s(M,{variant:"secondary",size:"sm",onClick:P,title:`Sort ${k==="asc"?"Z-A":"A-Z"}`,children:k==="asc"?"A-Z":"Z-A"})]}),N.length===0?s("div",{className:"text-center py-8",children:s("p",{className:"text-gray-600 dark:text-gray-400",children:"No upstream servers configured yet."})}):s("div",{className:"space-y-3",children:N.map(p=>{var x,g,L;return s("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:S[p.address]?s("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 items-end",children:[s(z,{label:"Name",value:((x=S[p.address])==null?void 0:x.name)??p.name,onInput:F=>I(p.address,"name",F.target.value)}),s(z,{label:"Address",value:((g=S[p.address])==null?void 0:g.address)??p.address,onInput:F=>I(p.address,"address",F.target.value)}),s(z,{label:"Weight",type:"number",value:((L=S[p.address])==null?void 0:L.weight)??p.weight??"",onInput:F=>I(p.address,"weight",F.target.value)}),s("div",{className:"flex gap-2 justify-end",children:[s(M,{variant:"outline",size:"sm",onClick:()=>E(p.address),children:"Cancel"}),s(M,{variant:"primary",size:"sm",onClick:()=>U(p.address),children:"Save"})]})]}):s("div",{className:"flex items-center justify-between gap-4",children:[s("div",{className:"flex flex-col min-w-0",children:[s("span",{className:"text-sm text-gray-500 dark:text-gray-400 truncate max-w-[420px]",title:p.name||"Unnamed",children:p.name||"Unnamed"}),s("span",{className:"mt-1 px-2 py-1 rounded bg-gray-200 dark:bg-gray-700 text-gray-900 dark:text-gray-100 text-xs font-mono truncate max-w-[520px]",title:p.address,children:p.address})]}),s("div",{className:"flex items-center gap-3",children:[s("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["weight: ",p.weight??1]}),s(M,{variant:"secondary",size:"sm",onClick:()=>j(p.address),children:"Edit"}),s(M,{variant:"outline",size:"sm",onClick:()=>b(p.address),children:"Delete"})]})]})},p.address)})})]}),_&&s("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50",children:s("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-200 dark:border-gray-700 p-6 max-w-md w-full",children:[s("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Delete Upstream"}),s("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:["Are you sure you want to delete upstream ",s("strong",{children:['"',_,'"']}),"? This action cannot be undone."]}),s("div",{className:"flex gap-3 justify-end",children:[s(M,{variant:"outline",onClick:()=>b(null),children:"Cancel"}),s(M,{variant:"primary",onClick:()=>W(_),children:"Delete"})]})]})})]})}function en({provider:t}){const e=Os(),{setEvents:r,setError:n}=Ws(),[a,o]=C(""),[i,d]=C(200);V(()=>{const h=t.onHistory(l=>{r(l)});return t.fetchHistory().then(r).catch(l=>{console.error("Failed to fetch history:",l),n(l.message)}),h},[t,r,n]);const f=ce(()=>{let h=e;if(a.trim()){const l=a.toLowerCase();h=e.filter(m=>m.name.toLowerCase().includes(l))}return h.slice(0,i)},[e,a,i]),u=()=>e.length<=i?s(Z,{}):s("div",{style:{marginTop:"12px",textAlign:"center"},children:[s("span",{className:"muted",children:["Showing ",i," of ",e.length," events."]}),i<1e3&&s("button",{className:"ow-btn ow-btn--secondary ow-btn--sm",style:{marginLeft:"8px"},onClick:()=>d(Math.min(i*2,2e3)),children:"Show More"})]});return s("div",{className:"space-y-6",children:[s("div",{className:"flex items-center justify-between",children:s("div",{children:[s("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Query History"}),s("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"View DNS query history and performance metrics"})]})}),s(B,{title:"Search and Filters",subtitle:"Filter DNS query history",children:s("div",{className:"space-y-4",children:[s(z,{label:"Filter by Domain",value:a,onInput:h=>o(h.target.value),placeholder:"Filter by domain name...",hint:"Enter a domain name to filter the results"}),s("div",{className:"flex items-center justify-between",children:[s("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Showing ",f.length," of ",e.length," events"]}),e.length>i&&s("button",{className:"text-sm text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300",onClick:()=>d(Math.min(i*2,2e3)),children:"Show More"})]})]})}),s(B,{title:"Query History",subtitle:`${f.length} DNS queries`,children:f.length===0?s("div",{className:"text-center py-8",children:s("p",{className:"text-gray-600 dark:text-gray-400",children:e.length===0?"No query history available":"No queries match filter"})}):s("div",{className:"overflow-x-auto",children:[s("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700 table-auto",children:[s("thead",{className:"bg-gray-50 dark:bg-gray-800",children:s("tr",{children:[s("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Time"}),s("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Domain"}),s("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Type"}),s("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Client IP"}),s("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Upstream"}),s("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Duration"}),s("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Status"})]})}),s("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700",children:f.map((h,l)=>s("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:[s("td",{className:"px-4 sm:px-6 py-3 sm:py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:Ys(h.time)}),s("td",{className:"px-4 sm:px-6 py-3 sm:py-4 whitespace-normal sm:whitespace-nowrap break-words text-sm font-medium text-gray-900 dark:text-gray-100",children:h.name}),s("td",{className:"px-4 sm:px-6 py-3 sm:py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:Zs(h.qtype)}),s("td",{className:"px-4 sm:px-6 py-3 sm:py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400 font-mono",children:h.client_ip||"unknown"}),s("td",{className:"px-4 sm:px-6 py-3 sm:py-4 whitespace-normal sm:whitespace-nowrap break-words text-sm text-gray-500 dark:text-gray-400",title:h.upstream,children:Qs(h.upstream)}),s("td",{className:"px-4 sm:px-6 py-3 sm:py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:h.duration}),s("td",{className:"px-4 sm:px-6 py-3 sm:py-4 whitespace-nowrap",children:s("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${h.status==="ok"?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400":"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400"}`,children:h.status==="ok"?"OK":"Error"})})]},`${h.time}-${h.name}-${l}`))})]}),u()]})})]})}function tn({provider:t}){const[e,r]=C([]),[n,a]=C(!0),[o,i]=C(null);V(()=>{let m=t.onHosts(c=>{r(c),a(!1)});return t.fetchHosts().then(r).catch(c=>i(String(c))).finally(()=>a(!1)),()=>{m()}},[t]);const d=()=>r(m=>[...m,{pattern:"",a:[],aaaa:[],ttl:60}]),f=m=>r(c=>c.filter((_,b)=>b!==m)),u=(m,c)=>r(_=>_.map((b,k)=>k===m?{...b,...c}:b)),h=m=>m?m.split(",").map(c=>c.trim()).filter(Boolean):[];return s("div",{className:"space-y-6",children:[s("div",{className:"flex items-center justify-between",children:[s("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Hosts"}),s("div",{className:"space-x-2",children:[s(M,{variant:"secondary",onClick:d,children:"Add"}),s(M,{onClick:async()=>{i(null);try{await t.saveHosts(e)}catch(m){i(String(m))}},children:"Save"})]})]}),o&&s("div",{className:"text-red-600 text-sm",children:o}),s(B,{title:"Overrides",subtitle:"Static DNS responses with wildcard support",children:n?s("div",{className:"text-gray-500",children:"Loading..."}):s("div",{className:"overflow-x-auto",children:s("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[s("thead",{className:"bg-gray-50 dark:bg-gray-800",children:s("tr",{children:[s("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:"Pattern"}),s("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:"A (comma separated)"}),s("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:"AAAA (comma separated)"}),s("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:"TTL"}),s("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),s("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700",children:[e.map((m,c)=>s("tr",{children:[s("td",{className:"px-3 py-2 w-[28%]",children:s(z,{value:m.pattern||"",onInput:_=>u(c,{pattern:_.currentTarget.value}),placeholder:"e.g. *.example.com"})}),s("td",{className:"px-3 py-2 w-[28%]",children:s(z,{value:(m.a||[]).join(", "),onInput:_=>u(c,{a:h(_.currentTarget.value)}),placeholder:"127.0.0.1, 10.0.0.1"})}),s("td",{className:"px-3 py-2 w-[28%]",children:s(z,{value:(m.aaaa||[]).join(", "),onInput:_=>u(c,{aaaa:h(_.currentTarget.value)}),placeholder:"::1, 2001:db8::1"})}),s("td",{className:"px-3 py-2 w-[8%]",children:s(z,{type:"number",value:String(m.ttl??60),onInput:_=>u(c,{ttl:Number(_.currentTarget.value)}),placeholder:"60"})}),s("td",{className:"px-3 py-2 text-right w-[8%]",children:s(M,{variant:"danger",onClick:()=>f(c),children:"Del"})})]},c)),e.length===0&&s("tr",{children:s("td",{colSpan:5,className:"px-3 py-6 text-sm text-gray-500 text-center",children:"No hosts configured. Click Add to create one."})})]})]})})})]})}const rn=(t,e)=>{const r=e.split("/"),n=r[0],a=r[1];if(!n||!a)return null;for(const o of t){const i=o.name.toLowerCase();if(i.includes(n.toLowerCase())&&i.includes(a.toLowerCase()))return o}for(const o of t)if(o.name.toLowerCase().includes(n.toLowerCase()))return o;for(const o of t){const i=o.name.toLowerCase();if(i.includes(".tar.gz")||i.includes(".zip")||i.includes(".bin"))return o}return null},sn=({provider:t})=>{const[e,r]=C(null),[n,a]=C(null),[o,i]=C(!1),[d,f]=C(!1),[u,h]=C(!1),[l,m]=C(!1),[c,_]=C(null),[b,k]=C(null),y=(E,U)=>{_({message:E,type:U}),setTimeout(()=>_(null),5e3)};V(()=>t?t.onUpdateAvailable(U=>{console.log("WebSocket update notification received:",U),r(U),y(`Update available: ${U.latest_version}`,"success")}):void 0,[t]);const S=async()=>{i(!0);try{const E=await fetch("/api/v1/update/check");if(!E.ok)throw new Error("Failed to check for updates");const U=await E.json();r(U)}catch(E){y(`Failed to check for updates: ${E}`,"error")}finally{i(!1)}},O=async()=>{var I;if(!((I=e==null?void 0:e.release)!=null&&I.assets))return;const E=(n==null?void 0:n.platform)||"",U=rn(e.release.assets,E);if(!U){y("No suitable update found for your platform","error");return}f(!0);try{const P=await fetch("/api/v1/update/download",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({download_url:U.browser_download_url})});if(!P.ok)throw new Error("Failed to download update");const p=await P.json();k(p.path),y("Update downloaded successfully","success")}catch(P){y(`Failed to download update: ${P}`,"error")}finally{f(!1)}},N=async(E=30,U=2e3)=>{m(!0);let I=0;const P=async()=>{try{return(await fetch("/api/v1/update/status",{method:"HEAD",signal:AbortSignal.timeout(5e3)})).ok}catch{return!1}},p=async()=>{if(I++,I>E){m(!1),y("Server did not come back online after installation. Please check manually.","error");return}if(await P()){m(!1),y("Server is back online! Reloading page...","success"),setTimeout(()=>{window.location.reload()},1e3);return}setTimeout(p,U)};y("Installation complete. Waiting for server to restart...","success"),p()},A=async()=>{if(b){h(!0);try{const E=await fetch("/api/v1/update/install",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({update_path:b})});if(!E.ok)throw new Error("Failed to install update");const U=await E.json();y(U.message||"Update installed successfully. Server will restart...","success"),k(null),await N()}catch(E){y(`Failed to install update: ${E}`,"error")}finally{h(!1)}}},W=E=>new Date(E).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),j=E=>{const U=E.match(/(?:(\d+)h)?(?:(\d+)m)?(?:(\d+(?:\.\d+)?)s)?/);if(!U)return E;const I=parseInt(U[1]||"0"),P=parseInt(U[2]||"0"),p=parseFloat(U[3]||"0"),x=[];return I>0&&x.push(`${I}h`),P>0&&x.push(`${P}m`),p>0&&x.push(`${Math.floor(p)}s`),x.join(" ")||"0s"};return V(()=>{(async()=>{try{const U=await fetch("/api/v1/update/status");if(U.ok){const I=await U.json();a(I)}}catch(U){console.error("Failed to load update status:",U)}})(),S()},[]),s("div",{className:"space-y-6",children:[s("div",{className:"flex items-center justify-between",children:s("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Updates"})}),c&&s(Tr,{message:c.message,type:c.type,onClose:()=>_(null)}),s(B,{children:s("div",{className:"p-6",children:[s("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-6",children:"Current Version"}),n?s("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[s("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-lg p-4",children:[s("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-1",children:"Version"}),s("p",{className:"text-xl font-bold text-gray-900 dark:text-white",children:n.current_version})]}),s("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-lg p-4",children:[s("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-1",children:"Build Time"}),s("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:W(n.build_time)})]}),s("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-lg p-4",children:[s("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-1",children:"Uptime"}),s("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:j(n.uptime)})]}),s("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-lg p-4",children:[s("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-1",children:"Platform"}),s("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:n.platform})]})]}):s("div",{className:"flex items-center justify-center py-12",children:s(be,{})})]})}),s(B,{children:s("div",{className:"p-6",children:[s("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[s("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Check for Updates"}),s(M,{onClick:S,disabled:o,className:"flex items-center gap-2 w-full sm:w-auto",children:[o?s(be,{size:"sm"}):null,"Check for Updates"]})]}),e&&s("div",{className:"space-y-4",children:[e.has_update?s("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-xl p-6",children:[s("div",{className:"flex items-center gap-3 mb-3",children:[s("div",{className:"w-3 h-3 bg-blue-500 rounded-full animate-pulse"}),s("p",{className:"text-blue-800 dark:text-blue-200 font-semibold text-lg",children:"Update Available"})]}),s("p",{className:"text-blue-700 dark:text-blue-300 text-base mb-2",children:["New version ",s("span",{className:"font-bold",children:e.latest_version})," is available"]}),s("p",{className:"text-blue-600 dark:text-blue-400 text-sm",children:["Current version: ",e.current_version]}),e.release&&s("div",{className:"mt-3 space-y-2",children:[s("p",{className:"text-sm text-blue-600 dark:text-blue-400",children:["Released: ",W(e.release.published_at)]}),e.release.body&&s("details",{className:"mt-2",children:[s("summary",{className:"text-sm text-blue-600 dark:text-blue-400 cursor-pointer hover:underline",children:"Release Notes"}),s("div",{className:"mt-2 p-3 bg-white dark:bg-gray-800 rounded border text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap",children:e.release.body})]})]})]}):s("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-xl p-6",children:[s("div",{className:"flex items-center gap-3 mb-3",children:[s("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),s("p",{className:"text-green-800 dark:text-green-200 font-semibold text-lg",children:"You are up to date"})]}),s("p",{className:"text-green-700 dark:text-green-300 text-base",children:["Running latest version ",s("span",{className:"font-bold",children:e.current_version})]})]}),e.has_update&&s("div",{className:"flex flex-col sm:flex-row gap-3 mt-6",children:b?s(M,{onClick:A,disabled:u||l,className:"flex items-center justify-center gap-2 px-6 py-3 bg-red-600 hover:bg-red-700 text-white font-medium",children:[u?s(be,{size:"sm"}):null,l?"Waiting for server...":"Install Update"]}):s(M,{onClick:O,disabled:d,className:"flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium",children:[d?s(be,{size:"sm"}):null,"Download Update"]})})]})]})})]})};function nn(){const[t,e]=C("overview"),[r,n]=C(!1),[a,o]=C(null),[i,d]=C([]);Er(),V(()=>{var b;const h=new Gr("/ws");let l=null;h.connect().then(()=>{o(h),console.log("Provider connected")}).catch(k=>{console.error("Failed to connect provider:",k)});const m=()=>{const k=window.location.hash.slice(1);["overview","rules","upstreams","history","hosts","resolve","update"].includes(k)&&e(k)};m(),window.addEventListener("hashchange",m);const c=()=>{window.innerWidth<1024&&n(!0)};c(),window.addEventListener("resize",c);const _=(b=h.onStatus)==null?void 0:b.call(h,k=>{if(k.channel==="rest"){l&&clearTimeout(l),l=window.setTimeout(()=>{d(y=>[{id:`${Date.now()}`,message:"WebSocket unavailable — using polling",type:"warning",duration:2500},...y].slice(0,4)),l=null},1200);return}l&&(clearTimeout(l),l=null),d(y=>[{id:`${Date.now()}`,message:"Realtime updates via WebSocket",type:"success",duration:2500},...y].slice(0,4))});return()=>{window.removeEventListener("hashchange",m),window.removeEventListener("resize",c),l&&clearTimeout(l),_&&_(),h.close()}},[]);const f=h=>{window.location.hash.slice(1)!==h?window.location.hash=h:e(h),window.scrollTo(0,0)},u=()=>{n(!r)};return a?s("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-700",children:[s(qs,{toasts:i,onRemove:h=>d(l=>l.filter(m=>m.id!==h))}),s(Gs,{activeTab:t,onTabChange:f,collapsed:r}),s("div",{className:`transition-all duration-300 ${r?"lg:ml-16":"lg:ml-64"}`,children:[s(Bs,{onSidebarToggle:u,sidebarCollapsed:r,provider:a}),s("main",{className:"p-6",children:s("div",{className:"max-w-7xl mx-auto",children:[t==="overview"&&s(Hs,{provider:a}),t==="rules"&&s(Js,{provider:a}),t==="upstreams"&&s(Ks,{provider:a}),t==="history"&&s(en,{provider:a}),t==="hosts"&&s(tn,{provider:a}),t==="resolve"&&s(Fs,{provider:a}),t==="update"&&s(sn,{provider:a})]})})]}),!r&&s("div",{className:"fixed inset-0 z-30 bg-black/50 lg:hidden",onClick:u})]}):s("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:s("div",{className:"text-center",children:[s("div",{className:"w-16 h-16 bg-gray-200 dark:bg-gray-700 rounded-full animate-pulse mx-auto mb-4"}),s("p",{className:"text-gray-600 dark:text-gray-400",children:"Connecting to server..."})]})})}ae(s(nn,{}),document.getElementById("app"));
